//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at docs.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function ZDDialog(){}function ZDUtils(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.SCR_WTH="",this.SCR_HT="",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function ATTACHDIALOG(){this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.nameSortArrow="",this.timeSortArrow="",this.sortOrder="",this.orderBy="",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.jsonData="",this.selectedLeftPanel="recentservicedocs",this.SCR_WTH="",this.SCR_HT="",this.folderId="folder",this.parentFolderId="1",this.defaultObj={servicename:"",attachCount:"5",handbckobj:"",search:!0,positionObj:[150,150],isDraggable:!0,isResize:!1,height:570,width:650},this.attachObj={}}ZDDialog.showCommonDialog=function(a,b,c,d,e,f,g,h,i,j,k){var l=ZD("#"+c).dialog({autoOpen:!0,zIndex:1e4,title:a,modal:b,resizable:i,closeText:"closeIcon",buttons:d,position:e,width:f,minWidth:j,minHeight:k,draggable:g,height:h,drag:function(a,b){if(c=="sharedialogdiv"&&ZD("#zd_sharetextarea").is(":visible")){var d=ZD("#zd_sharetextarea").offset().top,e=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:d+45,left:e})}},open:function(a,b){var d=ZD("#"+c).parent().addClass("docsdialog").prev()},resize:function(a,b){ZDDialog.resizeDialog(a,b,c)}});return ZD("#"+c).bind("dialogclose",function(a,b){return ZDDialog.closePopUp(c),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(a,b,c){if(c=="attachopenfiledialogdiv"){var d=b.size.height-92;ZD("#showopenservicefilespace").css("height",d),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if(c=="sharedialogdiv"){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var d=b.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",d),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",d-93)}else if(c=="attachfiledialogdiv"){var d=b.size.height-225;ZD("div#showattachfilespace").css("height",d),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if(c=="adddocdialogdiv"){var d=b.size.height-255;ZD("div#tree_container").css("height",d).parent().css("height",d+40)}},ZDDialog.openAlert=function(a,b,c,d,e,f,g){ZD("#frameDiv").remove();if(e==undefined||e=="")e=[200,350];f=350;var h=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(h).appendTo("body");var i=ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:a,modal:"true",resizable:!1,closeText:"",buttons:d,position:e,width:f,draggable:g,height:"auto",close:function(a,b){ZD(this).dialog("destroy").remove()},open:function(a,b){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+b+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(a,b){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(a,b,c,d,e,f){ZD("#createnewfolderdiv").remove();var g=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(g).appendTo("body");var h=ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:a,modal:b,resizable:!1,closeText:"closeIcon",buttons:c,position:d,width:e,draggable:!0,height:f});ZD("#createnewfolderdiv").bind("dialogclose",function(a,b){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.closePopUp=function(a){ZD("#"+a).unbind("dialogclose");if(a=="attachopenfiledialogdiv")ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove();else if(a=="linkdocsdialogdiv")ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove();else if(a=="attachfiledialogdiv")ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove();else if(a=="adddocdialogdiv")ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+a).dialog("destroy").remove();else if(a=="frameDiv"||a=="createnewfolderdiv"||a=="sharedialogdiv")a=="sharedialogdiv"&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#zd_share_button,#zd_cancel_button,#orgshare_edit,#share_via_link_edit").die(),ZD(".docsdialog .linkURL,#zdc_visible_changelink,#zdc_visible_default_hidediv input:radio,#zdc_for_to_private_label,#zdc_for_to_anyone_label,#zdc_for_to_org_label").die(),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),ZD("#"+a).dialog("destroy").remove();return},ZDDialog.showExternalUsersList=function(a,b,c,d,e,f){ZD("#frameDiv").remove();if(c==undefined||c=="")c=[200,350];width=450;var g=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(g).appendTo("body");var h=ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:a,modal:"true",resizable:!1,closeText:"",buttons:b,position:c,width:width,draggable:!0,height:"auto",close:function(a,b){ZD(this).dialog("destroy").remove()},open:function(a,b){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return e=="invalidList"?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):d==3&&e=="externalList"&&f==0?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(a,b){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(a,b,c){ZD("#frameDiv").remove();if(c==undefined||c=="")c=[200,350];width=450;var d=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>'),e;zd_third_party=="NONE"||zd_third_party==""||zd_third_party=="undefined"||zd_third_party==undefined?e="zoho":(e=zd_third_party.toLowerCase(),e=="fuji"&&(e="SkyDesk")),ZD(d).appendTo("body");var f=ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:a,modal:"true",resizable:!1,closeText:"",buttons:b,position:c,width:width,draggable:!0,height:"auto",close:function(a,b){ZD(this).dialog("destroy").remove()},open:function(a,b){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(e))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(a,b){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(a,b,c,d){ZD("#frameDiv").remove();if(c==undefined||c=="")c=[200,350];width=450;var e=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(e).appendTo("body");var f=ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:a,modal:"true",resizable:!1,closeText:"",buttons:b,position:c,width:width,draggable:!0,height:"auto",close:function(a,b){ZD(this).dialog("destroy").remove()},open:function(a,b){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return d=="ext_fail"?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):d=="accept_fail"&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(a,b){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDUtils.getHeight=function(){var a;return self.innerHeight?a=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&(a=document.body.clientHeight),a},ZDUtils.getWidth=function(){var a;return self.innerHeight?a=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientWidth:document.body&&(a=document.body.clientWidth),a},ZDUtils.isEmailId=function(a){if(!a)return!1;a=a.trim();var b=/^[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,6}(\.[a-zA-Z]{2}){0,2})$/i;return b.test(a)},ZDUtils.substringName=function(a,b){var c=a;return c.length>b&&(c=c.substring(0,b),c+=".."),c},ZDUtils.escapeSpecialCharacters=function(a){a+="";var b=a.replace(/"/g,"&quot;"),c=b.replace(/'/g,"&apos;"),d=c.replace(/</g,"&lt;"),e=d.replace(/>/g,"&gt;");return e},ZDUtils.hasSpecialChar=function(a,b){var c="<>*%#&?\\',\"",d=1;for(var e=0;e<a.length;e++)ZD.inArray(a.charAt(e),c)!=-1&&(d+=1);return d>1?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.special_characters_validaton),!0):!1},ZDUtils.hasWhiteSpaceChar=function(a,b){return a===""?(b=="renamefolder"?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.document_name_empty_validation),!0):!1},ZDUtils.showAlertBox=function(a,b){b=="rename"?FILEDIALOG.statusmsg("failure_status boldText",a):b=="folder"?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):ZDDialog.openAlert(zd_js_obj.alert,a,!0)},ZDUtils.LoadingMsg=function(a){var b=zd_js_obj.loading;a!=""&&a!=undefined&&(b=a),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" class="zdcomp_loading">'+b+"</span>")},ZDUtils.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ZDUtils.openFileLoadingMsg=function(a){var b="Loading...";a!=""&&a!=undefined&&(b=a);var c=ZD("#showopenservicefilespace").height()/2.2,d=ZD("#showopenservicefilespace").width()/2.2;ZD("#openfileloadingdiv").css({"margin-left":d,"margin-top":c,display:"block"}).find("span").html(b)},ZDUtils.hideOpenFileLoadingMsg=function(){ZD("#openfileloadingdiv").hide()},ZDUtils.getI18N=function(){ZDUtils.getUserRelatedDetails()},ZDUtils.split=function(a){return a.split(/,\s*/)},ZDUtils.extractLast=function(a){var b=a.toString();return ZD.trim(ZDUtils.split(b).pop())},ZDUtils.startsWithRegEx=function(a,b){var c="^"+b.toLowerCase(),d=a.label,e=d.substring(0,d.indexOf("(")-1).trim();if(e==undefined||e=="")e=d;if(e.toLowerCase().match(c)==b.toLowerCase())return a;var f=ZDUtils.getLastNameOfContact(e);if(f.toLowerCase().match(c)==b.toLowerCase())return a;var g=d.substring(d.indexOf("(")+1,d.length);if(g==undefined||g=="")return"";if(g.toLowerCase().match(c)==b.toLowerCase())return a},ZDUtils.getLastNameOfContact=function(a){var b=a.substring(a.lastIndexOf(" ")+1,a.length);return b},ZDUtils.getUserRelatedDetails=function(callbck){var url="/docs/zduserdetails.do";ZD.ajax({url:url,type:"GET",dataType:"html",success:function(data){ZD("#zd_user_details").remove(),ZD("body").append(data),ZD(data).find("script").each(function(i){eval(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),callbck!=undefined&&callbck!=""&&eval(callbck)}})},ZDUtils.deSelectDocs=function(){var a=ZD("div.selecteddoc");a.each(function(a,b){ZD(this).closest("div.dataDiv").removeClass("select"),ZD(this).attr("class","unselecteddoc"),ZD(this).children().attr("class","normalcheckboxicon_css")}),ZD("#selectAllCheckBox").hasClass("selectcheckboxicon_css")&&ZD("#selectAllCheckBox").attr({"class":"normalcheckboxicon_css",name:"allDocsUnSelected"})},ZDUtils.deSelectDoc=function(a){ZD("div[id="+a+"]").removeClass("select").find("div.selecteddoc").attr("class","unselecteddoc").children().attr("class","normalcheckboxicon_css")},ZDUtils.replaceParams=function(a,b){if(b!="undefined"&&b.length>0)for(i=0;i<b.length;i++)a=ZDUtils.replace(a,"{"+i+"}",b[i]);return a},ZDUtils.replace=function(a,b,c){var d=a.length,e=b.length;if(d===0||e===0)return a;var f=a.indexOf(b);if(!f&&b!=a.substring(0,e))return a;if(f==-1)return a;var g=a.substring(0,f)+c;return f+e<d&&(g+=ZDUtils.replace(a.substring(f+e,d),b,c)),g},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE=navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("Opera")<1?1:0,G_OF_OBJ,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj=[],zdcsrfPair,G_OF_OBJ;ATTACHDIALOG.initMenu=function(a){if(a=="left"||a=="both")ZD("#leftmenu,#visibilityoptions_top").zmenu().bind("menubeforeshow",function(a,b){var c=ZDMenu.createLeftMenu(a,b);return c}),ZD("#leftmenu,#visibilityoptions_top").bind("menuitemclicked",function(a,b){return ZDMenu.leftMenuItemActions(a,b),!0});if(a=="right"||a=="both")ZD("#rightmenu").zmenu().live("menubeforeshow",function(a,b){var c=ZDMenu.createContextMenu(a,b);return c}),ZD("#rightmenu").live("menuitemclicked",function(a,b){return ZDMenu.contextMenuItemActions(a,b),!0})},ATTACHDIALOG.attachDocsFiles=function(){var a=ZD("div.selectbox","#selectboxdiv");if(a.length==0){ATTACHDIALOG.statusmsg(zd_js_obj.select_the_documents),ZDUtils.hideLoadingMsg();return}var b=ATTACHDIALOG.getSelectedDocs();if(b.length>G_OF_OBJ.attachObj.attachCount){ATTACHDIALOG.statusmsg(ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+""))),ZDUtils.hideLoadingMsg();return}var c={},d=[];for(var e=0,f=b.length;e<f;e++){var g={},h=b[e].docId,i=b[e].docName,j=b[e].service;j=="zw"?j="writer":j=="zohoshow"?j="show":j=="zohosheet"?j="sheet":j="upload";var k=b[e].isDocumentSharedToMe,l=b[e].encryptedId;l=="undefined"&&(l=""),g.docId=h,g.docName=i,g.service=j,g.isDocumentSharedToMe=k,g.encryptedId=l,d[e]=g}c.docObj=d,c.handbckobj=G_OF_OBJ.attachObj.handbckobj,(G_OF_OBJ.urlInvoker=="zmail"||G_OF_OBJ.urlInvoker=="zcrm"||G_OF_OBJ.urlInvoker=="discussion"||G_OF_OBJ.urlInvoker=="zcreator"||G_OF_OBJ.urlInvoker=="zprojects"||G_OF_OBJ.urlInvoker=="zwiki")&&attachDocsIntegCallBackFn(c),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.attachFiles=function(){var a=ZD("div.selectbox","#selectboxdiv"),b="",c="",d="",e="",f="",g="",h="",i="",j="",k="",l="",m=!1,n=!1,o=!1;if(a.length==0){var p={},q=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,r=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,s=[q,r],t=G_OF_OBJ.attachObj.isDraggable;p[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,p,s,"",t);return}var u=ATTACHDIALOG.getSelectedDocs();if(u.length>G_OF_OBJ.attachObj.attachCount){var p={},q=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,r=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,s=[q,r],t=G_OF_OBJ.attachObj.isDraggable;p[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+"")),!0,p,s,"",t);return}for(var v=0,w=u.length;v<w;v++)e=u[v].docId,f=u[v].docName,g=u[v].service,m=u[v].isDocumentSharedToMe,k=u[v].encryptedId,m=="true"?(o=!0,g=="zw"?(h=h+e+",",j=j+"writer"+","):g=="zohoshow"?(h=h+e+",",j=j+"show"+","):g=="zohosheet"?(h=h+e+",",j=j+"sheet"+","):(h=h+k+",",j=j+"upload"+","),i=i+encodeURIComponent(f)+","):(n=!0,g=="zw"?d=d+"writer"+",":g=="zohoshow"?d=d+"show"+",":g=="zohosheet"?d=d+"sheet"+",":d=d+"upload"+",",b=b+e+",",c=c+encodeURIComponent(f)+",");n&&(b=b.substring(0,b.length-1),c=c.substring(0,c.length-1),d=d.substring(0,d.length-1),l+="docIds="+b+"&docNames="+c+"&service="+d),n&&o&&(l+="&"),o&&(h=h.substring(0,h.length-1),i=i.substring(0,i.length-1),j=j.substring(0,j.length-1),l+="sharedDocIds="+h+"&sharedDocNames="+i+"&sharedService="+j),(G_OF_OBJ.urlInvoker=="discussion"||G_OF_OBJ.urlInvoker=="zmail")&&attachDocsIntegCallBackFn(l),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.getSelectedDocs=function(){var a=ZD("div.selectbox","div#selectboxdiv"),b=[];return a.each(function(a,c){var d={},e=ZD(this).closest("div"),f=e.attr("docId"),g=e.attr("docName"),h=e.attr("service"),i=e.attr("isDocumentSharedToMe"),j=e.attr("encryptedId");d.docId=f,d.docName=g,d.service=h,d.isDocumentSharedToMe=i,d.encryptedId=j,b[a]=d}),b},ATTACHDIALOG.getSelectedDocsForOpenFileDialog=function(){var a=ZD("div#attachFileDataDiv table.zd_select"),b=[];return a.each(function(a,c){var d={},e=ZD(this).closest("div"),f=e.attr("id"),g=e.data("fileId"),h=e.data("service"),i=e.data("docName"),j=e.data("cssName"),k=e.data("isDocumentSharedToMe"),l=e.data("isTemplates"),m=e.data("encryptedId");d.docId=f,d.fileId=g,d.file_name=i,d.service=h,d.classname=j,d.isDocumentSharedToMe=k,d.encryptedId=m,d.isTemplates=l,b[a]=d}),b},ATTACHDIALOG.statusmsg=function(a){ZD("span#zd_statusmsgdiv").html(a).parent().css("display","block"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none")},4e3)},ATTACHDIALOG.reset=function(){G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.prevIndex="1",G_OF_OBJ.nextIndex="10",G_OF_OBJ.startFrom="0"},ATTACHDIALOG.selectRow=function(a){ZD("#"+a).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+a).children("table.data-hover").addClass("zd_select")},ATTACHDIALOG.deselectRow=function(a){ZD("#"+a).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),ZD("#"+a).children("table.data-hover").removeClass("zd_select"),ZD("#selectedfile_"+a).length&&ZD("#selectedfile_"+a).remove()},ATTACHDIALOG.showSelectedDocsToAttach=function(a){var b=ZD(a).closest("div.documentDataDiv"),c=b.attr("id");if(ZD(a).hasClass("zd_select")){ATTACHDIALOG.deselectRow(c);return}ATTACHDIALOG.selectRow(c);var d=b.attr("serviceType"),e=b.attr("isDocumentSharedToMe"),f=b.attr("encryptedId"),g=b.attr("fileName"),h=ZDUtils.escapeSpecialCharacters(g),i=ZDUtils.substringName(h,"10"),j='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+c+'" docId="'+c+'" docName="'+g+'" service="'+d+'" isDocumentSharedToMe="'+e+'" encryptedId="'+f+'"><span class="flleft" title="'+g+'" alt="'+g+'">'+i+'</span><span action="delete" id="'+c+'_delete" class="closeBtn_css flleft cursor cls" alt="'+zd_js_obj.remove+'" title="'+zd_js_obj.remove+'"></span></div>';ZD("#selectboxdiv").append(j)},ATTACHDIALOG.selectOrdeselectRow=function(a,b){var c=ZD(b).closest(".documentDataDiv"),a=currentObj.attr("id"),d=c.children("table.data-hover").hasClass("zd_select");return d?(c.find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),c.children("table.data-hover").removeClass("zd_select")):(c.find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),c.children("table.data-hover").addClass("zd_select")),!1},ATTACHDIALOG.clearSelectedRows=function(){var a=ZD("#attachFileDataDiv").find("div.documentDataDiv").children("table.zd_select");ZD(a).each(function(a,b){ZD(b).removeClass("zd_select"),ZD(b).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css")});return},ATTACHDIALOG.getSharedDocs=function(a,b,c,d){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading),G_OF_OBJ.selectedLeftPanel="shareddocs",a==null&&(a=0),b==null&&(b="time"),c==null&&(c="desc");var e="/docs/viewsearchresults.do?method=attachFileSharedDocs&start="+a+"&field="+b+"&action="+c+"&_t="+(new Date).getTime(),f=ZD("#showattachfilespace").children();ZD(f).each(function(a,b){ZD(b).empty().remove()}),ZD.ajax({url:e,type:"POST",datatype:"html",success:function(a){ZD("#showattachfilespace").html(a),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.clearText=function(){ZD("#searchFileName").value=="Searchfiles"&&(ZD("#searchFileName").value="")},ATTACHDIALOG.LoadingMsg=function(a){var b=zd_js_obj.loading;a!=""&&a!=undefined&&(b=a),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" style="padding:3px 5px;background-color:#848484;color:#FFF;font-size:11px;font-weight:bold;text-align:center;right:3px;position:absolute;">'+b+"</span>")},ATTACHDIALOG.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ATTACHDIALOG.getDocAsList=function(a,b){var c;a!=""&&a!=undefined?c=ZD(a).attr("id"):b!=""&&b!==undefined&&(c=b),ZD("#actionMenuOpenFile").css("display","block");if(c=="sharedservicedocs")return ZD("#actionMenuOpenFile").css("display","none"),ATTACHDIALOG.changeAllToNormalView(c),ATTACHDIALOG.getSharedDocs(),!1;c=="desktopservicedocs"&&(G_OF_OBJ.folderId="folder"),c!=""&&c!=undefined&&(ATTACHDIALOG.changeAllToNormalView(c),G_OF_OBJ.selectedLeftPanel=c),ATTACHDIALOG.resetAll(),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel")},ATTACHDIALOG.resetAll=function(){ATTACHDIALOG.reset();var a=ZD("#showattachfilespace").children();ZD(a).each(function(a,b){ZD(b).empty().remove()}),ZD("#showattachfilespace").attachfiledatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},ATTACHDIALOG.changeAllToNormalView=function(a){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),a!=""&&a!=undefined&&ZD("#"+a).addClass("selectedView").removeClass("normalView")},ATTACHDIALOG.setSortOrder=function(a){var b=ZD(a).attr("id");G_OF_OBJ.nameSortArrow=ZD(a).children().attr("class"),G_OF_OBJ.timeSortArrow=ZD(a).children().attr("class"),b=="nameHeader"?(G_OF_OBJ.timeSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="name",ZD(a).children().hasClass("DownArrow")||ZD(a).children().hasClass("DownArrowH")?G_OF_OBJ.sortOrder="asc":G_OF_OBJ.sortOrder="desc"):b=="dateModifiedHeader"&&(G_OF_OBJ.nameSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="date",ZD(a).children().hasClass("DownArrow")?G_OF_OBJ.sortOrder="asc":G_OF_OBJ.sortOrder="desc")},ATTACHDIALOG.setClassAfterSorting=function(a){var b=ZD(a).attr("id");b=="nameHeader"?(ZD("#dateModifiedHeader").children("img:first").removeClass().addClass("DownArrowH"),G_OF_OBJ.nameSortArrow=="UpArrow"?ZD("#"+b).children("img:first").removeClass().addClass("DownArrow"):ZD("#"+b).children("img:first").removeClass().addClass("UpArrow")):b=="dateModifiedHeader"&&(G_OF_OBJ.timeSortArrow=="UpArrow"?ZD("#"+b).children("img:first").removeClass().addClass("DownArrow"):ZD("#"+b).children("img:first").removeClass().addClass("UpArrow"))},ATTACHDIALOG.getI18N=function(language,callbck){var url="/docs/zduserdetails.do";ZD.ajax({url:url,type:"GET",dataType:"html",success:function(data){ZD("#zd_user_details").remove(),ZD("body").append(data),ZD(data).find("script").each(function(i){eval(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),callbck!=undefined&&callbck!=""&&callbck()}})},ATTACHDIALOG.showAttachFileDialog=function(a){if(zd_js_obj==undefined||zd_js_obj==""){G_OF_OBJ=new ATTACHDIALOG;var b=function(){ATTACHDIALOG.showAttachFileDialog(a)};return ATTACHDIALOG.getI18N("",b),!1}if(!ZD("#attachfiledialogdiv").length){G_OF_OBJ==undefined&&(G_OF_OBJ=new ATTACHDIALOG),G_OF_OBJ.attachObj=ZD.extend({},G_OF_OBJ.defaultObj,a),G_OF_OBJ.urlInvoker=G_OF_OBJ.attachObj.servicename,ZD("body").append('<div id="attachfiledialogdiv" style="display:none;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),ZD("body").append('<ul id="zd_rightmenu" style="display:none;"></ul>');var c={};if(G_OF_OBJ.urlInvoker=="discussion")c[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachFiles()};else if(G_OF_OBJ.urlInvoker=="zmail"||G_OF_OBJ.urlInvoker=="zcrm"||G_OF_OBJ.urlInvoker=="zcreator"||G_OF_OBJ.urlInvoker=="zprojects"||G_OF_OBJ.urlInvoker=="zwiki")c[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachDocsFiles()};c[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("attachfiledialogdiv")};var d=G_OF_OBJ.attachObj.positionObj,e=G_OF_OBJ.attachObj.isDraggable,f=G_OF_OBJ.attachObj.isResize,g=G_OF_OBJ.attachObj.height,h=G_OF_OBJ.attachObj.width,i=!0,j=!0,k=400;zd_isIE&&G_OF_OBJ.urlInvoker=="zcrm"&&(k=600),G_OF_OBJ.attachObj.search||(i=!1,j=!1);if(G_OF_OBJ.urlInvoker=="zprojects"||G_OF_OBJ.urlInvoker=="zcreator"||G_OF_OBJ.urlInvoker=="zwiki")j=!1;G_OF_OBJ.urlInvoker=="zmail"?g-=64:G_OF_OBJ.urlInvoker=="zcrm"&&(g-=24),ZDDialog.showCommonDialog(zd_js_obj.label_attach_from_zoho_docs,!0,"attachfiledialogdiv",c,d,h,e,g,f,450,k),(G_OF_OBJ.urlInvoker=="zmail"||G_OF_OBJ.urlInvoker=="zcrm"||G_OF_OBJ.urlInvoker=="discussion"||G_OF_OBJ.urlInvoker=="zcreator"||G_OF_OBJ.urlInvoker=="zprojects"||G_OF_OBJ.urlInvoker=="zwiki")&&ZD("div#attachfiledialogdiv").attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:j,name:zd_js_obj.shared_docs,title:zd_js_obj.shared_docs},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:i}),G_OF_OBJ.urlInvoker=="zprojects"&&ZD("div#attachfiledialogdiv").parent().css({"box-shadow":"0 0 8px #B0B0B0","-moz-box-shadow":"0 0 8px #B0B0B0","-webkit-box-shadow":"0 0 8px #B0B0B0","z-index":"999999999"}),ZD("div#showattachfilespace").attachfiledatagrid()}},ATTACHDIALOG.clearSelectedFiles=function(){var a=ATTACHDIALOG.getSelectedDocsForOpenFileDialog();for(var b=0,c=a.length;b<c;b++){var d=a[b].docId;ATTACHDIALOG.selectOrdeselectRow(d)}},ATTACHDIALOG.split=function(a){return a.split(/,\s*/)},ATTACHDIALOG.extractLast=function(a){return ATTACHDIALOG.split(a).pop()},ATTACHDIALOG.startsWithRegEx=function(a,b){var c=a.label,d="^"+b.toLowerCase();if(c.toLowerCase().match(d)==b.toLowerCase())return a;var e=a.fullname;return e.toLowerCase().match(d)==b.toLowerCase()?a:""},ATTACHDIALOG.showHideShareMsg=function(a){var b=ZD(a).hasClass("editmsg_add");b?(ZD(a).text("Discard Message"),ZD(a).removeClass("editmsg_add"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(a).text("Add Message"),ZD(a).addClass("editmsg_add"),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.showHideMsg=function(a){var b=ZD(a).attr("checked");b?(ZD(".docsdialog .checkbox_add").text("Add Message"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(".docsdialog .checkbox_add").text(""),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.searchMouseOver=function(a,b,c,d){if(a==b)return;d=="asc"?ZD("#"+c).attr("class","UpArrow"):ZD("#"+c).attr("class","DownArrow")},ATTACHDIALOG.searchMouseOut=function(a,b,c){if(a==b)return;ZD("#"+c).attr("class","")},ATTACHDIALOG.searchFile=function(a){var a=ZD("#searchFileName").val();if(ZD.trim(a)==="*"||ZD.trim(a)===""){ATTACHDIALOG.statusmsg(zd_js_obj.enter_valid_text_search),ZDUtils.hideLoadingMsg();return}ATTACHDIALOG.changeAllToNormalView(),G_OF_OBJ.selectedLeftPanel="search",ATTACHDIALOG.getSearchResults(a,0)},ATTACHDIALOG.searchSorting=function(a,b){var c=ZD("#searchFileName").val();a==null&&(a="time"),b==null&&(b="desc"),ATTACHDIALOG.getSearchResults(c,0,a,b)},ATTACHDIALOG.getSearchResults=function(a,b,c,d){ZDUtils.LoadingMsg(zd_js_obj.loading),b==null&&(b=0),c==null&&(c="time"),d==null&&(d="desc");var e=ZD("#showopenservicefilespace").children();ZD(e).each(function(a,b){ZD(b).empty().remove()});var f="/docs/viewsearchresults.do?method=attachFileSearch&start="+b+"&field="+c+"&action="+d+"&searchquery="+encodeURIComponent(a)+"&category="+G_OF_OBJ.urlInvoker+"&_t="+(new Date).getTime(),e=ZD("#showattachfilespace").children();ZD(e).each(function(a,b){ZD(b).empty().remove()}),ZD.ajax({url:f,datatype:"html",success:function(a){ZD("#showattachfilespace").html(a),ZDUtils.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.updateSelectedDocs=function(){var a=ATTACHDIALOG.getSelectedDocs();for(var b=0,c=a.length;b<c;b++){var d=a[b].docId;ATTACHDIALOG.selectRow(d)}},ATTACHDIALOG.showStatusMsg=function(a){ZD("#msg_content").html(a),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},function(a){a.widget("ui.attachfiledialog",{options:{recentDocs:{show:!0,name:"recentDocs",id:"recentservicedocs",action:"getDocumentsByType",iconClass:"recentdocs-icon",title:"recentDocs"},desktopDocs:{show:!0,name:"My Folders",id:"desktopservicedocs",action:"getDocumentsForFolder",fid:"folder",iconClass:"zdc-foldericon_css",title:"My Folders"},myDocs:{show:!0,name:"My Docs",id:"mydocs",action:"getDocumentsByType",fid:"folder",iconClass:"mydocs_icon",title:"My Docs"},myPresentations:{show:!0,name:"My Presentations",id:"mypresentations",action:"getDocumentsByType",fid:"folder",iconClass:"mypresentation_icon",title:"My Presentations"},mySheets:{show:!0,name:"My Sheets",id:"mysheets",action:"getDocumentsByType",fid:"folder",iconClass:"myspreadsheet_icon",title:"My Sheets"},myPictures:{show:!0,name:"My Pictures",id:"mypictures",action:"getDocumentsByType",fid:"folder",iconClass:"mypic_icon",title:"My Pictures"},sharedDocs:{show:!0,name:"Shared Docs",id:"sharedservicedocs",iconClass:"shareTome",title:"Shared Docs"},trashedDocs:{show:!0,name:"Trash",id:"trashservicedocs",action:"getTrashedDocuments",iconClass:"trash-icon",fid:"trash"},actionsButton:{showAction:!1,action:!0,id:"actionMenuOpenFile",iconClass:"action-css",value:"Actions"},homeButton:!0,upOneLevel:!1,selectedView:"recentservicedocs",lookIn:!1,advSearchBox:!1},_create:function(){this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._initDelegate();var b=G_OF_OBJ.attachObj.height-220;a("#showattachfilespace").css({height:b})},_constructFileDialog:function(){this.mainPanel=a('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;margin: 12px 0px;">'),this.leftPanel=a('<div class="ui-left-panel flleft" style="width:145px;" >'),this.rightPanel=a('<div class="ui-rht-datadiv">'),this.selectedFilesRow=a('<div id="showSelectedBoxDiv" class="showdiv" style="margin-bottom:2px;"><table cellpadding="0" width="100%"  cellspacing="0"><tr><td width="107" align="center" class="selectfiles"><strong>'+zd_js_obj.selected_files_list+'</strong></td><td><div id="selectboxdiv" class="selectblock zd_scroll"></div></td></tr></table></div>'),this.element.append(this.mainPanel),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel),this.mainPanel.append(this.selectedFilesRow)},_constructLeftPanel:function(){var b=a('<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel"></table>');if(this.options.advSearchBox){var c='<tr><td><div id="attachfilesearchdiv" style="padding-bottom:0px;margin-top:0px;"><div class="searchdiv ui-corner-all docscursor flright"><input type="submit" class="searchIcon flleft docscursor smallText" value=""><input type="text" id="searchFileName" class="searchtext flleft" value=""><input type="hidden" value="search_all_search" name="'+zd_js_obj.label_search_all+'" id="search_type_attachfile" class=""></div><div style="height:15px;border-bottom:1px solid #efefef;margin-bottom:13px;clear:both;"></div></div></td></tr>';a(b).append(c)}else a(b).append('<tr><td><div class="ui-left-heading">'+zd_js_obj.label_favorites+"</div></td></tr>");for(var d in this.options){var e=this.options[d];typeof e.show!="undefined"&&e.show&&a(b).append('<tr><td  class="normalView docscursor" id="'+e.id+'" action="'+e.action+'" ><span class="'+e.iconClass+' flleft margright"></span><span class="flleft" style="line-height:15px;white-space:nowrap;overflow:hidden;" title="'+e.title+'" alt="'+e.title+'">'+e.name+"</span></td></tr>")}this.leftPanel.append(b),a("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=a("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=a('<div id="showattachfilespace" style="background:#fff;margin: 0px 0px 0px 12px;"></div>'),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var a='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td>';this.options.homeButton&&(a+='<span title="'+zd_js_obj.docs_home+'" class="sort-menu lightbluetxt flleft margright " id="homeButton"><span class="home flleft docscursor"></span></span>'),this.options.upOneLevel&&(a+='<span title="'+zd_js_obj.up_one_level+'" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder"><span class="back-folder-inactive flleft"></span></span>'),this.options.lookIn&&(a+='<span class="flright boldText" style="padding-top:5px;color:#676565;">View</span>'),a+='</td><td align="right"><div id="servicefilepagination"  style="float:right; z-index:1000;padding-right:2px;display:none;"></div></td>',a+='<td><div id="openloadingmsg"></div></td></tr></table></div>',this.rightPaneltopContainer.append(a)},_constructStatusMessageRow:function(){this.rightPaneltopContainer.append('<div class="hidediv attach_message"><span id="zd_statusmsgdiv"></span></div>')},_initDelegate:function(){G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),a("#serviceDialogLeftPanel").delegate("td.docscursor","click",function(a){ATTACHDIALOG.getDocAsList(this)}),a("#showattachfilespace").delegate("div.folderDataDiv","click",function(b){var c=a(b.target);if(c.attr("id")=="renameinputform")return!1;ATTACHDIALOG.reset();var d=a(this).attr("folderId"),e=a(this).attr("pntFolderId");a("#servicefilepagination").show(),a("#showattachfilespace").css("display","block"),G_OF_OBJ.parentFolderId=e,G_OF_OBJ.folderId=d,ATTACHDIALOG.getDocAsList()}),a("#showattachfilespace").delegate("table.data-hover","click",function(b){var c=a(b.target);(c.hasClass("selectcheckboxicon_css")||c.hasClass("normalcheckboxicon_css")||c.is("td")||c.is("span"))&&ATTACHDIALOG.showSelectedDocsToAttach(this)}),a("div#selectboxdiv").delegate("span.closeBtn_css","click",function(b){var c=a(this).parent().attr("docId");ATTACHDIALOG.deselectRow(c)}),a("div#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(b){var c=a(this).attr("id");c=="prevbuttonid"?action="previousPage":c=="nextbuttonid"&&(action="nextPage"),a("#showattachfilespace").attachfiledatagrid(action)}),a("#showattachfilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(b){!a("#recentservicedocs").hasClass("selectedView")&&!a("#sharedservicedocs").hasClass("selectedView")&&(a("div#servicefilepagination").hide(),ATTACHDIALOG.setSortOrder(this),ATTACHDIALOG.resetAll(),a("#desktopservicedocs").hasClass("selectedView")&&(G_OF_OBJ.parentFolderId=="0"||G_OF_OBJ.parentFolderId=="1"?G_OF_OBJ.folderId="folder":G_OF_OBJ.folderId=G_OF_OBJ.parentFolderId),ATTACHDIALOG.getDocAsList("",G_OF_OBJ.selectedLeftPanel),ATTACHDIALOG.setClassAfterSorting(this))}),a("#homeButton").bind("click",function(a){var b="";ATTACHDIALOG.getDocAsList(b,"recentservicedocs")}),a("div#attachfilesearchdiv").delegate("input#searchFileName","focusin focusout keypress",function(b){if(b.type=="focusin")a("input#searchFileName").val(""),a("input#search_type_attachfile").addClass("searchquery");else if(b.type=="focusout")a("input#searchFileName").val()==""&&(a("input#searchFileName").val(a("input#search_type_attachfile").attr("name")),a("input#search_type_attachfile").removeClass("searchquery"));else if(b.type=="keypress"&&b.keyCode=="13"){var c=a("input#searchFileName").val();ATTACHDIALOG.searchFile(c)}}),a("div#attachfilesearchdiv").delegate("input.searchIcon","click",function(b){var c=a("input#searchFileName").val(),d=a("input#search_type_attachfile").attr("class");if(c==""||c==null||d!="searchquery"){ATTACHDIALOG.statusmsg("failure_status boldText","Enter valid text to search"),a("input#searchFileName").val(a("input#search_type_attachfile").attr("name"));return}ATTACHDIALOG.searchFile(c)}),a("#moveUpFolder").delegate(".back-folder","click",function(b){a("#desktopservicedocs").hasClass("selectedView")&&(ATTACHDIALOG.changeAllToNormalView("desktopservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.parentFolderId=="0"||G_OF_OBJ.parentFolderId=="1"?G_OF_OBJ.folderId="folder":G_OF_OBJ.folderId=G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList())})},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var b=this.element,c=a(b).children();a(c).each(function(b,c){a(c).undelegate(),a(c).empty().remove()})}}),a.extend(a.ui.filedialog,{version:"1.8"})}(jQuery),function(a){a.widget("ui.attachfiledatagrid",{options:{documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,lastModifiedTime:!0},_create:function(){this._constructHeader(),this.sendAjaxRequest(),this.resize()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.lastModifiedTime=!0},populateDataPanel:function(){this.clearData(),this._constructHeader(),this.sendAjaxRequest(),this.resize()},clearData:function(){var b=this.element,c=a(b).children();a(c).each(function(b,c){a(c).empty().remove()})},_constructHeader:function(){var a='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(a+='<td width="20">&nbsp;</td><td id="nameHeader" height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="/images/spacer.gif" class="DownArrowH" style="margin-left:2px;"></td>'),this.options.lastModifiedTimeHeader&&(a+='<td id="dateModifiedHeader" width="110" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date">'+zd_js_obj.date_modified+'<img id="_sortdate" src="/images/spacer.gif" style="margin-left: 2px;" class="DownArrow"></td>'),a+='</tr></table></div><div id="attachFileDataDiv" style="overflow:auto;vertical-align:top;border:0px solid #000000;">',this.element.append(a)},sendAjaxRequest:function(){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading);var b=this._constructURLParameters();a.ajax({url:b,type:"GET",dataType:"json",success:function(b,c){if(c=="success")return G_OF_OBJ.jsonData=b,a("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs(),a("#recentservicedocs").hasClass("selectedView")&&(a("td#dateModifiedHeader").find("img").remove(),a("td#nameHeader").find("img").remove()),G_OF_OBJ.moveUpFolder=!1,!1}})},_constructURLParameters:function(){var b="",c="",d=a("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return b="method="+a("#"+d).attr("action")+"&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,a("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),d!="recentservicedocs"&&(b+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy),d=="desktopservicedocs"&&(b+="&fid="+G_OF_OBJ.folderId,G_OF_OBJ.folderId!="folder"&&a("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),d=="trashservicedocs"&&(b+="&fid=trash"),G_OF_OBJ.moveUpFolder&&G_OF_OBJ.folderId!="folder"&&(b+="&isParentFolderDocs=true"),d=="recentservicedocs"?b+="&type=myrecentdocs":d=="mydocs"?b+="&type=mydocs":d=="mypresentations"?b+="&type=mypresentations":d=="mysheets"?b+="&type=myspreadsheets":d=="mypictures"&&(b+="&type=mypictures"),b+="&_t="+(new Date).getTime(),c="/docs/attachfilerequest.do?"+b,c},constructDocumentRows:function(){var b="";this.containerDiv=a("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():(this.containerDiv.empty(),this.containerDiv.find(".documentDataDiv").remove());var c=a("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if(c=="desktopservicedocs"){if(G_OF_OBJ.jsonData.FOLDER.length==0&&G_OF_OBJ.jsonData.DOC.length==0){this.noDocuments=a("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,b+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_documents_are_present+"</div></td></tr></table>",this.noDocuments.append(b);return}}else if(G_OF_OBJ.jsonData.DOC.length==0){this.noDocuments=a("div#attachFileDataDiv"),b+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",this.noDocuments.append(b);return}G_OF_OBJ.jsonData.FOLDER.length>0&&Math.abs(G_OF_OBJ.prevIndex)==1&&c=="desktopservicedocs"?this._constructFolderInfoRows():G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,G_OF_OBJ.jsonData.DOC.length>0&&(a("#recentservicedocs").hasClass("selectedView")?G_OF_OBJ.totalFiles=G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.totalFiles=G_OF_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),G_OF_OBJ.folderId=="folder"&&a("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")},_constructDocInfoRows:function(){var b="";G_OF_OBJ.endIndex>G_OF_OBJ.jsonData.DOC.length?b=G_OF_OBJ.jsonData.DOC.length:b=G_OF_OBJ.endIndex,this.containerDiv=a("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var c=G_OF_OBJ.fromIndex;c<b;c++){var d=a("<div>").addClass("documentDataDiv").attr({id:G_OF_OBJ.jsonData.DOC[c].DOCID,fileName:G_OF_OBJ.jsonData.DOC[c].DOCNAME,serviceType:G_OF_OBJ.jsonData.DOC[c].SERVICE_TYPE,isDocumentSharedToMe:!1}).data({serviceType:G_OF_OBJ.jsonData.DOC[c].SERVICE_TYPE,cssName:G_OF_OBJ.jsonData.DOC[c].CLASSNAME,fileName:G_OF_OBJ.jsonData.DOC[c].DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1}),e=a('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),f=a("<tr>"),g=a('<td colspan="4" nowrap="nowrap" width="100%">'),h=ZDUtils.escapeSpecialCharacters(G_OF_OBJ.jsonData.DOC[c].DOCNAME),i=ZDUtils.substringName(h,"40"),j='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(j+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="/images/spacer.gif" class="'+this.options.checkboxIcon+'"/></td>'),this.options.documentIcon&&(j+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+G_OF_OBJ.jsonData.DOC[c].CLASSNAME+' flleft docscursor"></div></td>'),this.options.documentName&&(j+='<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[c].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[c].DOCID+'" service="'+G_OF_OBJ.jsonData.DOC[c].SERVICE_TYPE+'" docName="'+i+'" title="'+h+'" class="docscursor">'+i+"</span></td>"),this.options.lastModifiedTime&&(j+='<td width="90" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span>'+G_OF_OBJ.jsonData.DOC[c].LAST_MODIFIEDTIME+"</span></a></td>"),j+="</tr></table>",g.append(j),f.append(g),e.append(f),d.append(e),this.containerDiv.append(d)}},_constructFolderInfoRows:function(){for(var b=0,c=G_OF_OBJ.jsonData.FOLDER.length;b<c;b++){G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[b].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[b].PARENTFOLDERID);if(G_OF_OBJ.parentFolderId=="1"||G_OF_OBJ.parentFolderId=="0")G_OF_OBJ.folderId="folder";this.folderDataDiv=a("div#attachFileDataDiv");var d=a("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.FOLDER[b].FOLDERID,folderId:G_OF_OBJ.jsonData.FOLDER[b].FOLDERID,pntFolderId:G_OF_OBJ.jsonData.FOLDER[b].PARENTFOLDERID,context:"rightmenu"}).data({folderName:G_OF_OBJ.jsonData.FOLDER[b].FOLDERNAME}),e=a('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),f=a("<tr>"),g=a("<td>"),h=ZDUtils.substringName(G_OF_OBJ.jsonData.FOLDER[b].FOLDERNAME,"40"),i='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(i+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(i+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),this.options.documentName&&(i+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.FOLDER[b].FOLDERNAME+'"><a style="padding-left:6px;">'+h+"</a></td>"),i+="</tr></table>",g.append(i),f.append(g),e.append(f),d.append(e),this.folderDataDiv.append(d)}},_constructPaginationData:function(){var b="";G_OF_OBJ.totalFiles>0&&(b='<table cellspacing="0" cellpadding="0" border="0" ><tr><td nowrap="nowrap" id="pagestatusid" class="pagecount smallText"></td><td><div id="prevbuttonid"  class="prevActive">&nbsp;</div></td><td><div id="nextbuttonid"  class="nextActive">&nbsp;</div></td></tr></table>',a("#servicefilepagination").html(b),G_OF_OBJ.nextIndex>=G_OF_OBJ.totalFiles&&(G_OF_OBJ.nextIndex=G_OF_OBJ.totalFiles,a("#prevbuttonid").removeClass().addClass("prevActive"),a("#nextbuttonid").removeClass().addClass("nextDis")),G_OF_OBJ.prevIndex==1&&a("#prevbuttonid").removeClass().addClass("preDis"),a("#pagestatusid").text(G_OF_OBJ.prevIndex+" - "+G_OF_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_OF_OBJ.totalFiles),a("#servicefilepagination").show())},previousPage:function(){if(a("#prevbuttonid","#servicefilepagination").hasClass("preDis"))return;G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.prevIndex)-Math.abs(1),G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)-(Math.abs(G_OF_OBJ.docsPerPage)-Math.abs(1)),G_OF_OBJ.prevIndex<G_OF_OBJ.topLevelFetch?(G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.prevIndex),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.topLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit)-Math.abs(1),G_OF_OBJ.endIndex="10",G_OF_OBJ.fromIndex="0",G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,a("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")):G_OF_OBJ.prevIndex<=G_OF_OBJ.bottomLevelFetch&&(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.fromIndex)-Math.abs(10),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)-Math.abs(10),a("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")),ATTACHDIALOG.hideLoadingMsg()},nextPage:function(){if(a("#nextbuttonid","#servicefilepagination").hasClass("nextDis"))return!1;G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(1),G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(G_OF_OBJ.docsPerPage),G_OF_OBJ.nextIndex<=G_OF_OBJ.bottomLevelFetch?(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.endIndex),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)+Math.abs(G_OF_OBJ.docsPerPage),a("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")):(G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(1),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit),G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,a("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")),ATTACHDIALOG.hideLoadingMsg()},resize:function(){a("#attachFileDataDiv").css({height:this.element.height()-30})},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var b=this.element,c=a(b).children();a(c).each(function(b,c){a(c).undelegate(),a(c).empty().remove()})}}),a.extend(a.ui.attachfiledatagrid,{version:"1.8"})}(jQuery);