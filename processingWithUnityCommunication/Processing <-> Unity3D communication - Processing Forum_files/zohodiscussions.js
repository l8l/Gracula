function sanitizeURL(a){if(!a||a=="")return a;var b="http",c="https",d=a.indexOf(":");if(d!=-1){var e=a.substr(0,d);e!=b&&e!=c&&e!="ftp"&&e!="mailto"&&(a=b+"://"+a)}else a=b+"://"+a;return a}function sanitize(a){return a==null||a==""?a:(a=a.replace(/<!--(.|\n)*?-->/mg,""),a=a.replace(/<(title|script|style|meta|link)\b((.|\n)*?)<\/\1\b(.*?)>/gmi,""),a=a.replace(/<(title|script|style|meta|link)\b((.|\n)*?)>/gmi,""),a=a.replace(/<\/?(html|head|(x?meta)|title|script|style|link|noembed|bgsound|frame|frameset|noframes)((.|\n)*?)>\n*?/gmi,""),a=a.replace(/<\/?([a-z].*)\b[^>]*>/gmi,function(a){return a=a.replace(/\\0/gmi,""),a=a.replace(/<\/?body/gmi,function(a){return a.toLowerCase()=="<body"?a="<div":a="</div",a}),a=a.replace(/\/\*[^*]+\*\//gmi,""),a=a.replace(/\Won[A-Z]*(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wclass(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wid(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gmi,""),a=a.replace(/\Wdocument\.cookie/gmi,""),a=a.replace(/\.cookie/gmi,""),a=a.replace(/\Wwindow\.location/gmi,""),a=a.replace(/\.location/gmi,""),a=a.replace(/\Wjavascript(\\s|\n)*?:/gmi,""),a=a.replace(/(href|src)(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\4)/gmi,function(a){var b=a.substr(0,3).toLowerCase(),c=null;return b=="hre"?c=new RegExp("('|\"|`)((https?|ftp)|(mailto)):","gmi"):b=="src"&&(c=new RegExp("('|\"|`)(https?):|(^/GetImage?imageName=)","gmi")),a=a.replace(/(\'|\"|`)((.|\n)*?)[^\\](\1)/gmi,function(a){return c.test(a)||(a='""'),a}),a}),a=a.replace(/style(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\3)/gmi,function(a){return a=a.replace(/url\((.|\n)*?\)/gmi,""),a=a.replace(/expression\((.|\n)*?\)/gmi,""),a}),a}),a=a.replace(/<[a-z][a-z0-9]*\s?:\s?[a-z][a-z0-9]*[^>]*>/gmi,""),a=a.replace(/\s*?\n$/gmi,""),a.length>4e4&&(alert(i18n["zohodiscussions.general.textExceedMaximumSizeMessage"]),a=a.substring(0,4e4)),a)}function discussionsValidate($containerToValidate){var $elementsToValidate=$(":input",$containerToValidate),returnValue=!0,integer_pattern=/^[\-|\+]?\d+$/,integer_message="Please enter a valid integer number",float_pattern=/^[\-|\+]?(?:\d*\.?\d+|\d+\.)$/,float_message="Please enter a valid number",email_pattern="^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[a-zA-Z]{2,6}$",email_message="Please enter a valid email",multipleemail_pattern=/^(?:[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2}){0,2}),?\s*)+$/i,multipleemail_message="Please enter a valid email ids",id_pattern=/^([\w-]+(?:[\w-]+)*)$/i,id_message="Please enter a valid id. Spaces are not allowed",url_pattern=/^(?:(?:\w|\d)+\.)+[a-zA-Z0-9]{2,6}$/,url_message="Please enter a valid URL",pattern_message="Sorry. The entered value does not match the required pattern",isTipper=$containerToValidate.attr("isTipper")=="true";return $elementsToValidate.filter('[trim="true"]').each(function(a,b){$(b).val($(b).val().replace(/^\s+/,"").replace(/\s+$/,""))}).end().filter('[mandatory="true"]').each(function(a,b){var c=$(b);c.val()==""&&(message=getCustomMessage(c,c.attr("title")+" cannot be left blank! Please provide a value"),showError(c,message,isTipper),returnValue=!1)}).end().filter("[dataType]").each(function(index,eachItem){var $eachItem=$(eachItem),valueToValidate=$eachItem.val();if(valueToValidate&&valueToValidate!=""){var dataType=$eachItem.attr("dataType");try{dataType=dataType.toLowerCase();var patternToCheck=eval(dataType+"_pattern"),defaultMessage=eval(dataType+"_message");valueToValidate.match(patternToCheck)==null&&(showError($eachItem,getCustomMessage($eachItem,defaultMessage),isTipper),returnValue=!1)}catch(e){return}}}).end().filter("[pattern]").each(function(index,eachItem){var $eachItem=$(eachItem);if(!$eachItem.parents().is(":hidden")&&$eachItem.is(":visible")){var valueToValidate=$eachItem.val();if(valueToValidate&&valueToValidate!=""){var patternToCheck=eval($eachItem.attr("pattern")),defaultMessage=pattern_message;valueToValidate.match(patternToCheck)==null&&(showError($eachItem,getCustomMessage($eachItem,defaultMessage),isTipper),returnValue=!1)}}}),returnValue}function getCustomMessage(a,b){try{customMessage=a.attr("message");if(!customMessage||customMessage=="")customMessage=b;return customMessage}catch(c){return b}}function showError(a,b,c){if(c)return showTipper(b,"failure"),!1;var d=a.attr("name")+"_Error";return $("#"+d).html(b).show(),!1}function doAjaxAction(a,b,c,d){typeof discussionsZaid!="undefined"?b.portalzaid=discussionsZaid:b.portalzaid="-1",typeof isSupportPortalCall!="undefined"&&isSupportPortalCall==1?b.supportPortal="portal/":b.supportPortal="",$.ajax({url:context+a,type:"POST",data:b,error:isROMode==1?roFailureMessage:d,success:c})}function roFailureMessage(a){var b=$.parseJSON(a.responseText);showTipper(i18n[b.message],"failure",3e3)}function showLoadingImage(a){return}function hideLoadingImage(){$("#loadingImg:visible").hide(),$("#ajaxLoaderSmall").remove()}function showSmallLoadingImage(a,b,c){return}function showSmallLoadingImageForCont(a,b,c){b=b!=undefined?b:0,b=a.offset().top+b,c=c!=undefined?c:0,c=a.offset().left+c;var d={};d.top=b,d.left=c;var e=$("#ajaxLoaderSmallTemp").clone();e.attr("popoutPurpose","ajaxLoaderSmall"),e.attr("id","ajaxLoaderSmall"),e.css(d).show(),e.appendTo("body"),e.siblings('div[popoutPurpose="ajaxLoaderSmall"]').remove()}function goToTop(a){return a&&a==1?$("html,body").animate({scrollTop:0},1e3):$(window).scrollTop(0),!1}function setFocusToContainer(a,b,c,d){var e=a.offset().top,f=50;return d!=undefined&&(f=d),b&&b==1?(c=c||1e3,$("html,body").animate({scrollTop:e-f},c)):(c=c!=undefined?c:300,setTimeout(function(){IS_EMBEDDED&&isEmbedAllowedService()?setZDIFrameTop(e-f):$(window).scrollTop(e-f)},c)),!1}function showDiscussionMessage(a,b){return showNewTopicMessage(a,b),!1}function showMessage(a,b,c){return b=b||"info",$("#messageContentCont").html(a),typeof c=="undefined"&&(c="20%"),$("#messageContainer").find("div.borderBox").attr("style","width:"+c),$("#messageContainer").attr("class",b).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function showNewTopicMessage(a,b,c){return b=b||"info",$("#messageContentCont").html(a),typeof c=="undefined"&&(c="20%"),$("#messageContainer").find("div.borderBox").attr("style","width:"+c),$("#messageContainer").attr("class",b).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function hideMessage(){$("#messageContainer").fadeOut(100)}function showTipper(a,b,c){b=b||"info",c=c||4e3,$("#messageContentCont").html(a),$("#messageContainerClose").hide(),$("#messageContainer").attr("class",b).fadeIn(500,function(){setTimeout(function(){$("#messageContainer").fadeOut(500)},c)})}function setToHotkeys(){if(isEmbedService())return!1;isMac==0&&$("#topicListMainContainer").is(":visible")&&setupKbdShortcuts()}function setHotkeysToSinglePost(){if(isEmbedService())return!1;$("#SinglePostContainer").is(":visible")&&setupKbdShortcutsToSinglePost()}function removeHotkeys(){$.hotkeys.remove("o"),$.hotkeys.remove("esc"),$.hotkeys.remove("j"),$.hotkeys.remove("return"),$.hotkeys.remove("space"),$.hotkeys.remove("k"),$.hotkeys.remove("shift+space"),$.hotkeys.remove("n"),$.hotkeys.remove("p"),$.hotkeys.remove("v")}function findCurrentSinglePost(){var a=$("#topicList");a.length<1&&(a=$("#topicsList")),$currentSelected=a.data("currentFocusPost");if(!$currentSelected||$currentSelected.length<1)$currentSelected=a.data("currentSelectedPost");if(!$currentSelected||$currentSelected.length<1)$currentSelected=a.find("div.singleTopicCont:first");return $currentSelected}function setupKbdShortcuts(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}),$.hotkeys.add("v",function(){showLoadingImage();if(isTopicQuickView!="false"){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");processHash("Topic/"+b)}}),$.hotkeys.add("esc",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");$("#lastResponse_"+b).is(":visible")&&handleTopicClick($("quickView_"+b),b,"topicList")}),$.hotkeys.add("return",function(){var a=findCurrentSinglePost(),b=a.attr("forumTopicId");window.open(serverURL+"?ftid="+b)}),$.hotkeys.add("space",function(){var a=findCurrentSinglePost();if(a.is("div.singleTopicContSel")){var b=$(window).height(),c=$(window).scrollTop(),d=a.height(),e=a.next().offset().top,f=b+c>e;if(f){a=a.next();if(a.is(".singleTopicCont")){var g=a.attr("forumTopicId");handleTopicClick($("quickView_"+g),g,"topicList")}}else $(window).scrollTop(c+b-50)}else if(a.is(".singleTopicCont")){var g=a.attr("forumTopicId");handleTopicClick($("quickView_"+g),g,"topicList")}}),$.hotkeys.add("shift+space",function(){var a=findCurrentSinglePost();if(a.is("div.singleTopicContSel")){var b=$(window).height(),c=$(window).scrollTop(),d=a.prev().offset().top,e=c-b<d-50;if(e){a=a.prev();if(a.is(".singleTopicCont")){var f=a.attr("forumTopicId");handleTopicClick($("quickView_"+f),f,"topicList")}}else $(window).scrollTop(c-b+50)}else if(a.is(".singleTopicCont")){var f=a.attr("forumTopicId");handleTopicClick($("quickView_"+f),f,"topicList")}}),$.hotkeys.add("j",function(){var a=findCurrentSinglePost();a.is("div.singleTopicContSel")&&(a=a.next());if(a.is("div.singleTopicCont")){var b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}}),$.hotkeys.add("k",function(){var a=findCurrentSinglePost();a.is("div.singleTopicContSel")&&(a=a.prev());if(a.is("div.singleTopicCont")){var b=a.attr("forumTopicId");handleTopicClick($("quickView_"+b),b,"topicList")}}),$.hotkeys.add("n",function(){var a=findCurrentSinglePost(),b=a.next();if(b.is("div.singleTopicCont")||b.is("div.singleTopicContSel"))a.removeClass("hotKeyTopicCont"),b.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",b),toSetFocusOnCurrPost(b,"next")}),$.hotkeys.add("p",function(){var a=findCurrentSinglePost(),b=a.prev();if(b.is("div.singleTopicCont")||b.is("div.singleTopicContSel"))a.removeClass("hotKeyTopicCont"),b.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",b),toSetFocusOnCurrPost(b,"prev")})}function toSetFocusOnCurrPost(a,b){var c=a.offset().top,d=$(window).height(),e=$(window).scrollTop();b=="next"?c-e>d-50&&$(window).scrollTop(c-d+80):e>c&&$(window).scrollTop(c)}function setupKbdShortcutsToSinglePost(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){return!1}),$.hotkeys.add("v",function(){return!1}),$.hotkeys.add("esc",function(){return!1}),$.hotkeys.add("return",function(){var a=$("#SinglePostContainer").attr("forumTopicId");window.open(serverURL+"?ftid="+a)}),$.hotkeys.add("space",function(){var a=$(window).height(),b=$(window).scrollTop();$(window).scrollTop(b+a)}),$.hotkeys.add("shift+space",function(){var a=$(window).height(),b=$(window).scrollTop();$(window).scrollTop(b-a)}),$.hotkeys.add("j",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");b!=undefined&&(a=b),a++,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("k",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");if(b==undefined)return!1;a=b,a--,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("n",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");b!=undefined&&(a=b),a++,toSetFocusOnCurrResponse($currentSelected,a)}),$.hotkeys.add("p",function(){$currentSelected=findCurrentSingleResponse();var a=0,b=$currentSelected.attr("currkey");if(b==undefined)return!1;a=b,a--,toSetFocusOnCurrResponse($currentSelected,a)})}function findCurrentSingleResponse(){$currentSelected=$("#SinglePostContainer").data("currentFocusResponse");if(!$currentSelected||$currentSelected.length<1){var a=$("#SinglePostContainer").attr("forumTopicId");$currentSelected=$("#SinglePostContainer_"+a).find("div.postContainer")}return $currentSelected}function toSetFocusOnCurrResponse(a,b){var c=$("#SinglePostContainer").attr("forumTopicId"),d="";if(b=="0")d=$("#SinglePostContainer_"+c).find("div.postContainer"),a.removeClass("HotKeysingleReplyContainer");else{d=$("#SinglePostContainer_"+c).find("span.hotKey_"+b);if(d.length==0)return!1;a.removeClass("HotKeysingleReplyContainer"),d.addClass("HotKeysingleReplyContainer")}var e=d.offset().top;$("html,body").animate({scrollTop:e-10},500),$("#SinglePostContainer").data("currentFocusResponse",d)}function resizeZDIFRAME(a){IS_EMBEDDED==1&&isEmbedAllowedService()&&(a=a?a:$("#mainContent").height(),a&&(DOC_HT=a,document.cookie="zdHt="+a+";path=/",SendMessageToParent("zdframeht:"+parseInt(a+12))))}function setZDIFrameTop(a){a=a?a:0,SendMessageToParent("zdframetop:"+a)}function uploadShowMessage(a){forHidingSmallLoadingImg(),hideLoadingImage(),showMessage(i18n[a],"failure")}function countString(a){var b=a!="0"?" ("+(a-1)+")":"";return b}function slideUpActionInModeration(a,b,c){showLoadingImage();var d=c.parents("div.moderateSinglePost"),e=c.attr("itemType");d.slideUp(300,function(){d.hide()});var f=$("#moderationTabCont").find('li[itemType="All"]').find("span"),g=f.attr("totalCount");countHTML=countString(g),f.html(countHTML).attr("totalCount",g-1);var h=$("#moderationTabCont").find("li[itemType="+e+"]").find("span"),i=h.attr("totalCount");countHTML=countString(i),h.html(countHTML).attr("totalCount",i-1),hideLoadingImage(),doAjaxAction(a,b,function(a){if(a=="SUCCESS"){var b=$("#awaitingCountCont").attr("totalCount"),c=countString(b);$("#awaitingCountCont").html(c).attr("totalCount",b-1),d.remove();if(g==1||b==1||h==1){var e=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(e)}}else{var e=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(e),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)}},function(a){var b=$("#awaitingCountCont").attr("totalCount"),c=countString(b);$("#awaitingCountCont").html(c).attr("totalCount",b+1);var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)})}function isEmbedCallfromIntranet(){if(IS_EMBEDDED){var a=$("#mainContent").height();clearTimeout(b);var b=setTimeout(function(){var c=$("#mainContent").height();a&&a!=c&&(a=c,clearTimeout(b))},300)}}function isHistoryNotAllowedService(a,b){return isZIntranet||isZSupport?!1:(a&&(parseInt(b)>1?$.history.add(a+"/"+b):$.history.add(a)),!0)}function isEmbedAllowedService(){return isZIntranet||isZSupport?!1:!0}function isEmbedService(){return isZIntranet||isZSupport?!0:!1}function isFromSupportService(){return isZSupport?!0:!1}function isCancelButtonClicked(a){return isZIntranet||isZSupport?forumClickAction(-1):processHash(a),!1}function newOpenEditor(a,b,c,d,e,f,g){var h=a.show(),i=h.next(),j=$('<textArea name = "'+b+'" id = "'+c+'" style = "display:none;"></textarea>'),k="",l=!0;e=="Edit"||b=="privateMsgContent"?l=!1:$("#writeNewTopic").attr("isDraft")=="true"&&(l=!1),h.is(":input")?k=h.val():k=h.html(),k=" "+k;var m=document.createElement("div");m.innerHTML=k,$(m).find("div.__zd_findAndReplace").remove(),$(m).find("div.__zd_findAndReplaceParent").remove(),k=m.innerHTML,l==1&&(k+=userSignature),j.val($.trim(k));var n,o="",p,q="",r=!1;if(d){$("#editorHolder").remove(),n=$('<form id = "editorHolder" ></form>'),$replyLinkLocation=$("#"+d),o=$replyLinkLocation.attr("forumTopicId"),o=o||$replyLinkLocation.parents('div[parentCont="actualParent"]').attr("forumTopicId");var s=$replyLinkLocation.attr("responseId"),t=$replyLinkLocation.attr("isPrivate"),u=$replyLinkLocation.attr("isThread"),v=$replyLinkLocation.attr("forumId"),w=$replyLinkLocation.attr("categoryId"),x=$replyLinkLocation.attr("responseAuthorId"),y="";if(e=="TweetPost"){var z=$replyLinkLocation.attr("tweetBy");q=$replyLinkLocation.attr("statusId");var A=$("#twitterCont_"+q).text(),B=$("#twitterImg_"+q).attr("src");p=$('<div style="clear:both;" class="replyContainer" id="replyTweetContainer_'+q+'"></div>');var C=$('<div class="content"></div>');C.append(n),p.append('<div class="boldText header">Reply to @'+z+"</div>"),p.append(C);var D=$('<div class="ndSelectionCont"</div>');D.html($("#twitterForumsOptions").html()),n.append(D),n.append('<input type = "hidden" name = "twitterAuthorId" value = "'+z+'">').append('<input type = "hidden" name = "twitterAuthImg" value = "'+B+'">').append('<input type = "hidden" name = "statusTwitterId" value = "'+q+'">').append('<input type = "hidden" name = "tweetContent" value = "'+A+'">').append('<input type = "hidden" name = "twitterResponseContent" value = "">').append('<input type = "hidden" name = "topicStatus" value = "0">'),v!=-1&&(n.append('<input type = "hidden" name = "forumId" value = "'+v+'">'),r="true"),w!=-1&&n.append('<input type = "hidden" name = "categoryId" value = "'+w+'">')}else y=$replyLinkLocation.attr("postTitle"),n.append('<input type = "hidden" name = "forumId" value = "'+v+'">').append('<input type = "hidden" name = "categoryId" value = "'+w+'">');n.append('<input value="'+y+'" name = "forumPostTitle" class="normalText zdtxtboxbro" type="text"/>').append('<input type = "hidden" name = "forumTopicId" value = "'+o+'">').append('<input type = "hidden" name = "responseId" value = "'+s+'">').append('<input type = "hidden" name = "forumGroupId" value = "'+forumGroupId+'">').append('<input type = "hidden" name = "isPrivate" value = "'+t+'">').append('<input type = "hidden" name = "isThread" value = "'+u+'">').append('<input type = "hidden" name = "'+csrfParamName+'" value = "'+csrfToken+'">').append('<input type = "hidden" name = "portalzaid" value = "'+discussionsZaid+'">').append('<input type = "hidden" name = "detectSpamPresence" value = "1">').append('<input type = "hidden" name = "isFollowTopic" value = "false">'),e&&e=="Edit"&&x==ZUID&&n.append('<input type = "hidden" name = "responseowner" value = "true">')}else n=$('<div id = "editorHolder"></div>');n.append(j),e!="TweetPost"?n.insertAfter(h.hide()).show():p.insertAfter(h.hide()).show(),createEditor();if(e){$replyLinkLocation=$("#"+d);var o=$replyLinkLocation.attr("forumTopicId"),s=$replyLinkLocation.attr("responseId"),E=e=="Write"||e=="TweetPost"?i18n["zohodiscussions.general.publish"]:i18n["zohodiscussions.general.update"],F=$('<button id="publishResponse" class="ashBtn normalText boldText">'+E+"</button>"),G=$('<button id="previewResponse" class="ashBtn normalText boldText">'+i18n["zohodiscussions.writePost.preview"]+"</button>"),H=$("<button id='cancelResponse' class='ashBtn normalText boldText'>"+i18n["zohodiscussions.general.cancel"]+"</button>"),I="false";F.click(function(){addForumResponse(o,e,s,q)}),H.click(function(){$("#editorHolder").remove(),$("#responseAttachmentContActual").remove(),$("#SinglePostContainer_"+o).find('div[purpose="editorActionUtilCont"]').remove(),$("#postTextContent_"+s).find('div[purpose="editorActionUtilCont"]').remove(),$("#eachTopicReplyCont_"+o).find('div[purpose="editorActionUtilCont"]').remove(),$("#responsePreviewButtonInTopicList").length>0&&$("#responsePreviewButtonInTopicList").remove(),h.show(),e=="TweetPost"&&$("#replyTweetContainer_"+q).remove(),$("#topicList").is(":visible")&&$("#topicList").data("inEditMode",!1),$("#"+f).data("inEditMode",!1);var a="";$("#newThreadResponseCont_"+s).is(":visible")?a="#newThreadResponseCont_"+s:$("#newResponseCont_"+o).is(":visible")?a="#newResponseCont_"+o:$("#eachTopicReplyCont_"+o).is(":visible")&&(a="#eachTopicReplyCont_"+o),a!=""&&$(""+a+"").hide();if(f=="privateMsgInboxContainer")$("#privateMsgCont_"+o).hide();else if(f=="privateMsgSentContainer")$("#privateMsgCont_"+o).hide(),$("#topicContent_"+o).parent().find("div.bigMinusIcon").length>0&&$("#topicContent_"+o).show();else if(f=="editorContainer_PM")processHash("user/"+$("#UserPM").attr("authorName"));else if(f=="eachTopic_"+s){var b=$("#paginationContainer");b.data("inEditMode",!1),$("#singlePostActions_"+s).show(),$("#linkedTopic_"+s).show(),$("#recent_ResPonse_"+s).find("div.navigationCont").show()}else f=="topicContainer_"+o&&($("#postTypeActions_"+s).show(),$("#linkTopicCont_"+o).show(),$("#statusContainer").show());i.is(".Attachments")&&i.show(),$("#responsePreviewContainer").is(":visible")&&($("#responsePreviewContainer").length>0||$singleThreadPreviewCont.length>0)&&($("#responsePreviewContainer").remove(),$("#fullThreadResponseContainer").remove());if($("#responseContentContainer_"+s).is(":visible")==1){$("#fullResponseContainer_"+s).find("div.postTypeActions").show();var c=$("#responsePreviewButton"),d=$("#fullResponseContainer_"+s),g=$("#responseContentContainer_"+s);CancelPreview(c,d,g)}if($("#recentResponseContent_"+s).is(":visible")==1){$("#postTextContent_"+s).find("ul.singlePostActions").show(),$("#resposeVoteLink_"+s).show(),$("#chooseBestResponse_"+s).show();var c=$("#responsePreviewButtonInTopicList"),d=$("#postTextContent_"+s),j=$("#recentResponseContent_"+s);CancelPreview(c,d,j)}});if(e=="TweetPost"){var J=D.find("#forum_Twitter_SelectForum");D.find("#forum_Twitter_SelectSubForum").attr("id","forum_Twitter_SelectSubForum_"+q),r!="true"&&loadTweetCategories(J.val(),"twitter_SubForumList","forum_Twitter_SelectSubForum_"+q),J.change(function(){var a=$(this).val();loadTweetCategories(a,"twitter_SubForumList","forum_Twitter_SelectSubForum_"+q)})}var K=$("#responseAttachmentContTemplate").clone();K.attr("id","responseAttachmentContActual");var L=K.find("div.whiteAttachmentBox").show();K.find('div[attachmentPurpose="browseBox"]').attr("id","attachBrowseCont");var M=L.find('ul[purpose="responseAtatchmentsListCont"]').attr("id","attachmentsListCont");if(e=="Edit"){if(i.is(".Attachments")){I="true";var N=i.find('div[purpose="attachmenUtilCont"]'),O=N.attr("attachmentIds"),P=N.attr("attachmentNames"),Q=N.attr("attachmentSizes"),R=O.split(","),S=P.split(","),T=Q.split(",");for(index=0;index<R.length;index++){var U=R[index],V=S[index],W=T[index],X=U+","+V+","+W;$currentAttachment=$("#responseEachAttachmentTemplate").clone(),$currentAttachment.attr("id","newAttachment_"+U).attr("attachmentDetails",X).show(),$currentAttachment.find('[attachmentPurpose="attachmentName"]').html(V),$currentAttachment.find('[attachmentPurpose="attachmentSize"]').html(W),$currentAttachment.find("div.imgAshDelete").attr("thisAttachmentId",U).attr("thisAttachmentName",V),$currentAttachment.find("div.imgAshDelete").click(function(a){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(a),$this=$(this);var b=$this.attr("thisAttachmentId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=o,c.fileName=$this.attr("thisAttachmentName"),c.fileId=b,c[csrfParamName]=csrfToken,doAjaxAction("/deleteAttachment.do",c,function(a){hideLoadingImage(),a=="SUCCESS"&&($("#newAttachment_"+b).remove(),$("#eachAttachmentForPreview_"+b).remove(),$("#fullResponseContainer_"+s).find('li[attachmentId="'+b+'" ]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont(),H.attr("disabled",!0),H.unbind("click"))})}}),M.append($currentAttachment)}i.hide()}$("#postTypeActions_"+s).hide()}if((maxAttachmentsPerPost>0||I=="true")&&g!="true"){var Y=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-right:10px;"></div>');K.insertAfter($("#editorHolder")).css("margin-top",4).show()}else{var Y=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-top:25px;margin-right:10px;"></div>');K.insertAfter($("#editorHolder")).css("margin-top",4)}Y.append(F),f!="paginationContainer"&&e!="TweetPost"&&Y.append(G),K.find("div.whiteAttachmentBox").css("border-width",1),Y.append(H).insertAfter(K),loadUploadAttachmentsCont(),G.click(function(){var a=$(this),b=a.attr("location"),c=$("#editorHolder").find("input[name=forumPostTitle]").val(),e=c.replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;"),f=a.attr("forumTopicId"),g=a.attr("responseId"),h=editor.getContent();h=h.replace(/^\s+/g,"").replace(/\s+$/g,"");if(b=="editResponse"||b=="editTopic"){var g=a.attr("responseId"),i=$('<div class=" approveButton flRight"> This is preview! </div>');if(b=="editTopic"){var j=$("#DocumentTitle");j.css("width","74%"),i.insertAfter(j.parent())}else $("#fullResponseContainer_"+g).find("div.sppostHeader").append(i);$("#responsePreviewButton").length==0?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButton")):$responsePreviewButton=$("#responsePreviewButton"),b=="editTopic"&&($("#fullResponseContainer_"+g).find("div.postTypeActions").hide(),$responsePreviewButton.insertAfter($("#fullResponseContainer_"+g).find("div.postTypeActions")).show());var k=$("#fullResponseContainer_"+g);newEditorLocationHide(f,k),k.find("div.replyOutHeader").append('<div class="flRight statusMessage"><span class="boldText moderation">This is preview!</span></div>');if(b=="editTopic"){$("#DocumentTitle").hide();var l=$("#DocumentTitle").clone();l.attr("id","postTitlePreviewContainer"),l.insertAfter($("#DocumentTitle")),l.html(e).show()}else{var m=$("#fullResponseContainer_"+g).find("div.sppostHeader h4");m.hide();var n=m.clone();n.attr("id","responseTitlePreviewContainer"),n.insertAfter(m),n.html(e).show()}editAndPreviewPost($responsePreviewButton,$("#postTypeActions_"+g),k,b),q=$("#fullResponseContainer_"+g).find("div.attachmentListCont").hide();var o=$("#fullResponseContainer_"+g).find('div[purpose ="attachmentListContForPreview"]'),p=$("#responseContentContainer_"+g);attachmentPreview(p,q,k,a),$("#cancelResponse").attr("disabled")==1&&$("#responsePreviewButton").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),o.show(),previewContentContainer($("#responseContentContainer_"+g),h),previewActions($("#fullResponseContainer_"+g),f,g,H,F,I)}else if(b=="topicListEditResponse"){$("#responsePreviewButtonInTopicList").length==0?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButtonInTopicList")):$responsePreviewButton=$("#responsePreviewButtonInTopicList");var k=$("#postTextContent_"+g);newEditorLocationHide(f,k);var p=$("#recentResponseContent_"+g),q=$("#postTextContent_"+g).find("div.attachmentListCont").hide(),o=$("#postTextContent_"+g).find('div[purpose ="attachmentListContForPreview"]');o.show(),$("#cancelResponse").attr("disabled")==1&&$("#responsePreviewButtonInTopicList").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),attachmentPreview(p,q,k,a),previewContentContainer($("#recentResponseContent_"+g),h),editAndPreviewPost($responsePreviewButton,$("#postTextContent_"+g),k,b),previewActions($("#responsePreviewButtonInTopicList"),f,g,H,F,I)}else{$("#responsePreviewContainer").length==0?($responsePreviewContainer=$("#responsePreviewContainerTemplate").clone(),$responsePreviewContainer.attr("id","responsePreviewContainer")):$responsePreviewContainer=$("#responsePreviewContainer");if(d=="newThreadReply_"+g)if($("#fullThreadResponseContainer").length==0)var r=$("");else var r=$("#topicContainer_"+f).find('div[purpose="threadResponseContainer"]');$responsePreviewContainer.find('[purpose="previewResponseAttachment"]').attr("id","attachmentForResponsePreview"),d=="newThreadReply_"+g?($responsePreviewContainer.insertAfter("#newThreadResponseCont_"+g).show(),$responsePreviewContainer.addClass("thread"),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","threadResponse"),$("#replyToTopicBtn_"+f).attr("location","threadResponse")):($responsePreviewContainer.insertAfter("#newResponseCont_"+f),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","topicResponse"),$("#replyToTopicBtn_"+f).attr("location","topicResponse")),$responsePreviewContainer.find('[purpose="topicTitleOfResponse"]').html(e),$responsePreviewContainer.find('div[purpose="responseContPreviewContainer"]').html(h),d=="newThreadReply_"+g?($("#newThreadResponseCont_"+g).hide(),r.show(),r.find("div.singleReplyContainer").show()):($responsePreviewContainer.show(),$("#newResponseCont_"+f).hide());var s=a.find('input[name="attachmentId"]');$.each(s,function(a,b){var c=$(b).attr("attachmentDetails").split(","),d=$('<li id="eachAttachmentForPreview_'+c[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+c[1]+'</a><div class="spattachmentConent"><span>Size : '+c[2]+" </span>&nbsp;&nbsp;</div></div></li>");$("#attachmentForResponsePreview").append(d)}),$("#attachmentForResponsePreview > li").length>0?$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').show():$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').hide(),previewActions($responsePreviewContainer,f,g,H,F,I)}})}$("#editorHolder iframe").attr("id","editorframecont")}function toggleSections(a,b){a.find("div[purpose]").hide().end().find('div[purpose="'+b+'"]').show().end().find("li[purpose]").removeClass("selectedMenu").end().find('li[purpose="'+b+'"]').addClass("selectedMenu")}function uploadError(a){var b=$("#imageDialog");b.find("#image_error").hide().html(a).css("background","#FFF1A8").fadeIn()}function previewActions(a,b,c,d,e,f){a.find('button[purpose="backToEditorResponse"]').unbind("click").click(function(){var d=$(this),e=d.attr("location");e=="topicResponse"?(a.hide(),$("#newResponseCont_"+b).show()):e=="editEachResponse"?($("#resposeVoteLink_"+c).show(),$("#chooseBestResponse_"+c).show(),backtoEditorWhilePreviewing($("#fullResponseContainer_"+c),$("#responseContentContainer_"+c),$("#responsePreviewButton"),b,f)):e=="topicListEditResponse"?backtoEditorWhilePreviewing($("#postTextContent_"+c),$("#recentResponseContent_"+c),$("#responsePreviewButtonInTopicList"),b,f):($("#newThreadResponseCont_"+c).show(),$("#fullThreadResponseContainer").hide(),a.remove()),$("#attachmentForResponsePreview").html(" ")}),a.find('button[purpose="publishPreviewResponse"]').unbind("click").click(function(){e.trigger("click")}),a.find('button[purpose="cancelPreviewResponse"]').unbind("click").click(function(){var a=$(this),b=a.attr("location");if(b!="topicResponse")if(b=="editEachResponse"){var e=$("#fullResponseContainer_"+c).find('div[purpose ="attachmentListContForPreview"] > ul');e.html(" "),$("#fullResponseContainer_"+c).find("div.replyOutHeader > div.statusMessage").remove()}else if(b=="topicListEditResponse"){var e=$("#postTextContent_"+c).find('div[purpose ="attachmentListContForPreview"] > ul');e.html(" "),$("#postTextContent_"+c).find("div.statusMessage").remove()}$("#fullResponseContainer_"+c).find("div.approveButton").remove(),d.trigger("click")})}function editAndPreviewPost(a,b,c,d){var d=d=="editResponse"||d=="editTopic"?"editEachResponse":"topicListEditResponse";a.insertAfter(b).show(),c.find('div[purpose="editorMainParentCont"]').hide(),c.find('div[purpose="editorActionUtilCont"]').hide(),a.find('button[purpose="publishPreviewResponse"]').html(i18n["zohodiscussions.general.update"]),a.find('button[purpose="backToEditorResponse"]').attr("location",d),a.find('button[purpose="publishPreviewResponse"]').attr("location",d),a.find('button[purpose="cancelPreviewResponse"]').attr("location",d)}function CancelPreview(a,b,c){a.remove(),b.find("div.Attachments").show(),b.find("div.attachmentListCont").show(),b.find('div[purpose ="attachmentListContForPreview"]').hide(),c.show(),$("#previewContentContainer").remove(),$("#newAttachmentForPreview").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),b.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function previewContentContainer(a,b){a.hide();if($("#previewContentContainer").length==0)var c=$('<div id="previewContentContainer" class="postContent"> </div>');else c=$("#previewContentContainer");c.insertAfter(a),c.html(b).show()}function backtoEditorWhilePreviewing(a,b,c,d,e){newEditorLocationShow(d,a,e),b.hide(),a.find("div.Attachments").hide(),$("#previewContentContainer").hide();var f=a.find('div[purpose ="attachmentListContForPreview"] > ul');f.html(" ");var g=$("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]');g.html(" "),a.find("div.replyOutHeader > div.statusMessage").remove(),c.hide(),$("#responsePreviewContainer").remove(),$("#SinglePostContainer_"+d).find("div.approveButton").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),a.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function attachmentListPreview(a,b){$.each(b,function(b,c){var d=$(c).attr("attachmentDetails").split(","),e=$('<li id="eachAttachmentForPreview_'+d[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+d[1]+'</a><div class="spattachmentConent"><span>Size : '+d[2]+" </span>&nbsp;&nbsp;</div></div></li>");a.append(e).show()})}function attachmentPreview(a,b,c,d){var e=c.find('div[purpose ="attachmentListContForPreview"]');if(e.length==0&&$("#newAttachmentForPreview").length==0){var f=$('<div class="Attachments attachments"><div class="attachmentListCont spattachmentList" purpose ="attachmentListContForPreview"><h3><span class="imgAttach flLeft"></span> Attachments </h3> <ul class="ulNoStyle"> </ul></div>');f.insertAfter(b)}$("#newAttachmentForPreview").length==0&&$("#attachmentsListCont").find('li[purpose="attachmentDetails"]').length>0&&b.length==0&&($newAttachmentForPreview=$("#responsePreviewContainerTemplate").find('div[purpose ="attachmentResponsePreviewCont"]').clone(),$newAttachmentForPreview.attr("id","newAttachmentForPreview"),$newAttachmentForPreview.insertAfter(a),$newAttachmentForPreview.find("div.attachmentListCont").show());if($("#newAttachmentForPreview").length>0){$("#newAttachmentForPreview").show();var g=d.find('input[name="attachmentId"]'),h=$("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]');attachmentListPreview(h,g),$newAttachmentForPreview.find("div.attachmentListCont").show()}else{var g=$("#attachmentsListCont").find('li[purpose="attachmentDetails"]'),h=c.find('div[purpose ="attachmentListContForPreview"] > ul');attachmentListPreview(h,g)}c.find('div[purpose ="attachmentListContForPreview"] > ul > li').length>0||$("#newAttachmentForPreview").find('ul[purpose ="previewResponseAttachment"] > li').length>0?c.find("div.Attachments").show():c.find("div.Attachments").hide()}function imageUploaded(a,b,c,d){$("#imagePreview").attr({src:a,width:"100",height:"100"});var e=$("#imageDialog");e.find("#image_error").html(""),e.find(':input[name="linkTo"]').val(d),e.find(':button[action="insertImage"]').attr("disabled","").end().find(':input[name="uploadedImageUrl"]').val(a)}function imageAdded(a,b){var c=$("#imageDialog"),d={};d.title=c.find('[name="title"]').val(),d.altText=c.find('[name="altText"]').val(),d.linkTo=c.find('[name="linkTo"]').val(),d.imgSize=c.find('[name="imgSize"]').filter(":checked").val(),$("#"+b).data("editor").addImage(a,d),$("#imageDialog").hide()}function toggleSections(a,b){a.find("div[purpose]").hide().end().find('div[purpose="'+b+'"]').show().end().find("span[purpose]").removeClass("select").addClass("default").end().find('span[purpose="'+b+'"]').removeClass("default").addClass("select")}function fillImageUrl(){var a=$("#imageDialog");if(a.find("#urldiv").is(":visible")){var b=a.find(':input[name="url"]').val();b&&$.trim(b)!=""&&($.trim(b)!=""&&isValidUrl(b)?a.find(':input[name="linkTo"]').val(b).end().find("#imagePreview").attr({src:b,width:"100",height:"100"}).end().find(':button[action="insertImage"]').attr("disabled",""):(alert(i18n["zohodiscussions.settings.PleaseEnteraValidurl"]),a.find(':input[name="url"]').focus()))}else{var b=a.find(':input[name="uploadedImageUrl"]').val();a.find(':input[name="linkTo"]').val(b)}}function isValidUrl(a){return a&&$.trim(a)!=""?(url_pattern="^https?://[A-Za-z0-9-_]+(?:\\.[A-Za-z0-9-_%&?/.=]+)*$",a.match(url_pattern)!=null?!0:!1):!1}function uploadImage(){var a=$("#imageDialog");if($.trim(a.find("[name='imageFileName']").val())!=""){var b=a.find("form");a.find("#image_error").html("<em>Uploading .. <img src = '/images/progressbarsmall.gif' /></em>").end().find(':button[action="insertImage"]').attr("disabled","true"),b.find(':hidden[name="responseId"]').val($('#editorHolder :hidden[name="responseId"]').val()),b.attr("action","/uploadImage.do"),b.attr("enctype","multipart/form-data").attr("encoding","multipart/form-data"),b.get(0).submit()}}function toggleImageSelection(a){if($(a).attr("id")=="uploadSection")$(a).addClass("select"),$("#urlSection").removeClass("select"),$("#uploaddiv").show(),$("#urldiv").hide();else{$(a).addClass("select"),$("#uploadSection").removeClass("select"),$("#uploaddiv").hide();var b=$("#urldiv");b.show(),b.find(':inpur[name="url"]').focus()}}function newEditorLocationHide(a,b){$("#editorHolder").hide(),b.find('div[purpose="editorActionUtilCont"]').hide(),$("#responseAttachmentContActual").hide()}function newEditorLocationShow(a,b,c){$("#editorHolder").show(),(maxAttachmentsPerPost>0||c=="true")&&$("#responseAttachmentContActual").show(),b.find('div[purpose="editorActionUtilCont"]').show()}function initTabContClick(){$("#homeTab,#allforumsTab,#myareaTab,#SettingsTab,#NewTopicTab,#Search,#twitterMainTab").click(function(){var a=$(this),b=a.attr("hashPurpose");return processHash(b,"",a),!1}),$("#searchComboDownArrow").parent().click(function(){displaySearchOption()}),$("#searchTab input").focus(function(){$("#searchTab").addClass("searchBoxFocus")}).focusout(function(){$("#searchTab").removeClass("searchBoxFocus")})}function updateAwaitingApprovalCount(){if(!isEmbedService()){var a={};a.forumGroupId=forumGroupId,doAjaxAction("/getAwaitingApprovalCount.do",a,function(a){var b=a!="0"?" ("+a+")":"";$("#awaitingCountCont").html(b).attr("totalCount",a)})}}function processHash(a,b,c){if(isEmbedService())return!1;if(isTopicQuickView=="false"&&b!="withHash"){if(a.toLowerCase()=="home")a="recent";else{if(a.toLowerCase()=="search"||a.toLowerCase()=="normalsearch"){var d=$("#searchSelectedImage").attr("purpose"),e=$("#searchInputBox"),f="",g=e.val(),h=$("#forumComboCont"),i=$("#categoryComboCont"),j=h.attr("forNiceUrl"),k=i.attr("forNiceUrl");typeof k!="undefined"&&k!=""?f=k:f=j;if(typeof f=="undefined"||f=="")f="";a.toLowerCase()=="normalsearch"&&(g=$("#normalSearchInputBox").val()),g=$.trim(g),g=encodeURIComponent(g),g=g.replace(/\*/g,"%2A").replace(/\~/g,"%7E").replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");if(g==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure");return}var l="";return typeof d=="undefined"?l="":d!="all"&&(l=d+"/"),location.href=serverURL+f+"/search/"+l+g,!1}if(typeof c!="undefined"&&c.attr("id")=="NewTopicTab"){if(a=="")return!1;var m=a.split("/"),n=m[0],o=n.toLowerCase(),p=m[1],q=m[2];return discussionsFunctions.newtopic(o,p,q),!1}}return location.href=serverURL+"/"+a.toLowerCase(),!1}if(shouldReload==1&&a!="Search")return window.location.href=serverURL+"#"+a,!1;showLoadingImage();if(a=="")return isTopicQuickView=="false"?(window.location.href=serverURL+"/recent",!1):(discussionsFunctions.home("home",1),!1);var m=a.split("/"),n=m[0],o=n.toLowerCase();selectTab(o);switch(o){case"home":case"chome":var r=1;parseInt(m[1])>1&&(r=m[1]),discussionsFunctions[o](n,r);break;case"alltags":discussionsFunctions[o](n);break;case"allforums":discussionsFunctions[o](n);break;case"stats":window.location.href=serverURL+"/stats";break;case"search":g=m[1],discussionsFunctions[o](n,g);break;case"normalsearch":g=$("#normalSearchInputBox").val(),discussionsFunctions.search(n,g);break;case"myarea":var s=m[1],t="";s&&(s=s.toLowerCase()),s=="watchlist"?(t=m[2],t&&(t=t.toLowerCase())):s=="friends"&&(t=m[2],t&&(t=t.toLowerCase())),discussionsFunctions[o](n,s,t);break;case"moderation":window.location.href=serverURL+"/moderation";break;case"settings":discussionsFunctions[o](n);break;case"topic":var u=m[1],v=m[2];discussionsFunctions[o](n,u,v);break;case"forum":var w=m[1],r=1;if(m[2]){var x="",y=parseInt(2);if(m[y]!="filter"&&m[y].toLowerCase()!="all"){var z=parseInt(m[y]);z>0?(r=z,y+=1):(x=m[y],y+=1)}if(m[y])if(m[y]=="filter"){y+=1;var A=m[y],B="";A=A.toLowerCase();if(A=="twitter"){var p=$("#searchTwitterTab").attr("forumId");getTwitterSearchList(p,1,w);return}A!="discussions"&&A!="questions"&&A!="ideas"&&A!="problems"&&A!="announcement"&&A!="sticky"&&A!="unrepliedposts"&&A!="postssincelastvisit"?(A="all",isOneTopicType!="true"&&(y+=1)):(y+=1,m[y]&&(B=m[y])),isOneTopicType=="true"&&A=="all"&&(B=m[y]),m[y]&&parseInt(m[y])>0&&(r=m[y]),getMoreTopics(w,x,r,A,"",B,"reload")}else m[y]&&parseInt(m[y])>0&&(r=m[y]),discussionsFunctions[o](n,w,x,r);else discussionsFunctions[o](n,w,x,r)}else discussionsFunctions[o](n,w,"",r);break;case"filter":var A=m[1];A=A.toLowerCase();var B="",r=1;if(A=="twitter"){getTwitterSearchList(-1,1);return}A!="discussions"&&A!="questions"&&A!="ideas"&&A!="problems"&&A!="announcement"&&A!="sticky"&&A!="unrepliedposts"&&A!="postssincelastvisit"?(A="all",parseInt(m[2])>0&&(r=m[2])):m[3]?(B=m[2],parseInt(m[3])>0&&(r=m[3])):parseInt(m[2])>0?r=m[2]:B=m[2],isOneTopicType=="true"&&A=="all"&&(B=m[1]),getMoreTopics("","",r,A,"",B,"reload");break;case"user":var C=m[1];discussionsFunctions[o](n,C);break;case"tag":var D=m[1];discussionsFunctions[o](n,D);break;case"newtopic":var p=m[1],q=m[2];discussionsFunctions[o](n,p,q);break;case"newdiscussion":var p=m[1],q=m[2];discussionsFunctions.newtopic(n,p,q);break;case"tpw":var p=m[1],q=m[2],E=m[3],F=m[4],G=m[5],H=m[6],I=m[7],J=m[8],K=m[9],L=m[10],M=m[11];discussionsFunctions.tphome(n,p,q,E,F,G,H,I,J,K,L,M);break;default:hideLoadingImage()}return!1}function loadTagRelatedPost(a){var b={};b.forumGroupId=forumGroupId,b.tagName=a,b.fetchPage=1,doAjaxAction("/getTagRelatedPosts.do",b,function(a){return hideLoadingImage(),$("#mainContent").html(a),goToTop(),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").html(b)})}function allForumsBindActions(){lightBox("#chartWidget"),bindAllForumsClick($("#allForums_MainContentCont")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop();var a=$("#listof_FC_Counts");$("#countOfForum").html(a.attr("forumCount")),$("#countOfCategory").html(a.attr("categoryCount")),$("#countOfPosts").html(a.attr("postCount")),$("#countOfResponses").html(a.attr("responseCount"));if(typeof WmsContacts!="undefined"&&ch=="true"){var b=WmsContacts.getZohoContacts();setPresenceInTopicList(b)}}function ModerationLoadingPage(a){var b="";portalPlanIndex>4?b="/getModerationPanel.do":b="/getReportedSpam.do",doAjaxAction(b,a,function(a){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=a,$.history.add("Moderation"),getModerationPanelBindAction(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function getModerationPanelBindAction(){goToTop(),bindModerationTabClick(),portalPlanIndex>4?bindModerationActionClick("AllAwaiting"):bindModerationActionClick("AllReportedSpam"),ModerationAction($("#moderationRightCont")),initModerationPanel($("#moderationPanel"))}function getMyAreaBindActions(a,b,c,d){bindMyAreaClicks($("#myAreaContent")),$("#authorPopout_"+ZUID).hide(),showAuthorPopout($("#myAreaInnerMainContent"));if(a!="dashboard"){a=="myposts"&&(a="myjournals"),d!=undefined&&d!="topic"&&d!="user"&&d!="forum"&&d!="subforum"&&d!="following"&&d!="follower"&&(d="topic");if(c!="niceurl")$("#"+a+"View").length>0?getMyAreaAction($("#"+a+"View"),d):getMyAreaAction($("#dashboardView"));else{var e=$("#"+a+"View").attr("purpose");bindMyareaTabsActions(e,d)}}else{c!="niceurl"&&$.history.add(b+"/"+a);if(typeof WmsContacts!="undefined"&&ch=="true"){var f=WmsContacts.getZohoContacts();setPresence(f,"followingUserDetails"),setPresence(f,"followersUserDetails"),setPresenceInMyArea(f,"current_recentActivity_List")}(a=="dashboard"||a=="undefined")&&initialiseUserActivityChart()}}function ModerationAction(a){a.unbind("click",bindModerationAction).click(bindModerationAction),showAuthorPopout(a)}function getTopicsReport(a,b,c,d){document.title=forumGroupNameDecode(forumGroupName);var e={};e.forumGroupId=forumGroupId,e.forumId=a,e.categoryId=b,e.fetchPage=c,e[csrfParamName]=csrfToken,doAjaxAction("/Reports.do",e,function(a){hideLoadingImage(),d&&$.history.add(d),$("#mainContent").get(0).innerHTML=a,lightBox("#chartWidget"),bindReportsClicks($("#reportsLeftPanel"))})}function getForumTopics(a,b,c,d,e,f,g,h,i,j,k,l,m){document.title=forumGroupNameDecode(forumGroupName);var n=$("#topicListMainContainer");if(n.length>0&&n.is('[shouldReload="false"]')&&c<2)$.history.add(d),setTimeout(function(){n.show().attr("shouldReload","true").siblings().remove()},200),hideLoadingImage(),setToHotkeys();else{var o={};o.forumGroupId=forumGroupId,o.forumId=a,o.categoryId=b,o.fetchPage=c,o.givenkey=d,d=="tpw"&&(o.limit=e,o.style=f,o.ph=g,o.tps=h,o.widget=i,o.aj=j,o.stat=k,o.querystring=l,o.tgt=m),doAjaxAction("/getSingleForumTopics.do",o,function(e){hideLoadingImage(),isHistoryNotAllowedService(d,c),$("#mainContent").get(0).innerHTML=e;var f=$("#iamLoginBox").find("iframe"),g=f.attr("src");f.attr("src",g),lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var h="NewTopic/"+a+"/"+b;$("#NewTopicTab").attr("hashPurpose",h),$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide();if(typeof WmsContacts!="undefined"&&ch=="true"){var i=WmsContacts.getZohoContacts();setPresenceInTopicList(i)}return setToHotkeys(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}}function getWritePostCallBack(a,b){var c=a,d={};b!="true"&&$.history.add(a),$("#tabListCont li.selected").removeClass("selected"),goToTop();var e=$("#SelectForum > option");e.length==1&&e.attr("selected",!0);var f=$("#SelectCategory > option");f.length==1&&f.attr("selected",!0),initWritePost(),a=a.toLowerCase();if(a!="newtopic"){a=="newproblem"?a="error":a=="newquestion"?a="question":a=="newidea"?a="idea":a=="newdiscussion"&&(a="discuss");var g=$("#writepostTabsCont").find('li[topiciconclass="'+a+'"]');g.length>0?selectTopicType(g):selectTopicType(g,a)}hideLoadingImage();var h="";$("#topicTitle").keydown(function(a){var b=$("#listOfTitleAutoSugg"),c=$(this).val();c=c.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ");if(c==""||a.keyCode==27){b.hide();return}storedTitle=d[c];if(storedTitle!=undefined){if(storedTitle==""){b.hide();return}b.html(storedTitle).show();return}if(a.keyCode!=32)return;if(h!=""&&c.indexOf(h)==0)return;h="";var e={};e.searchFor=c,e.forumGroupId=forumGroupId,e[csrfParamName]=csrfToken,doAjaxAction("/getTopicTitleSearch.do",e,function(a){b.get(0).innerHTML=a;var e=$("<div></div>");e.get(0).innerHTML=a;if(e.find("li").length<1){d[c]="",h=c,b.hide();return}var f=$("#topicTitle").width();b.width(f-5),b.show(),d[c]=b.html()},function(a){})});var i=$("#writepostCont");i.unbind("click",manageTopicTitle).click(manageTopicTitle)}function manageTopicTitle(a){var b=$(a.target),c=b.parent();if($("#listOfTitleAutoSugg").is(":visible")){if(b.parents("li").attr("eachTopic")=="autosugg"){if(!b.is("a")){var d=b.parents("li").find("a").attr("href");isEmbedAllowedService()&&window.open(d)}return}if(!b.is("#moreSearchTopicList")){$("#listOfTitleAutoSugg").hide();return}$("#listOfTitleAutoSugg").find("ul li").show(),b.hide()}return}function getWritePost(a,b,c,d){var e={};e.forumGroupId=forumGroupId,e.forumId=a,e.categoryId=b,isTopicQuickView!="false"&&showLoadingImage(),doAjaxAction("/writePost.do",e,function(a){return document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupNameDecode(forumGroupName),$("#mainContent").get(0).innerHTML=a,getWritePostCallBack(c,d),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function selectTab(a){if(a=="user"){$("#newtopicCont").siblings("li.selected").removeClass("selected");return}if(a=="newtopic"||a=="search"){searchFor=$("#searchInputBox").val(),searchFor=$.trim(searchFor);if(a=="search"&&searchFor=="")return;$("#"+a+"Tab").siblings("li.selected").removeClass("selected");return}if(a=="forum"||a=="topic"||a=="chome")a="home";$("#"+a+"Tab").addClass("selected").siblings("li.selected").removeClass("selected")}function bindTopicListHeaderClicks(a){a.unbind("click",processTopicListHeaderClick).click(processTopicListHeaderClick)}function bindTopicListHeaderForumsMenu(a){a.unbind("click",processTopicListHeaderForums).click(processTopicListHeaderForums)}function bindTopicClicks($context){$context.unbind("click",processTopicListClick).click(processTopicListClick);var $content=$context.find("script").html();try{eval($content)}catch(e){}}function showAuthorPopout(a){var b=a.attr("authorPopout");if(IS_EMBEDDED)return!1;if(!(typeof isTopicQuickView!="undefined"&&isTopicQuickView!="false"||typeof b!="undefined"&&b=="true"))return!1;a.find('a[purpose="authorProfile"],img[purpose="authorProfile"]').hover(function(){var a=$(this);if(!(typeof isTopicQuickView!="undefined"&&isTopicQuickView!="false"||!a.is('img[purpose="authorProfile"]')||b!="true"||a.attr("authorPopout")=="true"))return;var c=a.attr("authorId");if(c==-1)return;var d=a.attr("authorName"),e=a.attr("forumId"),f=setTimeout(function(){var b=a.position(),f=$("#mainContent").position(),g=f.left;b.left=b.left+parseInt(g);if($("#SinglePostContainer").length>0){var h=f.top;b.top=b.top+parseInt(h)+20}b.left>800&&(b.left=b.left-300),$authorPopup=$("#authorPopout_"+c);if($authorPopup.length>0)$authorPopup.css(b).show(),authorPopupHover($authorPopup);else{$authorPopup=$("#authorPopoutTemplate").clone(),$authorPopup.attr("popoutPurpose","authorDetailsPopout"),$authorPopup.attr("id","authorPopout_"+c);var i={};i.forumGroupId=forumGroupId,i.authorId=c,i.forumId=e,i.ch=ch,i[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",i,function(a){$thisAuthPopup=$("<div>"+a+"</div>"),authorPopUpAction($thisAuthPopup,c,d,$authorPopup)}),$authorPopup.css(b).show(),$authorPopup.appendTo("body"),authorPopupHover($authorPopup)}},700);a.data("destroyHandleAuthPopout",f)},function(){var a=$(this),b=a.attr("authorId"),c=a.data("destroyHandleAuthPopout");c&&clearTimeout(c);var d=$("#authorPopout_"+b);d.attr("hideAuhPopout","true"),setTimeout(function(){var a=d.attr("hideAuhPopout");a=="true"&&d.hide()},500)})}function mouseOutAuthor(a){var b=a,c=b.attr("authorId"),d=b.data("destroyHandleAuthPopout");d&&clearTimeout(d);var e=$("#authorPopout_"+c);e.attr("hideAuhPopout","true"),setTimeout(function(){var a=e.attr("hideAuhPopout");a=="true"&&e.hide()},500)}function mouseOverAuthor(a){if(isTopicQuickView=="false"||isZIntranet)return!1;var b=a,c,d=b.attr("authorId");if(d==-1)return;var e=b.attr("authorName"),f=b.parents('li[parentCont="actualParent"]').attr("forumId");typeof f=="undefined"&&(f=b.attr("forumId"));var g=setTimeout(function(){var a=b.position();c=$("#authorPopout_"+d);if(c.length>0)c.css(a).show(),authorPopupHover(c);else{c=$("#authorPopoutTemplate").clone(),c.attr("popoutPurpose","authorDetailsPopout"),c.attr("id","authorPopout_"+d);var g={};g.forumGroupId=forumGroupId,g.authorId=d,g.forumId=f,g.ch=ch,g[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",g,function(a){$thisAuthPopup=$("<div>"+a+"</div>"),authorPopUpAction($thisAuthPopup,d,e,c)}),c.css(a).show(),c.appendTo("body"),authorPopupHover(c)}},700);b.data("destroyHandleAuthPopout",g)}function authorPopUpAction(a,b,c,d){a.find('li[purpose="watchUser"]').click(function(){$thisWatchCont=$(this);var a={};a.forumGroupId=forumGroupId,a.watchItemId=b,a.watchItemType=3,a[csrfParamName]=csrfToken;var d=$thisWatchCont.attr("watchAction"),e=d=="watch"?"/watchUser.do":"/unwatchUser.do";doAjaxAction(e,a,function(a){if(a=="SUCCESS"){$thisWatchCont.attr("watchAction",d=="watch"?"unwatch":"watch");var b=(d=="watch"?i18n["zohodiscussions.general.Unwatch"]:i18n["zohodiscussions.general.watch"])+" "+c;$thisWatchCont.find('a[purpose="watchuserNameCont"]').html(b),d=="watch"?showTipper(i18n["zohodiscussions.generalmessage.userAddedToWatchlist"],"success"):showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"])}})}),a.find('li[purpose="addAsFriend"]').click(function(){$addFriendCont=$(this);var a=$addFriendCont.attr("successMsg"),c={};c.forumGroupId=forumGroupId,c.userId=b,c[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",c,function(b){hideLoadingImage(),b=="SUCCESS"&&($addFriendCont.attr("purpose","friendWaitingApproval"),$addFriendCont.find('a[linkpurpose="addAsFriend"]').attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]),$addFriendCont.find("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(a,"success"))})}),a.find('li[purpose="authorProfile"]').click(function(){c==screenName||c==encodedScreenName?processHash("MyArea"):processHash("User/"+c)}),d.html("").append(a);if(typeof WmsContacts!="undefined"&&ch=="true"){var e=WmsContacts.status(b);e===!1&&(e=9),manageUserChatStatus("authorPopup_"+b,e)}}function authorPopupHover(a){a.hover(function(){a.attr("hideAuhPopout","false");var b=a.data("destroyHandle");b&&clearTimeout(b)},function(){var b=setTimeout(function(){a.hide(),a.unbind("mouseenter").unbind("mouseleave")},700);a.data("destroyHandle",b)})}function displaySearchOption(){var a=$("#listOfSearchOptions");a.show(),a.find("li").unbind("click").click(function(){var b=$(this),c=b.find("div"),d=c.attr("class"),e=c.attr("purpose");if(!c.is(".imgAdvanceSearch"))c.is(".imgSearchBlack")&&(d="imgSearchWhite flLeft"),$("#searchSelectedImage").attr("class",d).attr("purpose",e),$("#searchInputBox").focus();else{if($("#advanceSearchContainerForm").is(":visible")){$("#listOfSearchOptions").hide();return}if($("#searchMainContainer").is(":visible")){$("#normalSearchInSearchList").hide(),$("#advanceSearchContainerForm").show(),$("#advanceSearchInpurBox").focus();return}showLoadingImage();var f={};f.forumGroupId=forumGroupId,doAjaxAction("/AdvanceSearchContainer.do",f,function(a){hideLoadingImage();var b=$("#mainContent > div:first"),c=$("<div></div>");c.get(0).innerHTML=a,c.insertBefore(b),c.find("#advanceSearchContainerForm").show(),c.find("#advanceSearchInpurBox").focus(),$("#normalSearchInSearchList").is(":visible")&&$("#normalSearchContainer").hide(),bindSearchContentClick(c)},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}a.hide()});var b=a.parent("div");b.hover(function(){var a=b.data("destroyHandle");a&&clearTimeout(a)},function(){var c=setTimeout(function(){a.hide(),b.unbind("mouseenter").unbind("mouseleave")},500);b.data("destroyHandle",c)})}function bindSearchContentClick(a){a.unbind("click",processSearchContClick).click(processSearchContClick),$("#SearchforumCategoryVice").change(function(){searchForumCatSelect($(this))})}function searchForumCatSelect(a){var b=a.val(),c=$("#searchCategoryList").val().split("$$");$.each(c,function(a,c){if(c.indexOf(b+":")>-1)return $("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>"+c.split(":")[1]).show(),$("#SelectCategory option:first").attr("selected","true"),!1;b==-1?$("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>").show():$("#SearchCategoryVice").html('<option selected value="-1">Uncategorised</option>').show()}),$("#SearchCategoryVice option:first").attr("selected","true")}function bindWidgetsContClick(a){a.unbind("click",processWidgetsContClick).click(processWidgetsContClick),showAuthorPopout(a),bindSubscribeAction();var b=$('#followAnnouncement a[purpose="watchAnnouncement"]');b.click(function(a){watchThisItem(b,"announcement",a)})}function bindAllForumsClick(a){a.unbind("click",processAllForumsClick).click(processAllForumsClick),showAuthorPopout(a)}function processTopicListHeaderForums(a){var b=$(a.target),c=b.parent();if(b.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return b.is("#forumsFilter span,#categoriesFilter span")&&(b=c),hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1}function processTopicListHeaderClick(a){var b=$(a.target),c=b.parent();if(b.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return b.is("#forumsFilter span,#categoriesFilter span")&&(b=c),hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;if(b.is('div[purpose="linkForDropDown"]')){var d=b,e=d.attr("dropDownContLocation"),f=$(d.attr("parentCont"));f.is(".newCombo")?f.addClass("newComboSelected").removeClass("newCombo"):f.addClass("newCombo").removeClass("newComboSelected");var g=$("#"+e);g.toggle()}if(b.is('#topicListFilter li[purpose="filterLink"]')){var h=b.attr("topicFilter");$topicFilterParent=$("#topicListFilter");var i=$topicFilterParent.attr("forumURL"),j=$topicFilterParent.attr("subForumURL"),k="";return $topicFilterParent.attr("isTypeURL")=="yes"?(getMoreTopics(i,j,fetchPage,h,"",k),$("#currentFilterContext").html(b.text())):manageFilterHash(i,j,h,k),!1}b.is("#showAllTags")&&b.attr("isNiceURL")!="Yes"?processHash("AllTags"):b.attr("purpose")=="filterTab"||b.is("#innerTabFilter span")&&c.parent().attr("purpose")=="filterTab"?(b.attr("purpose")!="filterTab"&&(b=c),manageFilterTabList(b)):b.is('#innerTabFilter li[purpose="filterTabMenu"]')||c.attr("purpose")=="filterTabMenu"?(c.attr("purpose")=="filterTabMenu"&&(b=c),manageFilterMenuList(b.attr("filterParent"),b)):c.attr("id")=="searchTwitterTab"&&manageFilterTabList(c);var l=$("#typeFilterOptions")}function getTwitterSearchList(forumId,fetchPage,forumUrl,sinceId){if(isTwitterPortal!="true")return;var $tweetContainer=$("#tweetContainer"),currStatusId=$tweetContainer.attr("status_Id"),options={};options.forumGroupId=forumGroupId,typeof forumId!="undefined"&&(options.forumId=forumId),typeof forumUrl!="undefined"&&(options.forumURL=forumUrl),options[csrfParamName]=csrfToken,options.fetchPage=fetchPage;var nextPage=parseInt(fetchPage)+1;typeof sinceId!="undefined"?options.sinceId=sinceId:fetchPage>1?options.maxId=currStatusId:showLoadingImage();var action="/getMoreTwitterSearchList.do";isCommentBoxDomain=="true"&&(forumId==-1||typeof forumId=="undefined")&&(fetchPage==1||typeof fetchPage=="undefined")&&(sinceId==-1||typeof sinceId=="undefined")&&(action="/getTwitterSearchList.do"),$("#currentFilterContext").is(":visible")&&(action="/getTwitterSearchList.do"),action!="/getMoreTwitterSearchList.do"&&selectTab("twitterMain"),doAjaxAction(action,options,function(a){var b=$("#topicList");if(fetchPage>1){$("#searchMoreTweetsLoading").remove();var c=$('<div class="tFootCount" id="searchMoreTweets" forumId="'+forumId+'" fetchPage="'+nextPage+'" loadCompleted="false">Older Tweets</div>');$("#searchMoreTweetsParents").html(c);var d=$("<div></div>");d.html(a);var e=d.find("#tweetContainer li");e.each(function(){$(this).hide(),$tweetContainer.append($(this))}),d.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}else{if(typeof sinceId!="undefined"){var f=$tweetContainer.find('li[isrecenttweets = "true"]').length;f>1&&(f=parseInt(f)-1);var d=$("<div></div>");d.html(a);var g=d.find("li");g.hide();var h=g.length;if(h>0){var i=d.find("#tweetContainer").attr("status_Id");$tweetContainer.attr("status_Id",i),$("#searchRecentTweet").remove(),g.insertBefore($tweetContainer.find("li:first")),h=parseInt(h)+f;var j=$('<li isrecenttweets="true" id="searchRecentTweet"><div id="searchRecentTweetsLink" class="tCount">You have '+h+" new tweets</div></li>");j.insertBefore($tweetContainer.find("li:first")),$("#searchRecentTweetsLink").unbind("click").click(function(){$tweetContainer.find('li[isrecenttweets = "true"]').attr("isrecenttweets","false").show(),$(this).parents("li").remove()})}manageRecentTweets()}else{var k=$("#topicListMainContainer");k.length>0&&k.is('[shouldReload="false"]')&&k.show().attr("shouldReload","true"),action=="/getTwitterSearchList.do"?($("#mainContent").get(0).innerHTML=a,bindTopicListHeaderForumsMenu($("#mainContent")),b=$("#mainContent")):$("#topicList").get(0).innerHTML=a,hideLoadingImage();if(forumId==-1){var l=-1;$("#forum_Twitter_Default").length>0?l=$("#forum_Twitter_Default").attr("forumId"):l=$("#forum_Twitter_SelectForum").val(),loadTweetCategories(l,"twitter_SubForumList","forum_Twitter_SelectSubForum")}}b.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}if(fetchPage==1&&typeof sinceId=="undefined"){manageRecentTweets();var m="filter/twitter";typeof forumUrl!="undefined"&&(m="forum/"+forumUrl+"/"+m),$.history.add(m),getTwitterSearchList(forumId,2)}},function(err){var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function initTwitterPageActions(a){var b=$("#topicList");b.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));if(typeof a=="undefined"||a=="null")a=-1;getTwitterSearchList(a,2),manageRecentTweets()}function manageRecentTweets(){var a=$("#tweetContainer");a.is(":visible")&&setTimeout(function(){if(a.is(":visible")){var b=a.attr("forumId"),c=a.attr("forumUrl"),d=a.attr("status_Id");getTwitterSearchList(b,1,c,d)}},6e4)}function bindTwittReplyContent(a){var b=$(a.target),c=b.parent();c.is(".ndTwitterBtnCont")&&c.attr("purpose")=="replyTweet"?addNewTweetPost(b):b.is("#searchMoreTweets")&&manageMoreTweets(b)}function manageMoreTweets(a){var b=a.attr("forumId"),c=a.attr("fetchPage");a.parents("li").remove();var d=$("#tweetContainer");d.find('li[isrecenttweets = "false"]').show(),c=parseInt(c)+1,getTwitterSearchList(b,c)}function addNewTweetPost(a){var b=$("#tweetContainer");if(b.data("inEditMode")==1){var c=b.data("currStatusId");$("#tweetReply_"+c).focus(),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");return}var d=a.attr("statusId"),e=$("#eachTwittId_"+d),f=$("#twitterCont_"+d),g=$("#twitterImg_"+d),h={};h.forumGroupId=forumGroupId,h.statusId=d,h.tweetBy=e.attr("tweetBy"),h.tweetDate=e.attr("tweetDate"),h.tweetAuthImg=g.attr("src"),h.tweetCont=f.html(),h[csrfParamName]=csrfToken,newOpenEditor($("#tweetReplyContainer_"+d),"responseContent","postContentTA","tweetReply_"+d,"TweetPost","tweetContainer"),b.data("inEditMode",!0),b.data("currStatusId",d)}function loadTweetCategories(a,b,c){var d=$("#"+b).val().split("$$"),e=$("#"+c);e.hide(),e.html(""),$.each(d,function(b,c){if(c.indexOf(a+":")>-1)return e.html(c.split(":")[1]).show(),!1;a!=-1?e.html('<option selected value="-1">Uncategorised</option>').show():e.html('<option selected value="-1">choose Subforum</option>').show()})}function manageFilterTabList(a){var b=$("#innerTabFilter");b.find("li.selectedTab").removeClass("selectedTab"),a.attr("purpose")=="filterTab"?a.addClass("selectedTab"):a.parents("li").addClass("selectedTab");var c=b.attr("forumURL"),d=b.attr("subForumURL"),e=1,f=a.attr("filterBy")||a.find("a").attr("filterBy"),g="",h=b.attr("topicFilterType"),i=b.attr("postSinceLastVisitTime");h!="All"&&(g=a.attr("filterLabelId")||a.find("a").attr("filterLabelId"),g&&(g=f,f=h)),b.attr("isTypeURL")=="yes"?getMoreTopics(c,d,e,f,i,g):manageFilterHash(c,d,f,g)}function manageFilterHash(a,b,c,d){var e="forum/";if(isTopicQuickView=="false"||a=="")e="";a!=""&&typeof a!="undefined"&&(e=e+a+"/"),b!=""&&typeof b!="undefined"&&(e=e+b+"/"),d!=""&&(d="/"+d);var f="filter/"+c+d+"/1";typeof c!="undefined"&&c.toLowerCase()=="all"&&(""!=a?f="1":isTopicQuickView=="false"?f="recent":f=""),processHash(e+f)}function manageFilterMenuList(a,b){var c=$("#"+a);$("#innerTabFilter div.forumOptions").is(":visible")&&$(this).hide();if(b.attr("purpose")=="filterTabMenu"){var d=$("#innerTabFilter"),e=d.attr("forumURL"),f=d.attr("subForumURL"),g=b.attr("labelName"),h=b.parent().attr("filterType"),i=1;d.find("li.selectedTab").removeClass("selectedTab"),$("#"+h+"FilterMenuList").addClass("selectedTab");var j=b.attr("filterBy");j&&(h=j),d.attr("isTypeURL")=="yes"?getMoreTopics(e,f,i,h,"",g):manageFilterHash(e,f,h,g)}}function bindTagsContClick(a){a.find('li[purpose ="getTagPosts"]').click(function(){$this=$(this);var a=$this.attr("hashPurpose");processHash(a)})}function processTopicListClick(a){var b=$(a.target),c=b.parent(),d=$("#topicList"),e="topicList",f=b.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(b.is('span[defaultTopicView="true"]')||b.is('a[purpose="postTitleQuickView"]')){f=f||c.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(b.is("span.nddownArrow")){var g=d.data("currentUpArrow");typeof g!="undefined"&&g.removeClass("ndupArrow").addClass("nddownArrow"),b.removeClass("nddownArrow").addClass("ndupArrow"),d.data("currentUpArrow",b)}else b.is("span.ndupArrow")&&b.removeClass("ndupArrow").addClass("nddownArrow");return handleTopicClick(a,f,e),!1}if(b.is('a[purpose="postTitle"]')||b.is("a.orangeLink")||b.is('span[defaultTopicView="false"]')){showLoadingImage();if(isTopicQuickView!="false"){var h=b.parents('li[parentCont="actualParent"]').attr("recentResponseId"),i=b.attr("isResponse");return h!=undefined&&i=="true"?processHash("Topic/"+f+"/"+h):processHash("Topic/"+f),!1}if(isEmbedService())return!1}else if(c.is('li[purpose="moreAction"]'))manageMoreAction(c);else if(b.is('a[purpose="moreAction"]')){var j=b.parents("li");manageMoreAction(j)}else if(b.is('a[purpose="linkedTopicTitle"]')){showLoadingImage();if(isTopicQuickView!="false"){var k=b.attr("linkToTopicId");return processHash("Topic/"+k),!1}}else{if(b.is('li[linkPurpose="replyToTopic"]')||c.is('li[linkPurpose="replyToTopic"]')){f=f||c.parents('li[parentCont="actualParent"]').attr("forumTopicId");if(d.data("inEditMode")==1){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var l=d.data("editorContLocation"),m=d.data("eachTopicContainerId"),n=d.data("forumTopicId");return n!=f&&handleTopicClick(a,n,"editTopicList"),setFocusToContainer($(l)),!1}return $("#eachTopicReplyCont_"+f).show(),newOpenEditor($("#eachTopicReply_"+f),"responseContent","postContentTA","replyToTopic_"+f,"Write","paginationContainer"),setFocusToContainer($("#eachTopicReplyCont_"+f)),d.data("inEditMode",!0),d.data("editorContLocation","#eachTopicReplyCont_"+f),d.data("eachTopicContainerId","#eachTopic_"+f),d.data("forumTopicId",f),!1}if((b.is("#olderPostsLink")||b.is("#newerPostsLink"))&&b.is(".navBtnEnabled")){var o=b.attr("forumURL"),p=b.attr("categoryURL"),q=b.attr("fetchPage"),r=b.attr("topicFilter"),s=b.attr("getPostFor"),t=b.attr("topicStatus"),u=b.attr("postSinceLastVisitTime");if(typeof s=="undefined")getMoreTopics(o,p,q,r,u,t,"true");else{var v=b.attr("tag_Name");getMoreTagRelatedPost(q,v,s)}}else{if(b.is('a[purpose="forumPostsFilter"]'))return hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;if(b.is('a[purpose="authorProfile"]')||b.is('img[purpose="authorProfile"]')){var w=b.attr("authorName");w==screenName||w==encodedScreenName?processHash("MyArea"):processHash("User/"+w);return}if(b.is("div.imgSmallWatchSel")||b.is("div.imgSmallWatch")){watchThisItem(b,"singleTopicWatch",a);return}if((b.is("li.ndtopicNavPrev")||b.is("li.ndtopicNavNext"))&&!c.is(".navLoading")){checkPrevNextResponse(b);return}if((b.is("li.ndtopicNavFirst")||b.is("li.ndtopicNavLast"))&&!c.is(".navLoading")){firstOrLastResponse(b);return}if(c.is('li[purpose="watchAction"]')){e=c.is('li[purpose="watchAction"]')?e:"",watchThisItem(c,e,a);return}if(b.is('input[purpose="watchAction"]')){var f=b.attr("forumTopicId"),x=$("#eachTopicReplyCont_"+f).find('input[name="isFollowTopic"]');b.attr("checked")==1?x.attr("value","true"):x.attr("value","false");return}if(c.is('li[purpose="emailThisTopic"]')){openEmailTopicDialog(c);var j=c.parents('li[purpose="moreAction"]');manageMoreAction(j);return}if(c.is('li[purpose="moderateThisTopic"]')){moderateAction(c,e,a);return}if(c.is('li[actionPurpose="delete"]')){singlePostDeleteAction(c,e);return}if(c.is("#removeTopicLink")||c.is('li[purpose="removeTopicLink"]'))deletelinkedTopic(c);else{if(c.is('li[actionPurpose="edit"]')){var y=c.attr("responseId"),z=c.parents('li[parentCont="actualParent"]').attr("forumTopicId"),A="#eachTopic_"+z;if(d.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),l=d.data("editorContLocation");var n=d.data("forumTopicId");return z!=n&&handleTopicClick(a,n,e),setFocusToContainer($(l)),!1}return newOpenEditor($("#recentResponseContent_"+y),"responseContent","postContentTA","editPostContent_"+y,"Edit","eachTopic_"+y),setFocusToContainer($(A)),d.data("inEditMode",!0),d.data("editorContLocation",A),d.data("forumTopicId",z),$("#postTextContent_"+y).find("ul.singlePostActions").hide(),$("#linkedTopic_"+y).hide(),$("#singlePostActions_"+y).hide(),$("#recent_ResPonse_"+y).find("div.listOfResponseLink").hide(),$("#previewResponse").attr("location","topicListEditResponse"),$("#previewResponse").attr("responseId",y),$("#previewResponse").attr("forumTopicId",z),!1}if(b.is('li[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(b,a);return}if(c.is('span[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(c.is("li[bestResponse]")){var B=c,y=B.attr("responseId"),f=B.parents('li[parentCont="actualParent"]').attr("forumTopicId"),C=B.attr("topicAuthorId"),D=B.attr("bestResponse"),E={};E.forumGroupId=forumGroupId,D=="choose"&&(E.responseId=y),E.forumTopicId=f,C==ZUID&&(E.topicowner="true"),E[csrfParamName]=csrfToken;var F=D=="choose"?"/bestResponse.do":"/removeBestResponse.do";showSmallLoadingImage(a),doAjaxAction(F,E,function(a){if(a=="SUCCESS"){var b=D=="choose"?i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"]:i18n["zohodiscussions.singlePost.removeBestResponseMsg"],c=D=="choose"?"success":"info";showTipper(b,c),refreshSingleTopic(f)}else hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])})}else if(b.is("input[followItem]")){var G=b.attr("followItem"),H=b.attr("responseId");G=="true"&&watchItem(b),$("#followTopicList_"+H).hide()}}}}}function manageMoreAction(a){if(a.is(".newComboSelectedNm")){a.removeClass("newComboSelectedNm").addClass("newCombo"),a.find("div.forumOptins").hide();return}a.removeClass("newCombo").addClass("newComboSelectedNm");var b=a.find("div.forumOptins");b.show(),a.hover(function(){a.attr("hideAuhPopout","false");var b=a.data("destroyHandle");b&&clearTimeout(b)},function(){var c=setTimeout(function(){a.removeClass("newComboSelectedNm").addClass("newCombo"),b.hide(),a.unbind("mouseenter").unbind("mouseleave")},500);a.data("destroyHandle",c)})}function refreshResponseVoteContainer(a){var b={};b.forumGroupId=forumGroupId,b.responseId=a,doAjaxAction("/refreshSingleResponse.do",b,function(b){var c=$(b).find('div[contPurpose="voteContainer"]');$("#postTextContent_"+a+' div[contPurpose="voteContainer"]').html(c.html()),hideLoadingImage()})}function backtoEditor(){$("#addForumPostForm").show(),$("#writeNewTopic").show(),$("#publishPreviewedTopic").hide(),$("#backToEditor").hide(),$("#preview_Posts").hide(),$("#writePostButtons").show(),$("#writepostCont").show(),$("#forumTagsPreview").html(" ")}function publishPreviewedTopic(){$("#publishTopic").trigger("click")}function writePostPreview(a,b,c,d){var e=$("#topicTitle").val(),f=e.replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;");f=f.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ");if(f==""){hideLoadingImage(),setFocusToContainer($("#topicTitle").focus()),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure");return}if(f.length>200){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),enablePostButtons();return}var g=editor.getContent();g=g.replace(/^\s+/g,"").replace(/\s+$/g,"");var h=$("<div></div>").html(g);g=h.text();if(g==""){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure"),enablePostButtons();return}var i=$("#SelectForum").val(),j=$("#SelectCategory").val();if(i==null){hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectForum")),enablePostButtons(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure");return}if(j=="0"){hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectCategory")),enablePostButtons(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure");return}$("#selectForumMessage").hide();var k=$("#forumTags").val();if(k!=""){k=k.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");if(k.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}}if(d){$("#previewAttachment >li").html("");var l=$("#attachmentsListCont").find("div[attachmentDetails]"),m=$("#attachmentsListCont").find("div[attachmentDetails]").length;if(m>0){var n=$("#previewAttachment");attachmentListPreview(n,l),$("#AttachmentPreviewCont").show()}else $("#AttachmentPreviewCont").hide()}$("#addForumPostForm").hide(),$("#writeNewTopic").hide(),$("#publishPreviewedTopic").show(),$("#backToEditor").show(),$("#writepostCont").show();var o=$("#preview_Posts").show();$("#writePostButtons").hide();var p=$("#TopicContentHolder").attr("imgAttrClass"),q=$("#previewTopicTypeImg").attr("class"),r=q.split(" ");$("#previewTopicTypeImg").removeClass(r[1]).addClass(p);if(o.is(":visible")){var s=$("#preview_breadCrumb,#preview_postHeader");s.find('a[purpose="authorProfile"]').html(a),$("#previewDocumentTitle").html(f),s.find('a[purpose="forum_Topic"]').html($("#SelectForum option:selected").text());var t=$("#SelectCategory option:selected").text(),u=$("#SelectCategory option:selected").val();u>0?(s.find('span[purpose="cateArrow"]').show(),s.find('a[purpose="category_Topic"]').html(t)):(s.find('span[purpose="cateArrow"]').hide(),s.find('a[purpose="category_Topic"]').html("")),k=k.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),k==""&&$("#forumTagsPreview").html(i18n["zohodiscussions.singlepost.noTagsMsg"]);var v=k.split(",");for(var w=0;w<v.length;w++)jQuery.trim(v[w])!=""&&$("#forumTagsPreview").append("<li><a>"+v[w]+"</a></li>");var g=editor.getContent();g=g.replace(/^\s+/g,"").replace(/\s+$/g,"");if(g==""){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}o.find("#responsePreviewContentContainer").html(g)}}function forHidingSmallLoadingImg(){var a="",b="";$("#newPostRightCont").length>0?a=$("#newPostRightCont"):$("#attachBrowseCont").length>0&&(a=$("#attachBrowseCont")),a.find("[purpose='attachLoadingCont']").hide()}function processSearchContClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible"))return;if(c.is('div[purpose="advanceSearch"]'))$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide();else if(b.is('button[purpose="advanceSearchCancel"]')||b.is('div[purpose="advanceSearchCancel"]'))$("#advancedSearchForm").is(":visible")?$("#advancedSearchForm").remove():($("#advanceSearchContainerForm").hide(),$("#normalSearchContainer").show(),$("#normalSearchInSearchList").show());else if(b.is('button[purpose="normalSearch"]')){var d=$("#normalSearchInputBox").val();processHash("normalsearch")}else if(b.is('button[purpose="getAdvanceSearch"]'))getDiscussionsAdvanceSearchResult();else{if(b.is('a[purpose="postTitle"]')){var e=b.attr("forumTopicId"),d=b.attr("searchFor");openSinglePost(e,"topic",d);return}if(c.is('a[purpose="postTitle"]')){var e=c.attr("forumTopicId"),d=c.attr("searchFor");openSinglePost(e,"topic",d);return}if(b.is('a[purpose="forumAction"]')||b.is('a[purpose="categoryAction"]')){var f=b.attr("hashPurpose");processHash(f)}else{if(b.is('a[purpose="authorProfile"]')||c.is('a[purpose="authorProfile"]')){var g=b.attr("authorName");g||(g=c.attr("authorName"));var h=b.attr("singleClickflag");h||(h=c.attr("singleClickflag")),h=="0"&&(g==screenName||g==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+g),b.attr("singleClickflag","1")));return}if(b.is("li.navBtnEnabled")&&b.is('[navType="searchNav"]')){var i=b.attr("purpose");searchNavigation(c,i);return}if(b.is('a[purpose="relativeLinkSearch"]'))searchNavigation(b,"relativeLinkSearch");else if(b.is('a[purpose="sortbyrelevance"]')&&!b.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","relevance");else if(b.is('a[purpose="sortbydate"]')&&!b.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","date");else if(b.is('a[purpose="breadCrumbForSearch"]'))searchNavigation(b,"breadCrumbForSearch");else if(b.is('a[purpose="expandForumList"]')){var j=b.attr("status");if(j=="off")b.attr("status","on").html("&laquo; less"),b.parents("ul").find("li").show();else{b.attr("status","off").html("more &raquo;");var k=0;b.parents("ul").children("li").each(function(){k>4&&$(this).hide(),k++})}}}}}function searchNavigation(a,b,c){showLoadingImage();var d=parseInt(a.attr("fetchPage")),e=a.attr("fieldType"),f=a.attr("categId"),g=a.attr("pathTraverse"),h=$("#breadCrumbForSearch"),i=a.attr("forumId"),j=a.attr("searchLevel");b=="next"?d+=1:b=="prev"?d-=1:d=1,i=="undefined"&&(i=-1);if(j=="forums"||j=="all"){f="",g="";var k=$("#SearchforumCategoryVice"),l=$("#SearchCategoryVice");l.find('option[value="-1"]').attr("selected","true"),j=="all"&&k.find('option[value="-1"]').attr("selected","true")}var m=c;m!="relevance"&&m!="date"&&(m=$("#currSearchSortBy").attr("currSortBy"));if($("#searchListContainer").is(":visible"))doAjaxAction("/getMoreSearchResult.do?fetchPage="+d+"&searchSortBy="+m+"&category_id="+f+"&category_pathTraverse="+g+"",$("#advanceSearchForm").serialize(),function(a){hideLoadingImage(),reloadeSearchContainer(a,b,e,i,f,g,m)});else{var n={};n.fetchPage=d,n.searchSortBy=m,b=="breadCrumbForSearch"?n.searchFor=h.attr("searchFor"):n.searchFor=a.attr("searchFor"),n.category_pathTraverse=g,n.category_id=f,n.forumGroupId=forumGroupId,n.forumId=i,n.normalSearchType=$("#searchSelectedImage").attr("purpose"),doAjaxAction("/getMoreSearchResult.do",n,function(a){hideLoadingImage(),reloadeSearchContainer(a,b,e,i,f,g,m)})}}function reloadeSearchContainer(a,b,c,d,e,f,g){var h=$("#breadCrumbForSearch"),i=$("<div></div>");i.get(0).innerHTML=a;var j=i.find("#searchListContainer").html();$("#searchListContainer").html(j);var k=i.find("#searchResultViewRange").html();$("#searchResultViewRange").html(k);var l=i.find("#searchFilterArea").html();$("#searchFilterArea").html(l);var m=i.find("#currSearchSortBy").html();$("#currSearchSortBy").html(m).attr("currSortBy",g);if(b=="relativeLinkSearch"){var n=$("<span> &raquo; <a class=underline href=javaScript:; purpose=breadCrumbForSearch fieldType="+c+" forumId="+d+" categId="+e+" pathTraverse="+f+">"+c+"</a></span>");n.insertAfter($("#breadCrumbForSearch").find("span:last"))}else if(b=="breadCrumbForSearch"){var o=0;h.children().each(function(){var a=$(this),b=a.find("a").attr("fieldType");o==1&&a.remove(),b==c&&(o=1)})}}function getDiscussionsAdvanceSearchResult(){showLoadingImage();var searchString=$("#advanceSearchInpurBox").val();searchString=$.trim(searchString);if(searchString==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),hideLoadingImage();return}var $searchForumCategoryVice=$("#SearchforumCategoryVice"),searchType="forumId",options={};doAjaxAction("/getAdvanceSearchResult.do",$("#advanceSearchForm").serialize(),function(a){hideLoadingImage();var b=$("<div></div>");b.get(0).innerHTML=a;var c=$("#searchContainer");if($("#searchListContainer").is(":visible")){var d=b.find("#searchResultFullContainer").html();$("#searchResultFullContainer").html(d)}else $("#mainContent").get(0).innerHTML=a,bindSearchContentClick($("#mainContent")),$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide()},function(err){hideLoadingImage();var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function processWidgetsContClick(a){var b=$(a.target),c=b.parent();if(b.is("a[hashPurpose]")&&b.is('a[currpurpose="usingHash"]')){var d=b.attr("hashPurpose");if(isTopicQuickView!="false"||d.indexOf("Topic/")!=0)return processHash(d),!1}else if(b.is("div.teeplus")){var e=b.attr("forumId"),f=$("#allForumControl").find('div[purpose="subForumView_'+e+'"]');f.removeClass("teeplus").addClass("teeminus"),$("ul.eachCategoryContainer_"+e).show()}else if(b.is("div.teeminus")){var e=b.attr("forumId"),f=$("#allForumControl").find('div[purpose="subForumView_'+e+'"]');f.removeClass("teeminus").addClass("teeplus"),$("ul.eachCategoryContainer_"+e).hide()}else{if(c.is("#forumPermalink")){var g=c.attr("thisForumPermalink");$("#PermalinkCont textarea").val(g),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("li.watchingForum"))watchThisItem(c,"singleForumActions",a);else if(c.is("li.watchingCategory"))watchThisItem(c,"singleCategoryActions",a);else{if(b.is('a[purpose="newWatchedUser"]')){processHash("myarea/dashboard");return}if(b.is('a[purpose="newPrivateMsg"]')){processHash("myarea/privateMsg");return}if(b.is('a[purpose="newRecentActivity"]')){var h=b.attr("currStatus");if(h=="dashboard"){processHash("myarea/"+h);return}processHash("myarea/watchList/"+h);return}if(b.is('a[purpose="authorProfile"]')){var i=b.attr("authorName"),j=b.attr("singleClickflag");j=="0"&&(i==screenName||i==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+i),b.attr("singleClickflag","1")));return}if(c.is("#loginToParticipate"))$("#signinwidgetBox").hide(),$("#iamLoginBox").show();else if(c.is("#chartMenu")){if(b.is("li")){b.siblings().removeClass("selected"),b.addClass("selected");var k=b.attr("assocImage"),l=$(k);if(k=="#weekTrendChart"){var m=l.find('img[chart="true"]');typeof m.attr("src")=="undefined"?(m.attr("src",m.attr("actualURL")),$("#weekTrendChartLoading").show().siblings("a").hide(),m.one("load",function(){l.show(),l.prev('div[purpose="chartLoading"]').hide()}).each(function(){this.complete&&$(this).trigger("load")})):l.show().siblings().hide()}else l.show().siblings().hide()}}else if(b.is("li[assocDiv]")){b.siblings().removeClass("selected"),b.addClass("selected");var n=b.attr("assocDiv");if(n=="#topPublishers_Month"){if($(n).find("li").length==0){var e=b.attr("forumId"),o=b.attr("categoryId"),p={};p.forumGroupId=forumGroupId,p.forumId=e,p.categoryId=o,doAjaxAction("/getLeaderboardTopics.do",p,function(a){$(n).get(0).innerHTML=a})}$(n).show(),$("#topContributors_Month").hide()}else $(n).show().siblings("ul").hide()}}}}function processAllForumsClick(a){var b=$(a.target),c=b.parent();if(b.is("a[hashPurpose]")){var d=b.attr("hashPurpose");if((isTopicQuickView!="false"||d.indexOf("Topic/")!=0)&&b.attr("isNiceUrl")!="Yes")return processHash(d),!1}else{if(c.is('li[purpose="eachForumPermalink"]')){var e=c.attr("thisForumPermalink");$("#PermalinkCont textarea").val(e),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("li.watchingForum"))watchThisItem(c,"singleForumActions",a);else if(c.attr("watchItemType")==1)watchThisItem(c,"singleCategoryActions",a);else if(c.is('div[purpose="moderator"]')){var f=c.attr("forumId");$forumCont=$("#forumId_"+f),$forumCont.is(".singleForumSub")&&$forumCont.removeClass("singleForumSub"),$forumCont.toggleClass("singleForumMod")}else if(c.is('div[purpose="subforums"]')){var g=c.attr("forumId");$forumCont=$("#forumId_"+g),$forumCont.is(".singleForumMod")&&$forumCont.removeClass("singleForumMod"),$forumCont.toggleClass("singleForumSub")}}}function handleTopicClick(a,b,c){var d=$("#eachTopic_"+b),e=$("#lastResponse_"+b),f=e.parents('li[parentCont="actualParent"]').attr("recentResponseId"),g=$("#topicList");g.data("currentSelectedPost",d);var h=g.data("currentFocusPost");h!=undefined&&h.removeClass("hotKeyTopicCont"),g.data("currentFocusPost",d),e.is(":visible")==1?d.removeClass("ndquickList").addClass(""):(d.siblings("li.ndquickList").removeClass("ndquickList").addClass(" "),d.addClass("ndquickList"),topicContent[b]&&($("#recentResponseContent_"+f).html(topicContent[b]),topicContent[b]=undefined),setFocusToContainer($("#eachTopic_"+b),!1,0)),e.attr("navStatus")=="No"&&c=="topicList"&&(e.attr("navStatus","Yes"),getprevAndFirstPost(e))}function getMoreTopics(a,b,c,d,e,f,g){showLoadingImage();var h={},i="",j=$("#topicListHeaderCont").attr("isTypeURL"),k=$("#innerTabFilter");$("#topicListFilter").is(":visible")&&(k=$("#topicListFilter")),a!=""&&(h.forumURL=a,isTopicQuickView=="true"?i="forum/"+a:i=a),b!=""&&(h.categoryURL=b,i=i+"/"+b),h.forumGroupId=forumGroupId,h.fetchPage=c;var l=0;d&&d.toLowerCase()!="all"&&(isOneTopicType!="true"||d.toLowerCase()!="questions"&&d.toLowerCase()!="ideas"&&d.toLowerCase()!="problems")&&(i==""?i="filter":i+="/filter",l=1,i=i+"/"+d);if(d){if(k.attr("isTypeURL")=="yes"){var m=k.attr("topicfiltertype");d.toLowerCase()=="all"?d=m:d.toLowerCase()=="unrepliedposts"&&(h.unReplyWithType=m)}h.topicFilter=d}if(d=="postssincelastvisit"){var n=k.attr("postSinceLastVisitTime");n!=null&&n!="undefined"&&(h.postSinceLastVisitTime=n)}var o="";$("#topicList").length>0&&g!="reload"?(o="/getMoreTopics.do",$locadLocation=$("#topicList")):$("#topicsList").length>0&&g!="reload"?(o="/getMoreTopicsTP.do",$locadLocation=$("#topicsList")):(o="/getSingleForumTopics.do",$locadLocation=$("#mainContent"));if(f){f=f.toLowerCase(),f=f.replace(/\s/ig,"").replace("-","");var p=f;d=="problems"&&f=="needmoreinfo"&&(f="moreinfo",p="needmoreinfo"),d=="questions"&&f=="workingonit"&&(f="working",p="workingonit"),f=="we"&&(f="wewillthinkaboutit",p=f);if(i18n_Status_[f]){var q=i18n_Status_[f];q&&(l==0&&i==""?i="filter":l==0&&(i+="/filter"),i=i+"/"+p,h.statusURL=q)}}return doAjaxAction(o,h,function(a){$locadLocation.get(0).innerHTML=a,bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),o=="/getSingleForumTopics.do"&&(lightBox("#chartWidget"),lightBox("#topicList"),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"))),goToTop(),hideLoadingImage();if(typeof WmsContacts!="undefined"&&ch=="true"){var b=WmsContacts.getZohoContacts();setPresenceInTopicList(b)}if(d=="PostsSinceLastVisit"){var e=$("#topicList").find("a.mediumUnderlineLink");e.removeClass("mediumUnderlineLink").addClass("mediumUnderlineLinkNew")}j=="no"&&isTopicQuickView=="true"&&(i!=""?parseInt(c)>1?$.history.add(i+"/"+c):$.history.add(i):parseInt(c)>1?$.history.add("home/"+c):$.history.add("home"))},function(a){}),!1}function getMoreTagRelatedPost(a,b,c){showLoadingImage();var d={};return d.fetchPage=a,d.tagName=b,d.forumGroupId=forumGroupId,d.getPostFor=c,doAjaxAction("/getMoreTagRelatedPosts.do",d,function(a){$("#topicList").length>0?($("#topicList").get(0).innerHTML=a,bindTopicClicks($("#topicList"))):($("#topicsList").get(0).innerHTML=a,bindTopicClicks($("#topicsList"))),goToTop(),hideLoadingImage()},function(a){}),!1}function getSingleForumTopics(a){showLoadingImage();var b=a,c={};return c.forumId=b.attr("forumId"),c.categoryId=b.attr("categoryId"),c.forumGroupId=forumGroupId,c.fetchPage=b.attr("fetchPage"),c.ch=ch,doAjaxAction("/getSingleForumTopics.do",c,function(a){$("#mainContent").get(0).innerHTML=a,lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop(),hideLoadingImage(),$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide()},function(a){$("#mainContent").get(0).innerHTML=a.responseText,hideLoadingImage()}),!1}function selectTopicType(a,b){var c="";if(typeof b=="undefined"||b==""){a.addClass("selected").siblings('li[purpose="topicTypeTab"]').removeClass("selected"),c=a.attr("topicType");var d=a.attr("topicIconClass")}else d=b,c=$("#writepostCont").attr("topicType");var e="";c==1?(e="imgAnnouncement",$("#announcementExpiryCont").show()):$("#announcementExpiryCont").hide(),$("#currentTopicType").val(c),d=="discuss"?(e="imgDiscuss",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.discussionTypeMessage"])):d=="question"?(e="imgQuestion",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.questionTypeMessage"])):d=="idea"?(e="imgIdea",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.ideaTypeMessage"])):d=="error"?(e="imgError",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.problemTypeMessage"])):$("#writeNewTopic").html(i18n["zohodiscussions.writePost.announcementTypeMessage"]),$("#TopicContentHolder").attr("class",d).attr("imgAttrClass",e);var f=$("#SelectForum").val();f==null?$("#selectForumMessage").show():$("#selectForumMessage").hide()}function initWritePost(){newOpenEditor($("#editorLocation"),"responseContent","postContentTA"),loadCategories(),$('#writepostTabsCont li[purpose="topicTypeTab"]').click(function(){selectTopicType($(this))}),$("#SelectForum").change(function(){loadCategories()}),$("#publishTopic").click(function(){addForumPost(!1)}),$("#previewTopic").click(function(){var a=$(this),b=a.attr("isDraft"),c=a.attr("userName");writePostPreview(c,"Preview","true",b)}),$("#attachmentsListCont").find("div.imgAshDelete").click(function(a){$this=$(this);var b=$this.attr("attachmentName"),c=$this.attr("attachmentId");deleteUnpublishedAttachment(b,c,a);return}),$("#listOfMyDraftCont").click(function(){var a=$(this).attr("draftsize");if(a<1)return;var b=$(this);b.is(".moreOptionsTop")?b.removeClass("moreOptionsTop").addClass("moreOptionsTopSelected"):b.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop"),b.hover(function(){var a=b.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){b.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop")},500);b.data("destroyHandle",a)})}),$("#saveDraft").click(function(){addForumPost(!0)}),$("#cancelAddTopic").click(function(){$("#mainContent div.mainFullWrite").html(""),isCancelButtonClicked("Home")}),loadUploadAttachmentsCont()}function closeGDocsAttachTemplate(a){a=="zdocs"?$("#zDocsTemplate").hide():$("#gDocsTemplate").hide(),hideLoadingImage()}function loadUploadAttachmentsCont(a,b){var c=$("#attachTemplate").length==1?!0:!1,d=c==1?"attachTemplate":"responseAttachTemplate",e=$("#attachmentsListCont"),f=e.find("div.singleElementBox,li.tinyText").length;$("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),c==1?$('#newPostRightCont  div[purpose="attachmentTemplate"]').remove():$("#attachBrowseCont").html("");if(f<maxAttachmentsPerPost){var g=maxAttachmentsPerPost-f,h=f+1,i=$("#"+d),j=i.clone();c==1?j.insertBefore(e).show():$("#attachBrowseCont").append(j.show()).show(),j.attr("id",d+"_"+h),j.attr("purpose","attachmentTemplate");var k='<form action = "/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>';isEmbedService()&&(k='<form action = "/discussions/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>'),j.find("div.dataEncloser").wrap(k),j.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_'+h+'"> </iframe>'),j.find("form").attr("target","fileUpdTgt_"+h);var l=j.find("form > div.dataEncloser"),m=l.find("a#desktopAttachments"),n=l.find("a#zDocsAttachments"),o=l.find("a#gDocsAttachments");m.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;$("input[type=file]").change(function(){$("#publishResponse,#previewResponse").attr("disabled",!0),$("#publishTopic,#saveDraft").attr("disabled",!0)})}),n.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var a={servicename:"discussion",attachCount:h,search:!1};ATTACHDIALOG.showAttachFileDialog(a)}),o.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var a=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/jsp/AddGDocs.jsp&maxDocs="+g+"&id=1";isEmbedService()&&(a=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/discussions/jsp/AddGDocs.jsp&maxDocs="+g+"&id=1");var b=$("#gDocsTemplate");b.html('<iframe height="600px;" width="800px;" style="margin-top:5%; margin-left:17%" src="'+a+'"></iframe>'),b.show()});if(typeof a=="undefined")j.find(":file").change(function(){j.find('[purpose="attachLoadingCont"]').show(),j.find(':input[name="attacher"]').val(""),j.find("form").get(0).submit()});else{showLoadingImage(i18n["zohodiscussions.settings.creating"]);var p=a.split(":"),q="attachZDocs";b=="gdocs"&&(q="attachGDocs"),$.each(p,function(a,b){j.find("form div.dataEncloser").append('<input name="'+q+'"  type="hidden" value="'+b+'">')}),j.find("form").get(0).submit()}}}function uploadGDocsFileSuccess(a,b,c){var d=a.length,e=0,f="",g="";for(var h=0;h<d;h++){var i=a[h],j=i.result,k=i.actualFileName;if(j=="success"){var l=i.actualAttachId,m=i.attachmentSize,n=i.attachmentId;uploadFileSuccess(n,k,b,l,m)}else{e=1;var o=i.reason;f=f+g+"<b>"+k+"</b> : "+i18n[o],g="<br><br>"}}e==1&&showMessage(i18n["zohodiscussions.popupContainers.failedattachmentMess"]+"<br>"+f,"failure",5e3),closeGDocsAttachTemplate(c)}function uploadFileSuccess(a,b,c,d,e){var f=$("#attachmentsListCont"),g=$("#attachTemplate").length==1?!0:!1,h,i=a+","+b+","+e;if(g==1){h=$('<div id="newAttachment_'+a+'" class="singleElementBox" attachmentDetails="'+i+'"><div class="flLeft">'+b+'</div><div class="flRight imgAshDelete bgBox"></div></div>');var j=$("#previewAttachment");$("#newAttachment_"+a).attr("attachmentDetails",i),$("#AttachmentPreviewCont").show()}else h=$("#responseEachAttachmentTemplate").clone(),h.attr("id","newAttachment_"+a).attr("attachmentDetails",i).show(),h.find('[attachmentPurpose="attachmentName"]').html(b),h.find('[attachmentPurpose="attachmentSize"]').html(e);$("#previewResponse").append('<input type = "hidden" name="attachmentId" value = "'+a+'"  attachmentDetails= "'+i+'">'),d!=-1&&h.append('<input type = "hidden" name="attachmentId" value = "'+d+'">'),h.find("div.imgAshDelete").click(function(c){deleteUnpublishedAttachment(b,a,c)}),f.append(h),loadUploadAttachmentsCont()}function deleteUnpublishedAttachment(a,b,c){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(c);var d={};d.forumGroupId=forumGroupId,d.fileName=a,d.fileId=b,d[csrfParamName]=csrfToken,doAjaxAction("/deleteUnpublishedAttachment.do",d,function(a){hideLoadingImage(),a=="SUCCESS"&&($("#newAttachment_"+b).remove(),$("#previewAttachment").find("li.singleList").length==1&&$("#AttachmentPreviewCont").hide(),$("#previewResponse").find('input[value= "'+b+'"]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont())})}}function loadCategories(){loadAdminActionsLinks();var a=$("#SelectForum"),b=a.val(),c=a.attr("selectedCategoryName"),d=a.attr("selectedCategoryId"),e=$("#categoryList").val();$("#SelectCategory").hide(),$("#selectCategory").html(""),typeof e!="undefined"&&$.each(e.split("$$"),function(a,c){if(c.indexOf(b+":")>-1)return $("#SelectCategory").html(c.split(":")[1]).show(),!1;$("#SelectCategory").html('<option selected value="-1">Uncategorised</option>').show()});var f=$("#SelectCategory").find('option[value="'+d+'"]');f.length==1?f.attr("selected","true"):$("#SelectCategory option:first").attr("selected","true")}function loadAdminActionsLinks(){var a=$("#SelectForum option:selected").attr("isForumModerator"),b=$("#SelectForum option:selected").attr("isForumPublicView");a=="true"?$("#isStickyLinkCont,#announcementLinkCont").fadeIn():($("#isStickyLinkCont,#announcementLinkCont").fadeOut(),$("#writepostTabsCont li.selected").attr("topicIconClass")=="announcement"&&$("#writepostTabsCont li:first").trigger("click"));if(forumGroupId==0x591a208af78bb8){$("#isNotifyEveryone").fadeOut();return}if(typeof b=="undefined"){$("#isNotifyEveryone").fadeOut();return}b=="false"?$("#isNotifyEveryone").fadeIn():$("#isNotifyEveryone").fadeOut()}function addForumPost(isDraft){if($("#fileUploadStatus").val()!="uploading"){var loadingMessage=isDraft==1?i18n["zohodiscussions.general.saving"]:i18n["zohodiscussions.general.publishing"];disablePostButtons();var $writePostForm=$("#addForumPostForm");$topicTitle=$("#topicTitle");var postTitle=$topicTitle.val();postTitle=postTitle.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),postTitle=$.trim(postTitle);if(postTitle==""){hideLoadingImage(),setFocusToContainer($("#topicTitle")),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),$("#topicTitle").focus();return}$("#topicTitle").val(postTitle);if(postTitle.length>200){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),enablePostButtons();return}var postTags=$("#forumTags").val();postTags=postTags.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");if(postTags!=""&&postTags.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}var tag=postTags.split(",");for(var i=0;i<tag.length;i++)if(tag[i].length>50){showDiscussionMessage(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure"),enablePostButtons();return}var contentToPost=editor.getContent();contentToPost=contentToPost.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),$("#postContentTA").val(contentToPost);var $tempCont=$("<div></div>").html(contentToPost);contentToPost=$tempCont.text(),contentToPost=$.trim(contentToPost);if(contentToPost==""){setFocusToContainer($("#editorHolder").focus()),hideLoadingImage(),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}isDraft==1?$("#topicStatus").val(1):$("#topicStatus").val(0);var selectedForum=$("#SelectForum").val(),selectedCategory=$("#SelectCategory").val();if(selectedForum==null){hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure"),enablePostButtons();return}if(selectedCategory=="0"){hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure"),enablePostButtons();return}var action="/addForumPost.do";ZUID==-1&&(action="/addGuestForumPost.do"),showLoadingImage(loadingMessage),doAjaxAction(action,$("#addForumPostForm").serialize(),function(data){hideLoadingImage();var responseData=eval(data);if(responseData.result=="success"){var forumTopicId=responseData.value;if(isDraft==1)showDiscussionMessage(i18n["zohodiscussions.writePost.saveDraftMsg"],"success",3e3),enablePostButtons(),$("#forumTopicId").val(forumTopicId);else{if(responseData.isApproved==0){$("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.topicAwaitingModeration"],"info"),isTopicQuickView=="false"&&!isZSupport?window.location.href=serverURL+"/topic/"+responseData.topicPermaLink:ZUID==-1?window.location.href="/portalLogin.do?forumGroupUrl="+currentForumGroupURL+"&serviceurl=/":(showLoadingImage(),topiconClickActionNewTopic(selectedForum,forumTopicId,"newtopic"));return}$("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),isTopicQuickView=="false"&&!isZSupport?window.location.href=serverURL+"/topic/"+responseData.topicPermaLink:(showLoadingImage(),topiconClickActionNewTopic(selectedForum,responseData.value,"newtopic"))}}else showDiscussionMessage(responseData.reason,"failure"),enablePostButtons()},function(errordata){hideLoadingImage();if(errordata.responseText.indexOf("'result':'failure'")>0){var responseData=eval(errordata.responseText);if(responseData.result=="failure")if(responseData.errorcode=="HIP_REQUIRED"){var $writePostCaptcha=$("#writePostCaptcha");$writePostCaptcha.attr("currCaptcha")=="new"?showDiscussionMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#captchaCode").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show()}else showDiscussionMessage(responseData.reason,"failure")}else errordata.responseText!=""&&($("#writepostCont").get(0).innerHTML=errordata.responseText);enablePostButtons()})}else $("#submitStat").show()}function singlePostDeleteAction(a,b){var c=a.attr("forumTopicId");c=c||a.parents('li[parentCont="actualParent"]').attr("forumTopicId");var d=a.attr("responseId"),e=a.attr("categoryId");e=e||a.parents('li[parentCont="actualParent"]').attr("categoryId");var f=a.parents('li[parentCont="actualParent"]').attr("responseAuthorId"),g=a.attr("forumId");g=g||a.parents('li[parentCont="actualParent"]').attr("forumId");var h=a.attr("itemType");if(h!="post"){var i={};f==ZUID&&(i.responseowner="true"),i.forumGroupId=forumGroupId,i.forumTopicId=c,i.categoryId=e,i.forumId=g,i.responseId=d,i[csrfParamName]=csrfToken,isEmbedService()?doAjaxAction("/deleteForumResponse.do",i,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3);if(b=="moderation"){var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d)}else refreshSingleTopic(c);updateAwaitingApprovalCount()}}):b=="topicList"?doAjaxAction("/deleteForumResponse.do",i,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3);var b=$("#eachTopic_"+c).attr("currTagName");b==" "?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(b)}}):slideUpActionInModeration("/deleteForumResponse.do",i,a)}else{var j={};f==ZUID&&(j.access="author"),j.forumGroupId=forumGroupId,j.forumTopicId=c,j.categoryId=e,j.forumId=g,j[csrfParamName]=csrfToken;if(isEmbedService())doAjaxAction("/deleteTopic.do",j,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3);if(b=="moderation"){var d=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(d)}else refreshSingleTopic(c)}});else if(b=="topicList"){var k=$("#eachTopic_"+c).attr("currTagName");doAjaxAction("/deleteTopic.do",j,function(a){a=="SUCCESS"&&(showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3),k==" "?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(k))})}else slideUpActionInModeration("/deleteTopic.do",j,a)}}function refreshSingleTopic(forumTopicId){var $topicList=$("#topicList");$topicList.length<1&&($topicList=$("#topicsList"));var options={};options.forumTopicId=forumTopicId,options.forumGroupId=forumGroupId,options.singleTopicRefresh="singleTopicRefresh";var $divToRefresh=$("#eachTopic_"+forumTopicId);doAjaxAction("/refreshSingleTopic.do",options,function(data){hideLoadingImage(),$data=$("<div></div>").html(data);if($data.find("li.singleList").length<1)return $divToRefresh.remove(),!1;var thisModifiedTime=$data.find("div.singleTopicCont").attr("modifiedtime"),endPostModifiedTime=$topicList.find("div.singleTopicCont:last").attr("modifiedtime"),$firstSinglePost=$topicList.find("div.singleTopicCont:first"),startPostModifiedTime=$firstSinglePost.attr("modifiedtime"),shouldScrollTop=!1;thisModifiedTime<endPostModifiedTime?$divToRefresh.remove():thisModifiedTime>startPostModifiedTime?($data.insertBefore($firstSinglePost),$divToRefresh.remove(),eval($data.find("script").html()),shouldScrollTop=!0):($data.insertBefore($divToRefresh),$divToRefresh.remove(),eval($data.find("script").html()),shouldScrollTop=!0),shouldScrollTop==1&&goToTop()})}function disablePostButtons(){$("#publishTopic").attr("disabled",!0),$("#saveDraft").attr("disabled",!0),$('a[purpose="publishPreviewLink"]').hide()}function enablePostButtons(){$("#publishTopic").attr("disabled",!1),$("#saveDraft").attr("disabled",!1),$('a[purpose="publishPreviewLink"]').show()}function getprevAndFirstPost(a){var b=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),c={};c.forumGroupId=forumGroupId,c.forumTopicId=b;var d=a.attr("recentResponseId");if(typeof d!="undefined")c.responseId=d,c.modifiedTime=a.attr("modifiedTime"),c.currResponseCount=a.attr("currResponseCount");else{var e=a.parents("div.listOfResponseLink");c.responseId=e.attr("responseId"),c.modifiedTime=e.attr("modifiedTime"),c.currResponseCount=e.attr("currResponseCount")}c.toProvide="First",c.currStage="1",doAjaxAction("/getResponse.do",c,function(c){var e=$(c),f=$("#recent_ResPonse_"+d);$("#lastResponse_"+b).find('div.listOfResponseLink[prev="-1"]').length<1&&(e.insertAfter(f),lightBox("#"+e.get(0).id),f.next("div.listOfResponseLink").attr("Prev","-1"));var g=$("#navigationLoading_"+d);g.attr("currRequest")=="first"?(g.remove(),f.hide(),$("#navCont_"+d+",#navCont_1_"+d).removeClass("navLoading"),firstOrLastResponse($("#navCont_"+d).find("li.ndtopicNavFirst"))):provideResponse(a);return})}function provideResponse(a){var b=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),c=a.attr("recentResponseId"),d=a.attr("toProvide"),e={};e.forumGroupId=forumGroupId,e.forumTopicId=b,e.toProvide=d;if(typeof c!="undefined")e.modifiedTime=a.attr("modifiedTime"),e.currResponseCount=a.attr("currResponseCount"),e.currStage=a.attr("currResponsestage");else{var f=a.parents("div.listOfResponseLink");c=f.attr("responseId"),e.modifiedTime=f.attr("modifiedTime"),e.currResponseCount=f.attr("currResponseCount"),e.currStage=f.attr("currResponsestage")}e.responseId=c,doAjaxAction("/getResponse.do",e,function(a){var e=$("#recent_ResPonse_"+c),f=$("<div>"+a+"</div>"),g=f.find("div.listOfResponseLink").attr("responseId"),h=$("#lastResponse_"+b).find('div.listOfResponseLink[responseId = "'+g+'"]');if(h.length>0)d=="Prev"?(e.attr("Prev",g),h.attr("Next",c)):d=="Next"&&(e.attr("Next",g),h.attr("Prev",c));else{var i=$(f.html());if(d=="Prev"){i.insertAfter(e),lightBox("#"+i.get(0).id);var j=e.next("div.listOfResponseLink");j.attr("Next",c),e.attr("Prev",g)}else if(d=="Next"){i.insertBefore(e);var j=e.prev("div.listOfResponseLink");j.attr("Prev",c),e.attr("Next",g)}}var k=$("#navigationLoading_"+c);k.attr("currRequest")=="Prev"?(k.remove(),e.hide(),checkPrevNextResponse($("#navCont_"+c).find("li.ndtopicNavPrev")),$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading")):k.attr("currRequest")=="Next"&&(k.remove(),e.hide(),checkPrevNextResponse($("#navCont_"+c).find("li.ndtopicNavNext")),$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading"))})}function checkPrevNextResponse(a){var b=a.parents("div.listOfResponseLink"),c=b.attr("responseId"),d=a.attr("toProvide"),e=b.attr(d);if(e=="0"){var f=$("#navigationLoading").clone();f.attr("id","navigationLoading_"+c).attr("currRequest",d);var g=$("#navCont_"+c);f.insertAfter(g).show(),$("#navCont_"+c+",#navCont_1_"+c).addClass("navLoading"),provideResponse(a);return}var h=$("#recent_ResPonse_"+e);b.hide(),h.show(),setFocusToContainer(h.parents(".ndquickList"),!1,0),$("#navCont_"+e).is(".navLoading")&&$("#navCont_"+c+",#navCont_1_"+c).removeClass("navLoading");if(h.attr(d)!="0")return;var i=$("#navCont_"+e).find('li[toProvide="'+d+'"]');provideResponse(i)}function firstOrLastResponse(a){var b=a.parents("div.listOfResponseLink"),c=a.attr("toProvide"),d=b.attr("responseId"),e=a.parents('li[parentCont="actualParent"]').attr("forumTopicId"),f=$("#lastResponse_"+e),g=$("#recent_ResPonse_"+d);if(c=="First"){var h=f.find('div.listOfResponseLink[Prev="-1"]');if(h.length==0){var i=$("#navigationLoading").clone();i.attr("id","navigationLoading_"+d).attr("currRequest","first");var j=$("#navCont_"+d);i.insertAfter(j).show(),$("#navCont_"+d+", #navCont_1_"+d).addClass("navLoading"),getprevAndFirstPost(a);return}g.hide(),h.show(),setFocusToContainer($("#eachTopic_"+e),!1,0),$("#navCont_"+d).is(".navLoading")&&$("#navCont_"+d+",#navCont_1_"+d).removeClass("navLoading");var k=h.attr("responseId");if(h.attr("Next")=="0"){var l=$("#navCont_"+k).find('li[toProvide="Next"]');provideResponse(l)}}else c=="Last"&&(g.hide(),f.find('div.listOfResponseLink[Next="-1"]').show(),setFocusToContainer($("#eachTopic_"+e),!1,0))}function lightBox(a){$(a).find("a.lightbox").lightbox({navbarOnTop:!0,resizeSpeed:150,overlayOpacity:.1}),$(a).find("img").click(function(){var a=$(this).attr("src");$("#zoomInLineImage").attr("href",a).trigger("click")}),$(window.document).keydown(function(a){if(a.keyCode==27)return $("#lightbox").is(":visible")&&($("#lightbox").hide(),$("#overlay").hide()),!1})}function saveButtonClick(a){var b=$("#"+a),c={};c.forumGroupId=forumGroupId,c.referrer=b.attr("referrer"),c.customFieldValue=b.prev().val(),$.ajax({url:"/joinPortal.do",type:"POST",data:c,error:function(a,b,c){showTipper(a.responseText)},success:function(a){"success"==a?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==a?window.location.reload():"customSignUp"==a&&(location.href=action)}})}function bindSubscribeAction(){$("#joinThisPortal,#portalJoin").unbind("click").click(function(){var a={};a.forumGroupId=forumGroupId,a.referrer="ajax";var b=$(this).attr("isCustomFieldStatus"),c="";b=="1"?($("#customFieldDiv,#customFieldWidgetDiv").show(),$("#portalJoin,#joinThisPortal").hide()):$.ajax({url:"/joinPortal.do",type:"POST",data:a,error:function(a,b,c){showTipper(a.responseText,"failure",1e3)},success:function(a){"success"==a?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==a?window.location.reload():showTipper(i18n["zohodiscussions.widgetscontainer.failure"],"failure",1e3)}})}),$("#joinButtonClick,#portalJoinButtonClick").click(function(){$("#signInorSignUp,#portalsignInorSignUp").toggle(),$("#participateButtonClick,#portalparticipateButtonClick").toggle()}),$("#signInClick,#participateButtonClick").click(function(){"portalBut"==this.className&&$("#portalSignUpClick").attr("action",$(this).attr("action")),$("#iamLoginBox").show(),$("#joinPortalWidget,#portaljoinContent").hide();var a=$(this).attr("src");$("#iamLoginBox iframe,#portaliamLoginBox iframe").attr("src",a)}),$("#signUpClick,#portalSignUpClick,#portalSignUpClickPopup").click(function(){var a=$(this).attr("action");location.href=a})}function showall(a,b){var c=$("#showAll").attr("currentmode");return c=="show"?($("#"+a).removeAttr("style"),$("#showAll").text(i18n["zohodiscussions.general.less"]),$("#showAll").attr("currentmode","hide")):(b=="isCatg"?$("#"+a).attr("style","min-height:40px;max-height:170px;overflow:hidden;"):$("#"+a).attr("style","min-height:40px;max-height:230px;overflow:hidden;"),$("#showAll").text(i18n["zohodiscussions.general.more"]),$("#showAll").attr("currentmode","show")),!1}function topiconClickActionNewTopic(a,b,c){return isEmbedService()&&typeof c!="undefined"&&c=="newtopic"?isZIntranet?(ZIntranet.loadTopic(a,b),!1):(ZSupport.callBackForumPost(a,b),!1):isTopicQuickView?(openSinglePost(b),!1):!0}function topiconClickArrowAction(a,b,c){return topiconClickAction(a,b,!c),!1}function topiconClickAction(a,b,c){return typeof c!="undefined"&&!c?!1:isEmbedService()?(isZIntranet?ZIntranet.loadTopic(a,b):ZSupport.callBackForumPost(a,b),!1):isTopicQuickView=="true"?!1:!1}function topicHeaderForumDropDownClick(a,b,c,d){return isEmbedService()?(d==undefined&&(d="-1"),c==undefined&&(c="-1"),forumClickAction(c,d),!1):a!="true"?!1:(window.location.href=b,!1)}function topicListHeaderFilterAction(a,b,c,d,e,f){if(isEmbedService()){e=e.toLowerCase(),f?(f=f.toLowerCase(),f=f.replace(/\s/ig,"").replace("-","").replace("undefined","")):f="";var g=f;e=="problems"&&f=="needmoreinfo"&&(f="moreinfo",g="needmoreinfo"),e=="questions"&&f=="workingonit"&&(f="working",g="workingonit"),f=="we"&&(f="wewillthinkaboutit",g=f);if(i18n_Status_[f]){var h=i18n_Status_[f];h&&(f=h)}return forumFilterClickAction(c,d,e,f),!1}if(a!="true")return!1;window.location.href=b}function forumFilterClickAction(a,b,c,d,e){return isEmbedService()?(isZIntranet?ZIntranet.loadForum(a,c,d):ZSupport.callBackForumFilter(a,b,c,d,e),!1):!1}function forumClickAction(a,b,c){return b=b==undefined?-1:b,c=c==undefined?1:c,isEmbedService()?(isZIntranet?ZIntranet.loadForum(a):ZSupport.callBackForumView(a,b,c),!1):!1}function initTopicsPageActions(){lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),setToHotkeys()}function newTopicCall(){initLoginFrame($("#NewTopicTab"))}function initLoginFrame(a){var b=$("#loginFrame");hideLoadingImage();var c=a.attr("iamURL");b.size()>0&&(b.show().find("div.iFrameContainer").show().html('<iframe scrolling="no" frameborder="0" height="192px" src="'+c+'"></iframe>'),$("#iamLoginBox").hide());var d=$("#listof_FC_Counts");$("#countOfForum").html(d.attr("forumCount")),$("#countOfCategory").html(d.attr("categoryCount")),$("#countOfPosts").html(d.attr("postCount")),$("#countOfResponses").html(d.attr("responseCount"));var e=$("#tploginforms"),f=a.attr("loginURL"),g=a.attr("iamURL");return e.find('input[name="serviceurl"]').val(f),e.find('input[name="domain"]').val(g),!1}function loginBoxClose(){$("#iamLoginBox").show(),$("#joinPortalWidget").size()>0&&($("#joinPortalWidget").show(),$("#iamLoginBox").hide()),$("#loginFrame").hide(),initTopicsPageActions()}function signInViaGoogle(){return $("#tploginforms").find('form[name="googleform"]').submit(),!1}function signInViaYahoo(){return $("#tploginforms").find('form[name="yahooform"]').submit(),!1}function signInViaFacebook(){return $("#tploginforms").find('form[name="fbform"]').submit(),!1}function signInViaGoogleApps(){return $("#tploginforms").find('form[name="gappsform"]').submit(),!1}function forumGroupNameDecode(a){var b=a.split("&#39;").length-1;for(var c=0;c<b;c++)a=a.replace("&#39;","/'");return a}function attachDocsIntegCallBackFn(a){a=a.replace(/\%20/g," ");if(typeof a!="undefined"){var b=a.split("&");if(b.length<3)return;var c=b[0].split("docIds="),d=b[1].split("docNames="),e=b[2].split("service="),f=c[1].split(","),g=d[1].split(","),h=e[1].split(","),i=f.length,j="false",k="",l="";for(var m=0;m<f.length;m++){var n=f[m],o=g[m],p=h[m];o.indexOf(".")<0&&("show"==p?o+=".ppt":"sheet"==p?o+=".xls":"writer"==p&&(o+=".doc")),k=k+l+n+","+p+","+o+","+j,l=":"}loadUploadAttachmentsCont(k,"attachZDocs")}}function zohoSupportSearch(searchFor,forumGroupId,forumId,categoryId){var options={};options.forumGroupId=forumGroupId,options.forumId=forumId,options.categoryId=categoryId,options.searchFor=searchFor,doAjaxAction("/getSearchResult.do",options,function(a){hideLoadingImage();var b=$("<div></div>");b.get(0).innerHTML=a,$("#mainContent").get(0).innerHTML=a,bindSearchContentClick($("#mainContent")),showAuthorPopout(b),$("#searchInputBox").val(searchFor)},function(err){hideLoadingImage();var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function openSinglePost(a,b,c){b=b||"Topic",c!=undefined?loadSinglePost(a,"true",undefined,c):loadSinglePost(a),!isZIntranet&&!isZSupport&&$.history.add(b+"/"+a)}function loadSinglePost(a,b,c,d){var e={};e.forumTopicId=a,e.forumGroupId=forumGroupId,typeof b=="undefined"&&(b=!0),doAjaxAction("/getSinglePost.do",e,function(e){hideLoadingImage();if(e.substring(12,19)=="failure"){var f={};doAjaxAction("/errorInfo.do",f,function(a){$("body").get(0).innerHTML=a,document.title="Request url not found";return})}if($("#topicListMainContainer").length>0||$("#userProfileMainContainer").length>0||$("#myAreaParentContainer").length>0){$("#topicListMainContainer").hide().attr("shouldReload","false"),$("#userProfileMainContainer").hide().attr("shouldReload","false"),$("#myAreaParentContainer").hide().attr("shouldReload","false");if($("#SinglePostContainer").length>0)$("#mainContent").get(0).innerHTML=e,$(window).scrollTop(0);else{var g=document.createElement("div");g.innerHTML=e,$("#mainContent").get(0).appendChild(g)}}else $("#mainContent").get(0).innerHTML=e;b&&b==1?$(window).scrollTop(0):b&&b=="showWatchOption"&&$("#followTopic_"+d).show();if(typeof c!="undefined"){var h=$(c).offset().top;$("html,body").scrollTop(h-100)}initSinglePost(a);var i=$("#topicContainer_"+a),j=i.attr("forumId"),k=i.attr("categoryId");typeof j=="undefined"&&(j=-1),typeof k=="undefined"&&(k=-1);var l="NewTopic/"+j+"/"+k;$("#NewTopicTab").attr("hashPurpose",l);if(typeof WmsContacts!="undefined"&&ch=="true"){var m=WmsContacts.getZohoContacts();setPresenceInTopicList(m,a)}d!=undefined&&typeof c=="undefined"&&(setFocusToContainer($("#fullResponseContainer_"+d),!1,100,0),$("#SinglePostContainer").data("currentFocusResponse",$("#"+d))),isMac=="false"&&setHotkeysToSinglePost()},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}function initSinglePost(a){showAuthorPopout($("#SinglePostContainer"));var b=$("#DocumentTitle");forumGroupName=forumGroupNameDecode(forumGroupName),isEmbedService()||(document.title=b.length>0?b.text()+" - "+forumGroupName:forumGroupName),bindSingleTopicClicks($("#SinglePostContainer")),lightBox("#SinglePostContainer");var c=$("#topicContainer_"+a);return $("#SinglePostContainer").unbind("click",singlePostWidgetActions).click(singlePostWidgetActions),singlePostTagActions(a),$("#mainContent").attr("process-pre-tags",a),setTimeout(function(){processCodeTags($("#SinglePostContainer"),a)},5),!1}function showCode(a){var b=a.parentNode.nextSibling.innerHTML;b=b.replace(/<\/li>/ig,"\n").replace(/<[^>]*>/ig,"").replace(/&nbsp;/ig," ").replace(/&lt;/ig,"<").replace(/&gt;/ig,">").replace(/&amp;/ig,"&"),$("#CopyCodeCont").show().parent().show(),$("#copycode_text").val(b).select()}function processCodeTags(a,b){if(!b||!a||a.length<1)return;var c=$("#mainContent"),d=c.attr("process-pre-tags");if(d!=b)return;var e=a.find("ol.code");e.before(codeForPreview)}function bindSingleTopicClicks(a){a.unbind("click",processSingleTopicClicks).click(processSingleTopicClicks);var b=$("#SinglePostContainer").attr("forumTopicId"),c=$("#replyToTopicBtn_"+b),d=c.attr("replyContainer"),e=c.attr("canUserReplyThis");e=="true"&&d=="true"&&$("#replyToTopicBtn_"+b).find("div.imgReply").trigger("click")}function processSingleTopicClicks(a){var b=$(a.target),c=b.parent(),d="singlePost",e=$("#SinglePostContainer").attr("forumTopicId"),f=$("#topicContainer_"+e),g=$("#statusList");if($("#loadingImg").is(":visible"))return;if(b.is('a[purpose="authorProfile"]')){var h=b.attr("authorName"),i=b.attr("singleClickflag");if(i=="0"){var j=h==ZU_Name?"MyArea":"User/"+h;processHash(j)}return}if(b.is("#replyToTopicBtn_"+e+",#replyToTopicBtnSec_"+e)||c.is("#privateResponseThisTopic_"+e)){var k=b.attr("postauthor"),l=$("#paginationContainer"),m=b.attr("canUserReplyThis"),n=b.attr("replyContainer");if(m!="undefined"&&m=="false"){initLoginFrame(b,n);return}$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&l.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var o=f.data("editorContLocation");setFocusToContainer($(o),!1);return}var p="replyToTopicBtn",q="false";c.is('[purpose="privateResponse"]')&&(p="privateResponseThisTopic",q="true");var r="#newResponseCont_"+e;if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"]),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");var o=f.data("editorContLocation");return setFocusToContainer($(o),!1),!1}return $(r).show(),newOpenEditor($("#newResponse_"+e),"responseContent","postContentTA",p+"_"+e,"Write","topicContainer_"+e,q),setFocusToContainer($(r),!1),f.data("inEditMode",!0),f.data("editorContLocation",r),$("#previewResponse").attr("forumTopicId",e),$(this).is('[purpose="privateResponse"]')&&$("#newResponseCont_"+e).find("div.header").html(i18n["zohodiscussions.singlePost.editorHeaderPrivateResponseTo"]+" "+k+""),!1}if(b.is("#TopicListLink,#ForumTopicListLink,#CategoryTopicListLink,#singlePostForumLink"))return s=b,hashPurpose=s.attr("hashPurpose"),$("#topicListMainContainer").attr("shouldReload","true"),processHash(hashPurpose),!1;if(b.is("#topicVoteLink")||c.is("#topicVoteLink")){var s=b.is("#topicVoteLink")?b:c,t=$("#topicVoteLink").attr("firstResponseId");if(ZUID==-1){showTipper(i18n["zohodiscussions.singlepost.logintovotetopic"],"failure");return}var u=s.attr("isThisUserVoted");if(u=="true"){showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure");return}showLoadingImage(i18n["zohodiscussions.general.updating"]),doAjaxAction("/voteTopic.do?forumGroupId="+forumGroupId+"&forumTopicId="+e+"&responseId="+t,csrfOptions,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var b=parseInt($("#topicVoteLink").attr("responseVoteCount"))+1,c=$("#topicVoteLink").attr("title");c=c.substring(1,c.length),$("#topicVoteLink").attr("title",b+" "+c),$("#topicVoteLink > span").length>0?$("#topicVoteLink > span").html(b):$("#topicVoteLink").append("<span class='flLeft'>"+b+"</span>"),hideLoadingImage()}else hideLoadingImage(),showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure")})}else if(b.is("input[followItem]")){var v=b.attr("followItem");v=="true"&&watchThisItem(b,"singlePost",a)}else{if(c.is("#topicPermalink")){var w=c.attr("thisTopicPermalink");$("#PermalinkCont textarea").val(w),$("#permalink_Text").select(),$("#PermalinkCont").show().parent().show();return}if(c.is("#linkToTopic"))linkToTopic();else if(b.is("#deleteLinkedTopic"))deletelinkedTopic(b);else if(b.is('a[purpose="linkedTopicTitle"]')){if(isTopicQuickView!="false"){var e=b.attr("forumTopicId");return processHash("Topic/"+e),!1}}else{if(b.is('input[purpose="watchAction"]')){var x=$("#editorHolder").find('input[name="isFollowTopic"]');b.is(":checked")||b.attr("checked")==1||b.attr("checked")=="true"?x.attr("value","true"):x.attr("value","false");return}if(c.is("#emailThisTopic"))return openEmailTopicDialog(c),!1;if(c.is('li[actionPurpose="reportSpam"],div[actionPurpose="reportSpam"]')||b.is('a[actionPurpose="reportSpam"]')){var y=b.is('a[actionPurpose="reportSpam"]')?b:c;singlePostSpamAction(y,d);return}if(c.is('div[buttonPurpose="approve"]')||c.is('li[buttonPurpose="approve"]')||b.is('a[buttonPurpose="approve"]')){var y=b.is('a[buttonPurpose="approve"]')?b:c;singlePostApproveAction(y,"singlePostApprove");return}if(b.is('div[purpose="inappropriateReason"]')||b.is('span[purpose="inappropriateReason"]'))getReasonForInapppropriate(b);else{if(c.is('span[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(b.is('li[purpose="topicLabel"]'))changeTopicLabel(b);else{var z=f.attr("topicAuthorId"),A=f.attr("forumId"),B=f.attr("categoryId"),C=$("#singlePostUtilCont"),D=C.attr("newThreadReplyLinks");if(b.is(D)){var s=b,e=s.attr("forumTopicId"),E=s.attr("responseId"),F=s.attr("isPrivate"),G="#newThreadResponseCont_"+E,l=$("#paginationContainer");$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&l.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var o=f.data("editorContLocation");setFocusToContainer($(o),!1);return}if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");var o=f.data("editorContLocation");return setFocusToContainer($(o),!1),!1}return $(G).show(),newOpenEditor($("#newThreadResponse_"+E),"responseContent","postContentTA","newThreadReply_"+E,"Write","topicContainer_"+e,F),setFocusToContainer($(G),!1),f.data("inEditMode",!0),f.data("editorContLocation",G),$("#previewResponse").attr("forumTopicId",e),$("#previewResponse").attr("responseId",E),!1}var H=C.attr("responseVoteLinks");if(b.is(H)){var s=b,E=s.attr("responseId"),I=s.attr("votePurpose");if(I=="removeVote"){showTipper(i18n["zohodiscussions.singlepost.alreadyVotedResponse"],"failure");return}showLoadingImage(i18n["zohodiscussions.general.updating"]);var J=I=="removeVote"?"/removeResponseVote.do":"/voteResponse.do";doAjaxAction(J+"?forumGroupId="+forumGroupId+"&responseId="+E+"&forumTopicId="+e,csrfOptions,function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var b=parseInt($("#resposeVoteLink_"+E).attr("responseVoteCount"))+1,c=$("#postActions_"+E+" > .commentLikeButtion").attr("title");c=c.substring(1,c.length),$("#postActions_"+E+" > .commentLikeButtion").attr("title",b+" "+c),$("#postActions_"+E+" > .commentLikeButtion > span").html(b)}else hideLoadingImage()});return}var K=C.attr("chooseBestResponseLinks");if(b.is(K)){showLoadingImage(i18n["zohodiscussions.general.updating"]);var s=b,E=s.attr("responseId"),L={};L.forumGroupId=forumGroupId,L.responseId=E,L.forumTopicId=e,z==ZUID&&(L.topicowner="true"),L[csrfParamName]=csrfToken,doAjaxAction("/bestResponse.do",L,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"],"success"),loadNewPost("/bestResponse.do",a,e),L={},L.forumGroupId=forumGroupId,L.forumTopicId=e,L[csrfParamName]=csrfToken,doAjaxAction("/notifyForBestResponse.do",L,function(){})},function(a){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])});return}var M=C.attr("responseEditLinks");if(b.is(M)){var N=b.attr("id"),s=b,E=s.attr("responseId"),F=s.attr("isPrivate"),O="#fullResponseContainer_"+E,l=$("#paginationContainer");$("#topicListMainContainer").length>0&&$("#SinglePostContainer").length>0&&l.data("inEditMode")&&removeTopicListCache();if($("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var o=f.data("editorContLocation");setFocusToContainer($(o),!1);return}if(f.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var o=f.data("editorContLocation");return $("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click"),setFocusToContainer($(o),!1),!1}return $(O).show(),N=="editTopic"&&($("#linkTopicCont_"+e).hide(),$("#statusContainer").hide()),newOpenEditor($("#responseContentContainer_"+E),"responseContent","postContentTA",N,"Edit","topicContainer_"+e,F),setFocusToContainer($(O),!1),f.data("inEditMode",!0),f.data("editorContLocation",O),$("#previewResponse").attr("responseId",E),$(O).attr("class")=="postContent"||N=="editTopic"?$("#previewResponse").attr("location","editTopic"):$("#previewResponse").attr("location","editResponse"),$("#previewResponse").attr("forumTopicId",e),!1}if(b.is("#removeBestResponse")){showLoadingImage(i18n["zohodiscussions.general.updating"]);var L={};L.forumGroupId=forumGroupId,L.forumTopicId=e,z==ZUID&&(L.topicowner="true"),L[csrfParamName]=csrfToken,doAjaxAction("/removeBestResponse.do",L,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBestResponseMsg"],"info"),loadNewPost("/removeBestResponse.do",a,e)},function(a){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])});return}if(b.is("#deleteTopic")){showLoadingImage(i18n["zohodiscussions.general.deleting"]);var P={};z==ZUID&&(P.access="author"),P.forumGroupId=forumGroupId,P.forumTopicId=e,P.categoryId=B,P.forumId=A,P[csrfParamName]=csrfToken,doAjaxAction("/deleteTopic.do",P,function(a){jQuery.trim(a)=="SUCCESS"&&(removeTopicListCache(),showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info"),isEmbedService()?forumClickAction(A):processHash("Home"))},function(a){});return}var Q=C.attr("responseDeleteLinks");if(b.is(Q)){showLoadingImage(i18n["zohodiscussions.general.deleting"]);var s=b,E=s.attr("responseId"),R=s.attr("responseAuthorId"),S={};R==ZUID&&(S.responseowner="true"),S.forumGroupId=forumGroupId,S.forumTopicId=e,S.categoryId=B,S.forumId=A,S.responseId=E,S[csrfParamName]=csrfToken,$("#fullResponseContainer_"+E).hide(),hideLoadingImage();var T=$("#SinglePostContainer_"+e).find(".spreplyContainer").attr("responseCount"),U=1;return doAjaxAction("/deleteForumResponse.do",S,function(a){if(a=="SUCCESS"){removeTopicListCache();var b=$("#fullResponseContainer_"+E).attr("threadResponses");if(b==undefined||b=="")$("#fullResponseContainer_"+E).remove(),T=--T;else{var c=b.split("_");$.each(c,function(a,b){$("#fullResponseContainer_"+b).is(":visible")&&($("#fullResponseContainer_"+b).remove(),U=++U)}),T-=U}$("#SinglePostContainer_"+e).find(".spreplyContainer").attr("responseCount",T),T>0?$("#SinglePostContainer_"+e).find(".spreplyContainer > h2").html(i18n["zohodiscussions.general.replies"]+"("+T+")"):($("#SinglePostContainer_"+e).find(".spreplyContainer > h2").html(""),$(".postFooter > .flRight").hide()),$("#SinglePostContainer_"+e).find(".spreplyContainer").length>0&&!$(".spsingleReplyContainer").is(":visible")&&$("#SinglePostContainer_"+e).find(".spreplyContainer > h2").html(""),showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info")}},function(a){}),!1}}}}}g.hover(function(){var a=g.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){g.hide()},500);g.data("destroyHandle",a)})}function getReasonForInapppropriate(a){if(moderatorForSpam!="true")return;showLoadingImage();var b=a.attr("responseId"),c={};c.forumGroupId=forumGroupId,c.responseId=b,c[csrfParamName]=csrfToken,doAjaxAction("/getInappropriateReason.do",c,function(a){hideLoadingImage();var b=$("<div></div>").html(a);b.is("#noInappropriateReason")&&showMessage(i18n["zohodiscussions.inappropriate.NoReasonForInappropriate"],"failure");var c=$("#inappropriateReason");c.html(a).show(),$("#inappropriateReasonClose").click(function(){c.html("").hide()})})}function linkToTopic(){$("#linkToTopicTemplate").html($("#dimDivLinkTO").html()),$("#dimDivLinkTO").html(""),$("#linkToTopicTemplate").show(),$("#linkTopicUrl").focus(),$("#cancelLinkTo").click(function(){$this=$(this),$("#dimDivLinkTO").html($("#linkToTopicTemplate").html()),$("#linkToTopicTemplate").hide(),$("#linkToTopicTemplate").html("")}),$("#saveLinkToTopic").click(function(){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=$(this);var currentTopicId=$this.attr("currentTopicId"),url_pattern="^(ht|f)tp(s?)://[0-9a-zA-Z]([-.w]*[0-9a-zA-Z])*(:(0-9)*)*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_]*)?$",topicPattern1="#Topic/",topicPattern2="?ftid=",topicPattern3="/topic/",linkToTopicUrl=$("#linkTopicUrl").val();if(jQuery.trim(linkToTopicUrl)==""){showMessage(i18n["zohodiscussions.createforumgroup.LinkEmpty"],"failure");return}linkToTopicUrl=$.trim(linkToTopicUrl);if(linkToTopicUrl.match(url_pattern))if(linkToTopicUrl.indexOf(topicPattern1)>-1||linkToTopicUrl.indexOf(topicPattern2)>-1||linkToTopicUrl.indexOf(topicPattern3)){var options={};options.forumGroupId=forumGroupId,options.currentTopicId=currentTopicId,options.forumTopicId=currentTopicId,options.linkToTopicUrl=linkToTopicUrl,options[csrfParamName]=csrfToken,doAjaxAction("/addLinkToTopic.do",options,function(data){if(data.indexOf("'result':'failure'")>0){var message=eval(data).reason;showTipper(i18n[message],"failure")}else data.indexOf("'result':'FAILURE'")>0?showTipper(i18n["zohodiscussions.singlePost.requestedURLnotfoundMessage"],"failure"):(removeTopicListCache(),loadNewPost("/addLinkToTopic.do",data,currentTopicId),showTipper(i18n["zohodiscussions.singlepost.topicLinkedSuccessMessage"],"success"),$("#linkToTopicTemplate").hide())})}else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure");else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure")})}function deletelinkedTopic(a){var b=a.attr("currentTopicId"),c=a.attr("linkedTopicId"),d=a.attr("location"),e={};e.forumGroupId=forumGroupId,e.forumTopicId=b,e.linkedTopicId=c,e[csrfParamName]=csrfToken,confirm(i18n["zohodiscussions.singlepost.removeLinkConfirmationMess"])&&doAjaxAction("/deleteLinkedTopic.do",e,function(a){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.deleteLinkedTopicMessage"],"success"),d=="topicList"?getForumTopics(-1,-1,1,"Home"):d=="singlepost"&&loadNewPost("/deleteLinkedTopic.do",a,b)},function(a){showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function deletePublishedAttachment(a,b){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=a;var c=$this.attr("attachmentId"),d=$this.attr("forumTopicId"),e=$this.attr("responseId"),f=typeof e!="undefined"?e:d,g=$("#fullResponseContainer_"+e).find(".spattachmentList").attr("totalAttachment"),h={};h.forumGroupId=forumGroupId,h.forumTopicId=d,h.responseId=e,h.fileName=$this.attr("attachmentName"),h.fileId=c,h.access="author",h[csrfParamName]=csrfToken,hideLoadingImage(),doAjaxAction("/deleteAttachment.do",h,function(a){a=="SUCCESS"&&(showTipper(i18n["zohodiscussions.general.Deleted"],"info"),$("#SinglePostContainer").length>0?(hideLoadingImage(),showLoadingImage(),removeTopicListCache(),g>1?($("#discussionsAttachment_"+c).remove(),$("#fullResponseContainer_"+e).find(".spattachmentList").attr("totalAttachment",g-1)):$(".attachments").remove()):$("#topicList").length>0||$("#topicsList").length>0?($("#topicListMainContainer").attr("shouldReload","true"),$("#currentCategoryContext").length>0?$("#currentCategoryContext").trigger("click"):$("#currentForumContext").trigger("click")):$("#topicContent_"+f).length>0&&($("#topicContent_"+f).find("li[attachmentId ="+c+"]").remove(),$("#topicContent_"+f).find("li.singleList").length==0&&$("#topicContent_"+f).find("div.Attachments").remove()))})}}function openEmailTopicDialog(a){var b=a,c=b.attr("topicTitle"),d=b.attr("forumTopicId");d=d||b.parents('div[parentCont="actualParent"]').attr("forumTopicId");var e=e,f=$("#emailTopicPrompt");return f.find(':input[name="Subject"]').val(c),f.find(':input[name="forumTopicId"]').val(d),f.find(':input[name="topicTitle"]').val(c),f.find(':input[name="emailIds"]'),f.show().parent().show(),f.find(':input[name="emailIds"]').focus(),!1}function emailTopic(event){var $this=$(event.target);$this.html(i18n["zohodiscussions.singlePost.sending"]);var $emailDialog=$("#emailTopicPrompt");return discussionsValidate($emailDialog.find("form"))==1?(doAjaxAction("/eMailTopic.do",$emailDialog.find("form").serialize(),function(a){a=="SUCCESS"&&(showTipper(i18n["zohodiscussions.singlepost.mailsentmessage"],"success"),$this.html(i18n["zohodiscussions.general.send"]),cancelEmailTopic())},function(err){if(err.responseText.indexOf("'result':'failure'")>0){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),$this.html(i18n["zohodiscussions.general.send"])}else showTipper(i18n["zohodiscussions.errorpage.requestedURLisnotfoundMess"],"failure",1e3)}),!1):($this.html(i18n["zohodiscussions.general.send"]),!1)}function cancelEmailTopic(){var a=$("#emailTopicPrompt");return a.hide().parent().hide(),a.find(':input[name="emailIds"]').val(""),a.find(':input[name="Subject"]').val(""),$("#emailContentArea").val(""),!1}function singlePostApproveAction(a){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var b=a.attr("action"),c=a.attr("forumTopicId"),d=a.attr("forumId"),e=a.attr("categoryId"),f=a.attr("itemType"),g={};g.forumGroupId=forumGroupId,g.forumTopicId=c,g.forumId=d,g.categoryId=e,g.authorId=a.attr("authorId"),g[csrfParamName]=csrfToken;if(f=="response"){var h=a.attr("responseId");g.responseId=h}a.hide(),$("div.approveButton").hide(),hideLoadingImage(),doAjaxAction(b,g,function(a){a=="SUCCESS"&&(removeTopicListCache(),updateAwaitingApprovalCount())})}function singlePostSpamAction(a,b){var c=a.attr("postType");c=="topic"?c=i18n["zohodiscussions.moderationList.topic"]:c=="response"&&(c=i18n["zohodiscussions.moderationList.response"]);var d=a.attr("spamValue"),e="";moderatorForSpam=="true"?(d==1?e=i18n["zohodiscussions.singlepost.spamActionconfirmationmessage1"]+" "+c+" "+i18n["zohodiscussions.singlepost.inappropriateActionconfirmationmessage2"]:e=i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+c+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"],confirm(e)&&spamAction(a,c,b)):d==1?($("#spamStatusMsg").show(),$("#spamDetails_Text").html(""),$("#spamContentDetails").unbind("click").click(function(){var d=$("#spamDetails_Text").val();d=$.trim(d);if(d==""){showMessage(i18n["zohodiscussions.singlePost.EmptyMsgError"],"failure");return}spamAction(a,c,b,"appropriate",d)})):confirm(i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+c+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"])&&spamAction(a,c,b,"appropriate");return}function spamAction($this,postType,$location,appropriate,spamDetails){var forumTopicId=$this.attr("forumTopicId");forumTopicId=forumTopicId||$this.parents('div[parentCont="actualParent"]').attr("forumTopicId");var forumId=$this.attr("forumId");forumId=forumId||$this.parents('div[parentCont="actualParent"]').attr("forumId");var categoryId=$this.attr("categoryId");categoryId=categoryId||$this.parents('div[parentCont="actualParent"]').attr("categoryId");var options={},spamValue=$this.attr("spamValue");options.forumTopicId=forumTopicId,options.forumGroupId=forumGroupId,options.action=spamValue,options.postType=postType,options.purpose=appropriate||$this.attr("purpose"),options.forumId=forumId,options.categoryId=categoryId,options[csrfParamName]=csrfToken,typeof spamDetails!="undefined"&&(options.spamDetails=spamDetails);var responseId=$this.attr("responseId");typeof responseId!="undefined"&&(options.responseId=responseId),doAjaxAction("/spamAction.do",options,function(a){$("#spamStatusMsg").hide();if(a=="SUCCESS"){removeTopicListCache(),spamValue=="1"?appropriate=="appropriate"?showTipper(i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.Inappropriatemarkedmessage2"],"success",1e3):showTipper(i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.spammarkedmessage2"],"success",1e3):appropriate=="appropriate"?showTipper(i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.InappropriateRemovedmessage"],"success",1e3):showTipper(i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.spamRemovedmessage"],"success",1e3);if($location=="singlePost"){if(postType=="response")$("#responseSpamLinks_"+responseId).attr("spamValue")==1?($("#chooseBestResponse_"+responseId).is(":visible")&&$("#chooseBestResponse_"+responseId).hide(),$("#newThreadReply_"+responseId).is(":visible")&&$("#newThreadReply_"+responseId).hide(),$("#responseSpamLinks_"+responseId).html(i18n["zohodiscussions.singlePost.Appropriate"]),$("#responseSpamLinks_"+responseId).attr("spamValue","2"),$("#fullResponseContainer_"+responseId+" > .sppostContentWrapper > .sppostHeader").append('<a class="flRight" actionPurpose="reportSpam" postType="response" responseId="'+responseId+'" forumTopicId = "'+forumTopicId+'" forumId="'+forumId+'" categoryId="'+categoryId+'" spamValue="2" purpose="notSpam" href="javascript:;">'+i18n["zohodiscussions.moderationList.notSpam"]+"</a>")):($("#chooseBestResponse_"+responseId).is(":visible")||$("#chooseBestResponse_"+responseId).show(),$("#newThreadReply_"+responseId).is(":visible")||$("#newThreadReply_"+responseId).show(),$("#responseSpamLinks_"+responseId).html(i18n["zohodiscussions.singlePost.Inappropriate"]),$("#responseSpamLinks_"+responseId).attr("spamValue","1"),$("#responseSpamLinks_"+responseId).attr("purpose","spam"),$("#fullResponseContainer_"+responseId+" > .sppostContentWrapper > .sppostHeader").html(""));else if(postType=="topic")if(spamValue=="1"){var b=$(".authorChatPresence").attr("responseId");$("#fullResponseContainer_"+b+" > .sppostContentWrapper > .sppostHeader").prepend('<div class="flRight approveButton" purpose="inappropriateReason" responseId="'+responseId+'" style="cursor:pointer;cursor:hand;">'+i18n["zohodiscussions.singlepost.topicSpammessage"]+"</div>"),$this.hide(),$(".statusType,.followButtion").hide(),$(".wrapper").prepend('<div forumtopicid="'+forumTopicId+'" actionpurpose="reportSpam" posttype="topic" forumid="'+forumId+'" categoryid="'+categoryId+'" spamvalue="2" purpose="notSpam" class="followButtion green"><a href="javascript:">'+i18n["zohodiscussions.moderationList.notSpam"]+"</a></div>")}else $(".wrapper").find("div[actionPurpose='reportSpam']").remove(),$(".sppostHeader").find("div[purpose='inappropriateReason']").remove(),$(".statusType").is(":visible")||$(".statusType").show(),$(".followButtion").is(":visible")||$(".followButtion").show()}else if(moderatorForSpam=="true")spamValue==1?processHash("home"):($this.parent().remove(),$("#reportInappropriate_"+responseId).remove());else if(spamValue==1){var c=$("#reportInappropriate_"+responseId);c.attr("spamValue","2"),c.find("div.imgAshSpam").removeClass("imgAshSpam").addClass("imgNotSpamIcon"),c.find("a").html(i18n["zohodiscussions.singlePost.Appropriate"]);if($("#reasonInappropriate_"+responseId).length>0){var d=$("#reasonInappropriate_"+responseId),e=parseInt(d.attr("reportCount"));e+=1,d.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+e+")"),d.attr("reportCount",e)}}else{var c=$("#reportInappropriate_"+responseId);c.attr("spamValue","1"),c.find("div.imgNotSpamIcon").removeClass("imgNotSpamIcon").addClass("imgAshSpam"),c.find("a").html(i18n["zohodiscussions.singlePost.Inappropriate"]);var d=$("#reasonInappropriate_"+responseId),e=parseInt(d.attr("reportCount"));e-=1,e>0?(d.attr("reportCount",e),d.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+e+")")):d.remove()}}},function(errordata){var responseData=eval(errordata.responseText);responseData.result=="failure"&&showMessage(responseData.reason,"failure")})}function singlePostWidgetActions(a){var b=$(a.target),c=b.parent(),d="singlePost";if(c.is('li[purpose="bookmark"]'))bookMark(c,a);else if(c.is('li[purpose="watchAction"]')||c.is('div[purpose="watchAction"]'))watchThisItem(c,d,a);else if(c.is('li[purpose="lockTopic"]')||b.is("#unLockTopic")){var e=b.is("#unLockTopic")?b:c;lockTopicLink(e,a)}else if(c.is('li[purpose="moveTopic"]'))moveTopic(c);else if(c.is('li[purpose="stickyPost"]'))stickyLink(c,a);else if(c.is('li[purpose="moderateThisTopic"]'))moderateAction(c,d,a);else if(c.is('li[purpose="changeTopicType"]')){var f=c.attr("forumTopicId");changeTopicType(f)}else if(b.is('input[purpose="notifyAuthor"]')){var f=b.attr("forumTopicId");updateNotification(b,f,a)}else{if(b.is('a[purpose="forumPostsFilter"]'))return hashPurpose=b.attr("hashPurpose"),processHash(hashPurpose),!1;c.is('li[purpose="raiseZSupportRequest"]')&&raiseZSupportRequest(c,a)}}function changeTopicType(a){$("#changeTopicTypeTemplate").html($("#changeTopicType_"+a).html()),$("#changeTopicType_"+a).html(""),$("#changeTopicTypeTemplate").show(),$("#cancelTopicChange,#cancelChangingTopicType").click(function(){$("#changeTopicType_"+a).html($("#changeTopicTypeTemplate").html()),$("#changeTopicTypeTemplate").hide(),$("#changeTopicTypeTemplate").html("")}),$("#topicTypeListForChange").change(function(){var b=$(this);b.val()==1?$("#postExpiryDays_"+a).show():$("#postExpiryDays_"+a).hide()}),$("#doChange_"+a).click(function(){var b=$(this),c=$("#topicTypeListForChange").val(),d=b.attr("forumId"),e=b.attr("categoryId"),f=b.attr("isTopicOwner"),g={};f=="true"&&(g.access="author");if(c==1){var h=$("#announcementExpiryDays_"+a).val();g.expiryDay=h}g.forumGroupId=forumGroupId,g.forumTopicId=a,g.forumId=d,g.categoryId=e,g.postTopicType=c,g[csrfParamName]=csrfToken,doAjaxAction("/updateTopicType.do",g,function(b){removeTopicListCache(),loadNewPost("/updateTopicType.do",b,a),$("#changeTopicTypeTemplate").hide(),showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeSuccessMessage"],"success")},function(a){showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeErrorMessage"],"failure")})})}function updateNotification(a,b,c){var d={};d.forumGroupId=forumGroupId,d.forumTopicId=b,d.access="author",notifyStat=a.attr("notifyOnResponse"),notifyStat=="true"?(notifyStat="false",a.attr("notifyOnResponse",notifyStat)):(notifyStat="true",a.attr("notifyOnResponse",notifyStat)),d.currNotifyStatus=notifyStat,d[csrfParamName]=csrfToken,doAjaxAction("/updateNotify.do",d,function(a){(a="SUCCESS")?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.Notificationsavedmessage"],"success",1e3)):showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function moderateAction(a,b,c){var d=a.attr("forumTopicId");d=d||a.parents('div[parentCont="actualParent"]').attr("forumTopicId");var e=a.attr("forumId");e=e||a.parents('div[parentCont="actualParent"]').attr("forumId");if(a.attr("moderationStatus")=="moderate"){var f={};f.forumTopicId=d,f.forumGroupId=forumGroupId,f.forumId=e,f[csrfParamName]=csrfToken,showSmallLoadingImage(c),doAjaxAction("/moderateTopic.do",f,function(c){c=="SUCCESS"?(removeTopicListCache(),a.attr("moderationStatus","moderated"),showTipper(i18n["zohodiscussions.singlepost.Now"]+i18n["zohodiscussions.singlepost.topicundermoderationmessage"],"success",2e3),b=="singlePost"?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"]):a.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3),hideLoadingImage()})}else if(a.attr("moderationStatus")=="moderated"){var g={};g.forumTopicId=d,g.forumGroupId=forumGroupId,g[csrfParamName]=csrfToken,doAjaxAction("/unModerateTopic.do",g,function(c){c=="SUCCESS"?(removeTopicListCache(),a.attr("moderationStatus","moderate"),showTipper(i18n["zohodiscussions.singlepost.moderationtopicremoved"],"success",2e3),b=="singlePost"?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"]):a.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3)})}}function moveTopic(a){var b=a.attr("forumTopicId");$("#moveTopicTemplate").html($("#moveTopic_"+b).html()),loadCategoriesToMove($("#forumListForMove").val()),$("#moveTopicTemplate").show();var c=$("#forumListForMove"),d=$("#forumListForModerator");a.attr("moderatorUser")=="yes"?(d.hide(),c.show(),c.val(a.attr("forumId")),loadCategoriesToMove(a.attr("forumId")),$("#moveToCategory").val(a.attr("categoryId"))):(c.hide(),d.show(),loadCategoriesToMove(d.val())),$("#cancelMove,#cancelMoveTopic").click(function(){$("#moveTopic_"+b).html($("#moveTopicTemplate").html()),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),$("#doMove").html(i18n["zohodiscussions.singlePost.Movetopic"])}),$("#forumListForMove,#forumListForModerator").change(function(){var b=a.attr("forumId"),c=$(this).val();b==c?$("#doMove").attr("disabled",!0):$("#doMove").attr("disabled",!1),loadCategoriesToMove($(this).val())}),$("#doMove").unbind("click").click(function(){var c=$(this);c.html(i18n["zohodiscussions.singlePost.Moving"]);var d=0;a.attr("moderatorUser")=="yes"&&(d=1);var e=$(this).attr("isTopicOwner"),f={};f.forumTopicId=b,f.forumId=$("#forumListForMove").val(),d==0&&(f.forumId=$("#forumListForModerator").val()),e&&(f.topicowner="true");var g=$("#moveToCategory"),h=g.is(":visible");f.categoryId=h==1?g.val():-1,f.forumGroupId=forumGroupId,f[csrfParamName]=csrfToken,f.categoryId||(f.categoryId=""),doAjaxAction("/moveTopic.do",f,function(a){removeTopicListCache(),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),showTipper(i18n["zohodiscussions.generalmessage.moveTopicSuccessMsg"],"success",3e3),loadNewPost("/moveTopic.do",a,b),a.indexOf("'result':'failure'")>0&&c.html(i18n["zohodiscussions.singlePost.Movetopic"])})})}function loadCategoriesToMove(a){categoriesForForum=$("#categoryListFormove").val().split("$$"),$("#moveToCategory").hide().parent().hide(),$.each(categoriesForForum,function(b,c){if(c.indexOf(a+":")>-1){$("#moveToCategory").html(c.split(":")[1]).show().parent().show();return}})}function singlePostTagActions(a,b){$("#forumTopicTags").find('b[purpose = "deleteTag"]').click(function(){if(confirm(i18n["zohodiscussions.singlepost.tagDeleteConfirmMsg"])){$this=$(this);var b={},c=$this.attr("postTagId"),d=$this.attr("eachTagName"),e=$this.attr("zuid"),f=$this.attr("forumId"),g=$this.attr("postAuthorId");g==e&&(b.access="author"),b.forumGroupId=forumGroupId,b.forumTopicId=a,b.forumId=f,b.postTagId=c,b[csrfParamName]=csrfToken;var h=$("#tagRelatedPosts_"+c).attr("tagCount");doAjaxAction("/deleteForumPostTags.do",b,function(b){b=="SUCCESS"&&(removeTopicListCache(),h=--h,$(".deleteTag").attr("tagCount",h),showTipper("<i>"+d+" </i> "+i18n["zohodiscussions.resource.tagdelete"],"info",3e3),$("#tagRelatedPosts_"+c).hide(),h==0&&($("#LockTopicLink").attr("isLocked")&&$("#linkTopicCont_"+a).length>0?$("#forumTopicTags").append('<span class="addTagSpan">'+i18n["zohodiscussions.singlepost.noTagsMsg"]+"</span>"):($("#addTagsForPost").hide(),$("#forumTopicTags").append('<span class="addTagSpan"> Click <a id="addNewTag" href="javascript:;">here</a> to add new tags.</span>'),singlePostTagActions())))})}return!1}),$("#addTagsForPost,#addNewTag").click(function(){$("#addPostTags").show(),$("#addPostTags").find(':input[name="postTags"]').focus(),$("#addTagSpan").hide()}),$("#cancelTags").click(function(){$("#addPostTags").hide(),$("#addPostTags").find(':input[name="postTags"]').attr("value"," ")}),$("#savePostTags").click(function(){$this=$(this);var b=$("#addPostTags"),c=b.find(':input[name="postTags"]').val();c=c.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ");var d="false";if(c!=""&&c.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)==null){hideLoadingImage(),showMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),enablePostButtons();return}var e=c.split(",");for(var f=0;f<e.length;f++){if(e[f].length>50){showTipper(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure");return}e[f]!=""&&!jQuery.trim(e[f])==""&&(d="true")}if(d=="false"){showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure");return}if(c.indexOf("-")<0){var g=$this.attr("forumId"),h=$this.attr("postAuthorId"),i={};h==ZUID&&(i.access="author"),i.forumId=g,i.postTags=c,i.forumGroupId=forumGroupId,i.forumTopicId=a,i[csrfParamName]=csrfToken;if(jQuery.trim(c)==""){showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure");return}doAjaxAction("/addNewTagsForPost.do",i,function(b){removeTopicListCache(),showTipper(i18n["zohodiscussions.resource.tagsadded"],"success",2e3),loadNewPost("/addNewTagsForPost.do",b,a)})}}),$("#forumTopicTags").find('[purpose="getTagRelatedPosts"]').unbind("click").click(function(){$this=$(this),b=b||"Tag";var a=$this.attr("hashPurpose");return processHash(a),!1})}function changeTopicLabel(a){var b=$("#statusList"),c=a.attr("topicLabelId"),d=b.attr("forumTopicId"),e=b.attr("forumId"),f={};f.forumGroupId=forumGroupId,f.forumTopicId=d,f.forumId=e,f.topicLabelId=c,f[csrfParamName]=csrfToken,doAjaxAction("/updateTopicLabel.do",f,function(b){if(b=="success"){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.updateTopicLabelSuccessMsg"],"success");var c=$.trim(a.html());$("#statusInfo").html(c)}else showMessage(i18n["zohodiscussions.singlePost.updateTopicLabelErrorMessage"],"failure")},function(a){})}function watchThisItem(a,b,c){var d=a.attr("hashPurpose"),e=a.attr("watchItemType"),f=a.attr("watchItemId");f=f||a.parents('div[parentCont="actualParent"]').attr("forumTopicId");var g=a.attr("status"),h=a.attr("watchStatus"),i=a.attr("itemName"),j={};j.watchItemType=e,j.watchItemId=f,j.forumGroupId=forumGroupId,j[csrfParamName]=csrfToken;if(g=="watch"||h=="watch")showSmallLoadingImage(c),doAjaxAction("/watchItem.do",j,function(c){if(c=="SUCCESS"){removeTopicListCache();if(e==0){showTipper(i18n["zohodiscussions.singlepost.watchTopicSuccessMsg"],"success",3e3);if(b=="singlePost")$(".wrapper > div[watchItemId="+f+"]").attr("status","unwatch"),$(".wrapper > div[watchItemId="+f+"] > a").html(i18n["zohodiscussions.singlePost.unwatchTopic"]);else if(b=="singleTopicWatch"){a.attr("status","unwatch");var g=a.parent();g.removeClass("smallAshBox").addClass("smallAshBoxShow"),a.removeClass("imgSmallWatch").addClass("imgSmallWatchSel"),hideLoadingImage()}else a.attr("status","unwatch"),a.find('a[purpose = "watchItemText"]').html(i18n["zohodiscussions.singlePost.unwatchTopic"]),hideLoadingImage()}else{if(e==2)return showTipper(i18n["zohodiscussions.widgetscontainer.watchForumSuccessMsg"],"success",3e3),a.attr("status","unwatch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==1)return showTipper(i18n["zohodiscussions.widgetscontainer.watchCategorySuccessMsg"],"success",3e3),a.attr("status","unwatch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==4||e==5||e==6)return showTipper(i18n["zohodsicussions.watchlist.announcement.follow.success"],"success",3e3),a.attr("status","unwatch"),a.html(i18n["zohodiscussions.general.Unwatch"]+" "+i),$("#ajaxLoaderSmall").hide(),!1}}});else{var k="";if(e==0)k=i18n["zohodiscussions.singlepost.unwatchTopicConfirmMsg1"];else if(e==1)k=i18n["zohodiscussions.singlepost.unwatchCategoryConfirmMsg3"];else if(e==2)k=i18n["zohodiscussions.singlepost.unwatchForumConfirmMsg2"];else if(e==4||e==5||e==6)k=i18n["zohodsicussions.watchlist.announcement.unwatch.confirm"];if(confirm(k)){var l={};l.watchItemId=f,l.forumGroupId=forumGroupId,l[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",l,function(c){if(c=="SUCCESS"){removeTopicListCache();if(e==0){showTipper(i18n["zohodiscussions.singlepost.unwatchTopicSuccessMsg"],"info",3e3);if(b=="singlePost")$(".wrapper > div[watchItemId="+f+"]").attr("status","watch"),$(".wrapper > div[watchItemId="+f+"] > a").html(i18n["zohodiscussions.singlePost.watchTopic"]);else if(b=="singleTopicWatch"){a.attr("status","watch");var g=a.parent();g.removeClass("smallAshBoxShow").addClass("smallAshBox"),a.removeClass("imgSmallWatchSel").addClass("imgSmallWatch"),hideLoadingImage()}else a.attr("status","watch"),hideLoadingImage()}else{if(e==2)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchForumSuccessMsg"],"success",3e3),a.attr("status","watch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==1)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchCategorySuccessMsg"],"success",3e3),a.attr("status","watch"),d!="type"?processHash(d):(a.find("a").html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide()),!1;if(e==4||e==5||e==6)return showTipper(i18n["zohodsicussions.watchlist.announcement.stop.success"],"success",3e3),a.attr("status","watch"),a.html(i18n["zohodiscussions.general.watch"]+" "+i),$("#ajaxLoaderSmall").hide(),!1}}})}}}function bookMark(a,b){var c=a.attr("status"),d={};d.forumGroupId=forumGroupId,d.forumTopicId=a.attr("forumTopicId"),d[csrfParamName]=csrfToken,showSmallLoadingImage(b),c=="bookmark"?doAjaxAction("/addBookMark.do",d,function(b){hideLoadingImage(),b=="SUCCESS"?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bookmarkTopicSuccessMsg"],"success",3e3),a.attr("status","removeBookmark"),a.find("a").html(i18n["zohodiscussions.singlePost.removeBookmark"])):showTipper(i18n["zohodiscussions.singlePost.bookMarkErrorMessage"],"failure")}):doAjaxAction("/removeBookMark.do",d,function(b){hideLoadingImage(),b=="SUCCESS"?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBookmarkMsg"],"info",3e3),a.attr("status","bookmark"),a.find("a").html(i18n["zohodiscussions.singlePost.bookmarkTopic"])):showTipper(i18n["zohodiscussions.singlePost.removeBookMarkErrorMessage"],"failure")})}function stickyLink(a,b){var c=0,d=a.attr("status"),e=a.attr("isSticky");e=="true"&&(c=1);var f={};f.forumGroupId=forumGroupId,f.forumTopicId=a.attr("forumTopicId"),f.action=c,f[csrfParamName]=csrfToken,showSmallLoadingImage(b),doAjaxAction("/stickyAction.do",f,function(b){b=="SUCCESS"&&(removeTopicListCache(),d=="stickyPost"?(showTipper(i18n["zohodiscussions.singlepost.stickyPostSuccessMsg"],"success",3e3),a.attr("status","normal"),a.attr("isSticky","true"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.notStickyPost"])):(showTipper(i18n["zohodiscussions.singlePost.removeStickyPostMsg"],"info",3e3),a.attr("status","stickyPost"),a.attr("isSticky","false"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.makeStickyPost"])),hideLoadingImage())})}function lockTopicLink(a,b){var c=0,d=a.attr("status"),e=a.attr("isLocked"),f=a.attr("forumTopicId");e=="true"&&(c=1);var g=d=="lockTopic"?i18n["zohodiscussions.singlepost.lockConfirmationMsg"]:i18n["zohodiscussions.singlepost.unlockConfirmationMsg"];if(confirm(g)){var h={};h.forumGroupId=forumGroupId,h.forumTopicId=f,h.action=c,h[csrfParamName]=csrfToken,doAjaxAction("/lockAction.do",h,function(a){removeTopicListCache(),d=="lockTopic"?showTipper(i18n["zohodiscussions.singlepost.lockTopicSuccessMsg"],"info",3e3):showTipper(i18n["zohodiscussions.singlepost.unlockTopicSuccessMsg"],"info",3e3),loadNewPost("/lockAction.do",a,f)})}}function raiseZSupportRequest($this,event){var raiseZSupportRequest={};raiseZSupportRequest.forumGroupId=forumGroupId,raiseZSupportRequest.forumTopicId=$this.attr("forumTopicId"),raiseZSupportRequest.forumId=$this.attr("forumId"),raiseZSupportRequest[csrfParamName]=csrfToken,showSmallLoadingImage(event),doAjaxAction("/raiseZSupportRequest.do",raiseZSupportRequest,function(data){var responseData=eval(data);responseData.result=="success"?(showTipper("Support request added successfully","info",3e3),$this.parents('[purpose="zsRequestLinkCont"]').remove(),hideLoadingImage()):showMessage(responseData.reason,"failure")})}function disablePostResponseButtons(){$("#publishResponse").attr("disabled",!0),$('button[purpose="publishPreviewResponse"]').attr("disabled",!0)}function enablePostResponseButtons(){$("#publishResponse").attr("disabled",!1),$('button[purpose="publishPreviewResponse"]').attr("disabled",!1)}function addForumResponse(forumTopicId,editorMode,responseId,tweetStatusId){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var contentToPost=editor.getContent();contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");var $tempCont=$("<div></div>").html(contentToPost);$tempCont=$tempCont.text(),$tempCont=$.trim($tempCont);if($tempCont==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}$("#postContentTA").val(contentToPost),$("#editorHolder").append($("#responseAttachmentContActual").clone().hide());var newResponseAction=editorMode&&editorMode=="Edit"?"/updateResponse.do":ZUID==-1?"/addGuestForumResponse.do":"/addForumResponse.do";if(editorMode=="TweetPost"){var postTitle=$("#editorHolder").find('input[name="forumPostTitle"]').val();postTitle=postTitle.replace(/^\s+/g,"").replace(/\s+$/g,"");var $tempTitle=$("<div></div>").html(postTitle);$tempTitle=$tempTitle.text(),$tempTitle=$.trim($tempTitle);if($tempTitle==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),$("#editorHolder").find('input[name="forumPostTitle"]').focus();return}if($("#forum_Twitter_SelectForum").val()==-1){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure");return}if($("#forum_Twitter_SelectSubForum_"+tweetStatusId).val()==-1&&$("#forum_Twitter_SelectSubForum_"+tweetStatusId).text()!="Uncategorised"){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure");return}newResponseAction="/addTweetPost.do";var tweetContent=$tempCont;$("#editorHolder").find('input[name="twitterResponseContent"]').val(tweetContent)}return disablePostResponseButtons(),doAjaxAction(newResponseAction,$("#editorHolder").serialize(),function(data){data=$.trim(data),hideLoadingImage();if(data.substring(12,19)=="failure"){var responseData=eval(data);responseData.errorcode=="SPAM_DETECTED"?confirm(responseData.reason)&&($("#editorHolder").find('input[name="detectSpamPresence"]').val(0),$("#publishResponse").trigger("click")):showMessage(responseData.reason,"failure"),enablePostResponseButtons()}else{if(data.substring(12,19)=="success"){var responseData=eval(data);if($("#SinglePostContainer").length>0)removeTopicListCache(),loadNewPost(newResponseAction,data,forumTopicId);else if($("#topicList").length>0||$("#topicsList").length>0)$("#topicListMainContainer").attr("shouldReload","true"),$("#currentCategoryContext").length>0?$("#currentCategoryContext").trigger("click"):editorMode=="TweetPost"?(showTipper(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),isTopicQuickView=="false"?window.location.href=serverURL+"/topic/"+responseData.topicPermaLink:(showLoadingImage(),loadSinglePost(responseData.value))):$("#currentForumContext").trigger("click");showTipper(i18n[responseData.reason],"info",5e3);return}var successMsg=editorMode&&editorMode=="Edit"?i18n["zohodiscussions.singlepost.ResponseUpdated"]:i18n["zohodiscussions.singlepost.ResponseAdded"];showTipper(successMsg,"success",3e3);if($("#SinglePostContainer").length>0)removeTopicListCache(),showLoadingImage(),loadNewPost(newResponseAction,data,forumTopicId);else if($("#topicList").length>0||$("#topicsList").length>0){$("#topicListMainContainer").attr("shouldReload","true");var forumId=$("#topicListMainContainer").attr("forumId");if(isEmbedService())return ZIntranet.loadForum(forumId),$("#cancelResponse").trigger("click"),!1;if($("#currentCategoryContext").length>0)$("#currentCategoryContext").trigger("click");else if($("#currentForumContext").length==0){var tagName=$("#eachTopic_"+forumTopicId).attr("currTagName");loadTagRelatedPost(tagName)}else $("#currentForumContext").trigger("click")}else if($("#myJournalsInnerContent").length>0){var topicId=forumTopicId;responseId&&$("#topicContent_"+topicId).length<1&&(topicId=responseId),$("#topicContent_"+topicId).html(contentToPost),$("#editTopic_"+topicId).html(contentToPost),$("#cancelResponse").trigger("click")}else if($("#authorProfileInnerContent").length>0){var topicId=forumTopicId;responseId&&$("#topicContent_"+topicId).length<1&&(topicId=responseId),$("#topicContent_"+topicId).html(contentToPost),$("#editTopic_"+topicId).html(contentToPost),$("#cancelResponse").trigger("click")}$('#responsePreviewContainerTemplate button[purpose="publishPreviewResponse"]').attr("disabled",!1)}},function(errordata){hideLoadingImage();if(errordata.responseText.indexOf("'result':'failure'")>0){var responseData=eval(errordata.responseText);if(responseData.result=="failure")if(responseData.errorcode=="HIP_REQUIRED"){$("#editorHolder").find("div#responseAttachmentContActual").remove();var $writePostCaptcha=$("#responseAttachmentContActual").find('div[purpose="responseCaptcha"]');$writePostCaptcha.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$writePostCaptcha.find(":input").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show(),$("#responseAttachmentContActual").is(":visible")||$("#responseAttachmentContActual").show()}else showMessage(responseData.reason,"failure")}else $("#SinglePostContainer").get(0).innerHTML=errordata.responseText}),!1}function removeTopicListCache(){$("#topicListMainContainer:hidden").remove(),$("#userProfileMainContainer:hidden").remove(),$("#myAreaParentContainer:hidden").remove()}function loadNewPost(a,b,c){var d=$(b),e=$("#topicContainer_"+c);hideLoadingImage();if(a=="/updateResponse.do"){var f=$('#editorHolder [name="responseId"]').val(),g=d.find("#fullResponseContainer_"+f).html();$("#fullResponseContainer_"+f).html(g)}else if(a=="/moveTopic.do"){var h=$("#topicVoteLink").attr("firstResponseId"),i=d.find(".spbreadCrumbCont").html(),j=d.find("#fullResponseContainer_"+h).html();$(".spbreadCrumbCont").html(i),$("#fullResponseContainer_"+h).html(j)}else if(a=="/addLinkToTopic.do"||a=="/lockAction.do"||a=="/deleteLinkedTopic.do"){var i=d.find("#SinglePostContainer_"+c).html(),j=d.find("#singlePostActionsWidget_"+c).html(),k=d.find("#forumTopicTags").html();$("#SinglePostContainer_"+c).html(i),$("#singlePostActionsWidget_"+c).html(j),$("#forumTopicTags").html(k),singlePostTagActions(c)}else if(a=="/addNewTagsForPost.do"){var l=d.find("#forumTopicTags").html();$("#forumTopicTags").html(l),singlePostTagActions(c)}else if(a=="/updateTopicType.do"||a=="/addForumResponse.do"||a=="/bestResponse.do"||a=="/removeBestResponse.do"||a=="/addGuestForumResponse.do"){var m=d.find("#SinglePostContainer_"+c).html();$("#SinglePostContainer_"+c).html(m)}e.data("inEditMode",!1)}function bindMyAreaClicks(a){a.unbind("click",processMyAreaClick).click(processMyAreaClick),$("#recentActivityContent, #profileDetailCont").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAuthorProfileClick),$("#mainContent").unbind("click",processAllActionClick),initialiseUserActivityChart()}function processMyAreaClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if((c.is('[purpose="dashBoard"]')||c.is('[purpose="myJournals"]')||c.is('[purpose="watchList"]')||c.is('[purpose="friends"]')||c.is('[purpose="bookMark"]')||c.is('[purpose="privateMsg"]')||c.is('[purpose="preference"]'))&&c.attr("isNiceUrl")!="Yes"){getMyAreaAction(c);return}if((b.is('[purpose="dashBoard"]')||b.is('[purpose="myJournals"]')||b.is('[purpose="watchList"]')||b.is('[purpose="friends"]')||b.is('[purpose="bookMark"]')||b.is('[purpose="privateMsg"]')||b.is('[purpose="preference"]'))&&b.attr("isNiceUrl")!="Yes"){getMyAreaAction(b);return}}function getMyAreaAction($target,subAction){showLoadingImage(),$target.parent("ul").find("li").removeClass("selected"),$target.addClass("selected");var action=$target.attr("action"),options={};options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,options.ch=ch;var purpose=$target.attr("purpose");subAction!=undefined&&purpose=="watchList"&&(action="/myWatchListSubAction.do",options.subAction=subAction),$("#myAreaLists").attr("currView",purpose),purpose=="myJournals"&&(options.userId=$target.attr("userId"),options.viewType="myself"),doAjaxAction(action,options,function(a){return hideLoadingImage(),$("#myAreaInnerMainContent").find("div.innerWrapper").get(0).innerHTML=a,isEmbedAllowedService()&&(purpose=="myJournals"?$.history.add("MyArea/myPosts"):purpose=="watchList"&&subAction!=undefined?$.history.add("MyArea/"+purpose+"/"+subAction):purpose=="friends"&&subAction!=undefined?$.history.add("MyArea/"+purpose+"/"+subAction):$.history.add("MyArea/"+purpose)),bindMyareaTabsActions(purpose,subAction),!1},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function bindMyareaTabsActions(a,b){var c=$("#myAreaInnerMainContent").find("div.innerWrapper");if(a=="preference"){c.unbind("click",processPreferenceClick).click(processPreferenceClick);var d=$("#user_AvatarImage");d.find("li.selected").length>0&&avatarImageFocus(d);var e=$("#preferenceInnerContent").find("form").attr("userPhotoPref"),f=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),g=$("#preferenceInnerContent").find("form").attr("userIAMphoto"),h="";if(e=="IAM")h=g;else if(e=="userUpload")h=f;else if(e=="Avatar"&&$("#allAvatarList").find("li.selected").length==0){$("#allAvatarList").find('li[count="1"]').addClass("selected");var i="../images/avatars/avatarn1.gif";$("#userSelectedAvatarImage").attr("value",i),$("#userSelectedProfileImage").attr("value",i),$("#userPreferencePhotoCont").find("img").attr("src",i),$("#user_Photo").attr("value","Avatar")}insertBrowserOptionToUpload(e,h);var j=$("#resetpassword"),k={};k[csrfParamName]=csrfToken,j.find("a").click(function(a){showSmallLoadingImage(a),j.hide(),doAjaxAction("https://discussions.zoho.com/sendResetPassword.do",k,function(a){a=="success"?(hideLoadingImage(),j.html(i18n["zohodiscussions.reset.success"]),j.show()):(hideLoadingImage(),j.html(i18n["zohodiscussions.reset.failure"]),j.show())})})}else c.unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),c.unbind("click",processAllActionClick).click(processAllActionClick),allFilterOption(a),showAuthorPopout(c),b=="following"&&setFocusToContainer(c.find("#followingAuthors"),!1,100,0);if(a=="dashBoard"){if(typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresence(l,"followingUserDetails"),setPresence(l,"followersUserDetails"),setPresence(l,"friendsListContainer"),setPresenceInMyArea(l,"current_recentActivity_List")}initialiseUserActivityChart()}if(a=="watchList"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"userChat_watchTopics")}if(a=="privateMsg"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"userChat_inbox")}if(a=="friends"&&typeof WmsContacts!="undefined"&&ch=="true"){var l=WmsContacts.getZohoContacts();setPresenceInMyArea(l,"friendsDetailsInnerContent")}}function avatarImageFocus(a){var b=a.find("li.selected").attr("count"),c=parseInt(b/7);b%7==0&&(c-=1),a.scrollTop(c*60)}function UserPhotoPreference(a,b){b=="uploadUserPhoto"&&($("#uploadPhotoCont").find('input[name="imageFileName"]').val(""),$("#uploadPhotoCont").find('img[purpose="uploadPhotoLoadingCont"]').remove(),$("#uploadPhotoPreference").attr("src",a),$("#uploadPhotoCont").find('img[purpose="avat_Image"]').attr("src",a),$("#userSelectedAvatarImage").attr("value",a),$("#userSelectedProfileImage").attr("value",a),$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl",a),$("#userPreferencePhotoCont").find("img").attr("src",a),$("#user_Photo").attr("value","userUpload"),$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3))}function processAllMyAreaMainClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.is('a[purpose="postTitle"]')){if(b.attr("postType")=="draft"){editDraftPost(b);return}showLoadingImage();if(isTopicQuickView!="false"){var d=b.attr("forumTopicId"),e=b.attr("recentResponseId");return e!=undefined?processHash("Topic/"+d+"/"+e):processHash("Topic/"+d),!1}}else if((b.is('a[purpose="forumAction"]')||b.is('a[purpose="categoryAction"]'))&&b.attr("isNiceUrl")!="Yes"){var f=b.attr("hashPurpose");processHash(f)}else{if(b.is('a[purpose="authorProfile"],a[purpose="authorProfileMore"]')&&b.attr("isNiceUrl")!="Yes"){var g=b.attr("authorName"),h=b.attr("singleClickflag");h=="0"&&(g==screenName||g==encodedScreenName?(processHash("MyArea"),b.attr("singleClickflag","1")):(processHash("User/"+g),b.attr("singleClickflag","1")));return}if(b.is('div[purpose="unWatch"]')){unWatchItem(b);return}if(b.is('a[purpose="moreFollowing"]')&&b.attr("isNiceUrl")!="Yes"){processHash("myarea/watchList/following");return}if(b.is('a[purpose="moreFollowers"]')&&b.attr("isNiceUrl")!="Yes"){processHash("myarea/watchList/follower");return}if(c.is('li[deletepurpose="deleteAttachment"]')){deletePublishedAttachment(c,a);return}if(b.is("li.navBtnEnabled")&&b.is('li[action="false"]')){var i=b.attr("purpose");fnPaginationProcess(c,i);return}}}function processAllActionClick(a){var b=$(a.target),c=b.parent(),d=$("#myAreaLists").attr("currView");d||(d="authorProfile");if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.is(".bigPlusIcon")){var e=b.parents("li.headerContent");!e.find("div.expandTextContent").is(":visible")||d=="privateMsg"?(e.find("div.textContent").addClass("expandTextContent").show(),e.parents("div.moderateSinglePost").find("div.lowerButton").show()):e.find("div.textContent").addClass("expandTextContent"),b.removeClass("bigPlusIcon").addClass("bigMinusIcon"),setFocusToContainer(b,!0,200);return}if(b.is(".bigMinusIcon")){var e=b.parents("li.headerContent");e.find("div.textContent").removeClass("expandTextContent").hide(),e.parents("div.moderateSinglePost").find("div.lowerButton").hide(),b.removeClass("bigMinusIcon").addClass("bigPlusIcon");return}if(c.is('li[purpose="expandedView"]')||c.is('li[purpose="listView"]')){manageExpandOrCollapseType(c,d);return}if(b.is("li.navBtnEnabled")&&b.is('li[action="true"]')){var f=b.attr("purpose");d=="authorProfile"?fnPagination(c,f,"true"):fnPagination(c,f);return}if(b.is('li[purpose="removeBookMark"]')){removeBookMarkAction(b);return}if(c.is('li[purpose="removeBookMark"]')){removeBookMarkAction(c);return}if(b.is('li[purpose="postTitle"]')){if(b.attr("postType")=="draft"){editDraftPost(b);return}showLoadingImage();if(isTopicQuickView!="false"){var g=b.attr("forumTopicId");return processHash("Topic/"+g),!1}}else if(c.is('li[purpose="postTitle"]')){if(c.attr("postType")=="draft"){editDraftPost(c);return}showLoadingImage();if(isTopicQuickView!="false"){var g=c.attr("forumTopicId");return processHash("Topic/"+g),!1}}else{if(c.is('li[purpose="delete"]')){myJournalsDeletePost(c,d+"Tab");return}if(b.is('li[purpose="delete"]')){myJournalsDeletePost(b,d+"Tab");return}if(b.is('li[purpose="resources"]')||b.is('li[purpose="topics"]')||b.is('li[purpose="drafts"]')||b.is('li[purpose="replies"]')||b.is('li[purpose="authorTopics"]')||b.is('li[purpose="authorReplies"]')||b.is('li[purpose="privateMsg"]')){$("#"+d+"Tab").find("li").removeClass("selected"),myAreaAllTabClick(b,d);return}if(c.is('li[purpose="resources"]')||c.is('li[purpose="topics"]')||c.is('li[purpose="drafts"]')||c.is('li[purpose="replies"]')||c.is('li[purpose="authorTopics"]')||c.is('li[purpose="authorReplies"]')||c.is('li[purpose="privateMsg"]')){$("#"+d+"Tab").find("li").removeClass("selected"),myAreaAllTabClick(c,d);return}if(b.attr("purpose")=="watchTopics"||b.attr("purpose")=="watchUsers"||b.attr("purpose")=="watchForums"||b.attr("purpose")=="watchCategories"||b.attr("purpose")=="simpleView"||b.attr("purpose")=="followers")$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick(b,"watchList");else if(c.attr("purpose")=="watchTopics"||c.attr("purpose")=="watchUsers"||c.attr("purpose")=="watchForums"||c.attr("purpose")=="watchCategories"||c.attr("purpose")=="simpleView"||c.attr("purpose")=="followers")$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick(c,"watchList");else if(b.attr("purpose")=="friendsActivities"||b.attr("purpose")=="friendsList"||b.attr("purpose")=="pendingFriendRequests")$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick(b,"friendsDetails");else if(c.attr("purpose")=="friendsActivities"||c.attr("purpose")=="friendsList"||c.attr("purpose")=="pendingFriendRequests")$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick(c,"friendsDetails");else if(c.is('li[purpose="removeFriend"]'))removeFriend(c);else if(c.is('li[purpose="confirmFriend"]'))confirmFriendRequest(c);else{if(b.is('li[purpose="unWatch"]')){unWatchItem(b);return}if(c.is('li[purpose="unWatch"]')){unWatchItem(c);return}if(c.is('li[purpose="unWatchItem"]'))unWatchItem(c,"authorProfile");else{if(b.attr("purpose")=="inbox"||b.attr("purpose")=="sent"){$("#privateMsgTab").find("li").removeClass("selected");var h=$("#newReplyPrivateMsgCont");h.is(":visible")&&(h.parent().hide(),h.remove()),myAreaAllTabClick(b,"privateMsg");return}if(c.attr("purpose")=="inbox"||c.attr("purpose")=="sent"){$("#privateMsgTab").find("li").removeClass("selected");var h=$("#newReplyPrivateMsgCont");h.is(":visible")&&(h.parent().hide(),h.remove()),myAreaAllTabClick(c,"privateMsg");return}if(b.is('li[purpose="deleteThisPM"]'))deletePrivateMsg(b);else if(c.is('li[purpose="deleteThisPM"]'))deletePrivateMsg(c);else if(b.is('li[purpose="replyToThisPM"]')||b.is('li[purpose="editThisPM"]'))replyToPrivateMsg(b);else if(c.is('li[purpose="replyToThisPM"]')||c.is('li[purpose="editThisPM"]'))replyToPrivateMsg(c);else if(c.is('a[purpose="postConversation"]'))privateConversation(c);else if(b.is('a[purpose="postConversation"]'))privateConversation(b);else if(b.is('a[purpose="postConversationTitle"]')){var i=b.parents("li.headerContent"),j=i.find("div.textContent");j.is(":visible")?i.find("div.bigMinusIcon").trigger("click"):i.find("div.bigPlusIcon").trigger("click")}}}}}function allFilterOption(a){$("#"+a+"_Filter").change(function(){var b=$(this),c=b.val(),d=$(this).find('option[filterType="'+c+'"]');b.attr("action")=="true"?myJournalsFilterAction(d,a):myJournalsFilter(d,a)})}function removeBookMarkAction($target){var forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,doAjaxAction("/removeBookMark.do",options,function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.bookMark.successfullyRemoveBookMark"],"success"),$("#bookMark_"+forumTopicId).remove()},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function processPreferenceClick(a){var b=$(a.target),c=b.parent(),d=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),e=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;if(b.attr("purpose")=="profile"||b.attr("purpose")=="notification"||b.attr("purpose")=="privacy")c.find("li.selected").removeClass("selected"),b.addClass("selected"),myAreaAllTabClick(b,"preference");else if(c.attr("purpose")=="profile"||c.attr("purpose")=="notification"||c.attr("purpose")=="privacy")c.parent("ul").find("li.selected").removeClass("selected"),c.addClass("selected"),myAreaAllTabClick(c,"preference");else if(b.is('input[purpose="save"]')||c.is('input[purpose="save"]'))updateUserPreference();else if(c.is('li[purpose="avat_Image"]')){$("#user_IamImage").find("div.profilePhotoSelected").removeClass("profilePhotoSelected").addClass("profilePhoto"),$("#user_AvatarImage").find("li.selected").removeClass("selected"),c.addClass("selected");var f=b.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",f),$("#user_Photo").attr("value","Avatar"),$("#userSelectedAvatarImage").val(f),$("#userSelectedProfileImage").val(""),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}else if(b.is("#myComputer"))$("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#allAvatarList").hide(),$("#myComputer").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("userUpload",d);else if(b.is("#zohoAccounts"))$("#zohoAccountMess").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#allAvatarList").hide(),$("#zohoAccounts").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("IAM",e);else if(b.is("#AvatarsList")){$("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#AvatarsList").addClass("selected").siblings("li.selected").removeClass("selected");if($("#fgid").length==0){var g=$('<input type = "hidden" id="fgid" name="forumGroupId" value="'+forumGroupId+'"/>');g.insertAfter($('#preferenceInnerContent > form > input[name="avatar"]')).show()}var h=$("#allAvatarList").find("li.selected").find("img").attr("src");$("#userSelectedAvatarImage").attr("value",h),$("#userSelectedProfileImage").attr("value",h),$("#allAvatarList").show(),avatarImageFocus($("#user_AvatarImage"))}else if(c.is('div[purpose="avat_Image"]')){$("#user_AvatarImage").find("li.selected").removeClass("selected"),c.removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userSelectedProfileImage").val("yes");var f=b.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",f),$("#userSelectedAvatarImage").val(f),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}$("#userNameChangePopUp").find('input[name="screenName"]').unbind("focus").focus(function(){$("#userNameChangePopUp").find("a.greenLink").show(),$("#userNameChangePopUp").find('span[purpose="showMsg"]').hide()})}function insertBrowserOptionToUpload(a,b){var c=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),d=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if(a=="IAM"){var e=$("#uploadPhoto_Cont"),f=e.clone();f.insertAfter($("#user_AvatarImage").find("ul")).show(),f.attr("id","curr_UploadPhoto_Cont"),f.attr("purpose","userPhotoTemplate"),f.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/discussions/uploadUserPhoto.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),f.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),f.find("form").attr("target","fileUpdTgt_user");var g=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>');g.insertAfter($("#curr_UploadPhoto_Cont").find('div[purpose="uploadPhotoContent"]')),$("#curr_UploadPhoto_Cont").find('div[purpose="uploadName"]').html(i18n["zohodiscussions.userProfile.zohoImage"]),f.find(":file").change(function(){f.find('[purpose="uploadPhotoLoadingCont"]').show(),f.find(':input[name="attacher"]').val(""),f.find("form").get(0).submit()});var h=$("#zohoAccounts").attr("purpose"),i="profilePhoto";typeof h!="undefined"&&(i="profilePhotoSelected");var j=$('<div class="'+i+'"  imgpurpose="IAMPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+d+'"/></div>');j.insertBefore($("#curr_UploadPhoto_Cont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]')),$("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]').click(function(){var a=$("#preferenceInnerContent").find("form").attr("userIAMphoto");$("#userPreferencePhotoCont").find("img").attr("src",a);var b=$("#userPreferencePhotoCont").attr("currentPref");if(b="userUpload")$("#myComputer").removeAttr("purpose"),$("#zohoAccounts").attr("purpose","iamUploadselected");$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected")}),$("#iamImageSize").show().siblings().hide(),$('<div id="zohoAccountMess" style="padding:50px;margin-left:50px;"><p class="innerInfo tinyText"><span>'+i18n["zohodiscussions.userpreference.uploadzohoAccountMess"]+"</span></p></div>").insertAfter($("#curr_UploadPhoto_Cont"))}else if(a=="userUpload"){var e=$("#uploadPhoto_Cont"),k=e.clone();k.insertAfter($("#user_AvatarImage").find("ul")).show(),k.attr("id","uploadPhotoCont"),k.attr("purpose","uploadUserPhotoTemplate"),k.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/discussions/uploadCustomFile.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),k.find(':input[type="file"]').attr("name","imageFileName"),k.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),k.find("form").attr("target","fileUpdTgt_user");var g=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>'),l=$('<input type = "hidden"  name="portalzaid" value="'+discussionsZaid+'"/>'),m=$(' <input type="hidden" value="uploadUserPhoto" name="purpose"/>');g.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),l.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),m.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),k.find(":file").change(function(){k.find('[purpose="uploadPhotoLoadingCont"]').show(),k.find("form").get(0).submit()});var h=$("#myComputer").attr("purpose"),i="profilePhoto";typeof h!="undefined"&&(i="profilePhotoSelected");var j=$('<div class="'+i+'" imgpurpose="userUploadedPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+c+'"/></div>');j.insertBefore($("#uploadPhotoCont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]')),$("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]').click(function(){var a=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl");$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userPreferencePhotoCont").find("img").attr("src",a),$("#user_Photo").attr("value","userUpload"),$("#allAvatarList").find("li.selected").removeClass("selected");var b=$("#userPreferencePhotoCont").attr("currentPref");if(b="IAM")$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").attr("purpose","userUploadselected")}),$("#customImageSize").show().siblings().hide()}}function uploadUserPhoto(a,b){$("#curr_UploadPhoto_Cont").find('img[purpose="uploadPhotoLoadingCont"]').remove();if(a=="failure")showMessage(b+" ,Please try again.","failure");else{$("#curr_UploadPhoto_Cont").find('input[name="uploadPhotoFile"]').val("");var c=$("#preferenceInnerContent").find("form").attr("photoUrl"),d=c+"/file?t=user&width=48&height=48&ID="+ZUID+"&nocache=1";$("#curr_UploadPhoto_Cont").find('img[purpose="avat_Image"]').attr("src",d),$("#userSelectedAvatarImage").attr("value",d),$("#userSelectedProfileImage").attr("value",d),$("#preferenceInnerContent").find("form").attr("userIAMphoto",d),$("#userPreferencePhotoCont").find("img").attr("src",d),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3),processHash("myArea/preference")}}function updateUserScreenName(attr){var $userNameChangeDialog=$(attr),options={};options.forumGroupId=forumGroupId,options.zuid=$userNameChangeDialog.find(':input[name="zuid"]').val();var screenName=$.trim($userNameChangeDialog.find(':input[name="screenName"]').val()),message="";if(screenName==""||screenName==null){message="zohodiscussions.myArea.screenNameEmpty",displayScreenMessage(attr,message);return}if(!screenName.match("^[A-Za-z0-9. _]{4,50}$")){message="zohodiscussions.myArea.screenNameValid",displayScreenMessage(attr,message,"failure");return}$userNameChangeDialog.find(':input[name="update"]').attr("disabled","true"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.myArea.screenName.Update"]),options.screenName=screenName,options[csrfParamName]=csrfToken,doAjaxAction("/updateScreenName.do",options,function(data){var responseData=eval(data);message=responseData.reason,displayScreenMessage(attr,message,responseData.result),responseData.result=="success"&&location.reload(),$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]);return},function(err){var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"?reason="zohodiscussions.generalmessage.tryagainaftersometime":$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]),displayScreenMessage(attr,reason)})}function checkScreenNameAvailablity(attr){var $userNameChangeDialog=$(attr),options={};options.forumGroupId=forumGroupId,options.zuid=$userNameChangeDialog.find(':input[name="zuid"]').val();var screenName=$.trim($userNameChangeDialog.find(':input[name="screenName"]').val()),message="";if(screenName==""||screenName==null){message="zohodiscussions.myArea.screenNameEmpty",displayScreenMessage(attr,message,"failure");return}if(!screenName.match("^[A-Za-z0-9. _]{4,50}$")){message="zohodiscussions.myArea.screenNameValid",displayScreenMessage(attr,message,"failure");return}options.screenName=screenName,options[csrfParamName]=csrfToken,doAjaxAction("/screenNameAvailablity.do",options,function(data){var responseData=eval(data);message=responseData.reason,displayScreenMessage(attr,message,responseData.result);return},function(err){$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]);var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"&&(reason="zohodiscussions.generalmessage.tryagainaftersometime"),displayScreenMessage(attr,reason)})}function displayScreenMessage(a,b,c){var d=$(a),e,f;b=i18n[b],e=d.find('span[purpose="showMsg"]'),c!="success"?(c="failure",e.removeClass("screenGreenMarkText").addClass("redMarText")):e.removeClass("redMarText").addClass("screenGreenMarkText"),f=d.find("a.greenLink"),f.hide(),e.show(),e.text(b);return}function updateUserPreference(){if($("#userAvatarList").is(":focus")){var $listAvatarUl=$("#imgContUl"),$currSelectAvatar=$listAvatarUl.find("li.listAvatarSelected"),src=$currSelectAvatar.find("img").attr("src");$listAvatarUl.find('input[name="avatar"]').val(src)}var $wikiUrl=$("#wikiUrl"),$blogUrl=$("#blogUrl"),$webSite=$("#webSite"),wikiURL=sanitizeURL($.trim(""+$wikiUrl.val())),blogURL=sanitizeURL($.trim(""+$blogUrl.val())),website=sanitizeURL($.trim(""+$webSite.val()));$wikiUrl.val(wikiURL),$blogUrl.val(blogURL),$webSite.val(website);var $twitterLink=$("#twitterLink"),$facebookLink=$("#facebookLink"),$linkedinLink=$("#linkedinLink"),twitterLink=sanitizeURL($.trim(""+$twitterLink.val())),facebookLink=sanitizeURL($.trim(""+$facebookLink.val())),linkedinLink=sanitizeURL($.trim(""+$linkedinLink.val()));$twitterLink.val(twitterLink),$facebookLink.val(facebookLink),$linkedinLink.val(linkedinLink),doAjaxAction("/updateUserSetting.do",$("#preferenceInnerContent").find("form").serialize(),function(a){if(a=="SUCCESS"){showTipper(i18n["zohodiscussions.userpreference.userprofileupdated"],"success");var b=$("#userSelectedAvatarImage").val();$("#topContainerPhoto").find("img").attr("src",b),isEmbedService()?authorProfileEmbedClickAction("myarea"):processHash("myArea/preference")}},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure")})}function editDraftPost($target){showLoadingImage();var authorId=$target.attr("authorId"),forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,options.editMode="true";var forumId=$target.attr("forumId"),categoryId=$target.attr("categoryId");authorId==ZUID&&(options.access="author"),doAjaxAction("/editDraft.do",options,function(a){hideLoadingImage(),document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupName,$("#mainContent").get(0).innerHTML=a,$("#SelectForum").val(forumId),initWritePost(),$("#SelectCategory").val(categoryId)},function(errordata){var responseData=eval(errordata.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function myJournalsDeletePost($target,tabType){var authorId=$target.attr("authorId"),action=$target.attr("action"),options={};options.forumGroupId=forumGroupId,options.forumId=$target.attr("forumId"),options.categoryId=$target.attr("categoryId"),options.forumTopicId=$target.attr("forumTopicId"),options[csrfParamName]=csrfToken,action=="/deleteForumResponse.do"&&(options.responseId=$target.attr("responseId")),authorId==ZUID&&(options.access="author"),doAjaxAction(action,options,function(a){hideLoadingImage(),action=="/deleteForumResponse.do"?showTipper(i18n["zohodiscussions.myJournals.successfullyTopicDeleted"],"success"):showTipper(i18n["zohodiscussions.myJournals.successfullyResponseDeleted"],"success"),$target.parents("div.moderateSinglePost").hide()},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function myJournalsFilter(a,b){var c=a.attr("purpose"),d=$("#"+b+"InnerContent").find('div[status="show"]');d.attr("currFilterType",a.text()),d.attr("filterType",c),d.find("div.moderateSinglePost").hide();var e=-1;c=="all"?($listOfTypes=d.find("div.moderateSinglePost"),$listOfTypes.each(function(a,b){a<postPerPage&&$(b).show(),e=a})):($listOfTypes=d.find("div."+c),$listOfTypes.each(function(a,b){a<postPerPage&&$(b).show(),e=a})),b=="watchList"&&(b="watchTopic"),postPerPage>e||e==-1?$("#"+b+"Next").removeClass("navBtnEnabled").addClass("navBtnDisabled"):$("#"+b+"Next").removeClass("navBtnDisabled").addClass("navBtnEnabled");var f=$("#"+b+"Prev");f.removeClass("navBtnEnabled").addClass("navBtnDisabled"),f.parent("ul").attr("fetchPage",1),e==-1?($("#"+b+"FilterEmptyMsg").show(),$("#"+b+"_Nav").hide()):($("#"+b+"FilterEmptyMsg").hide(),$("#"+b+"_Nav").show())}function myJournalsFilterAction($target,tabType){var $targetParent=$target.parent(),filterType=$target.attr("purpose"),$currShowList=$("#"+tabType+"InnerContent").find('div[status="show"]'),filterText=$target.text();$currShowList.attr("currFilterType",filterText);var postType=$("#"+tabType+"Tab").find("li.selected").attr("purpose");showLoadingImage();var action=$targetParent.attr(postType+"Action"),options={};options.forumGroupId=forumGroupId,options.userId=$targetParent.attr("userId"),options.filterType=filterText,options[csrfParamName]=csrfToken,doAjaxAction(action,options,function(a){hideLoadingImage(),$currShowList.get(0).innerHTML=a;if(tabType=="myJournals"){var b=$("#"+tabType+"SelectAction");b.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),b.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")}},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function replyToPrivateMsg($this){var $newReplyEditor=$("#newReplyPrivateMsgCont");if($newReplyEditor.is(":visible")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");return}var type=$this.attr("postType"),forumTopicId=$this.attr("forumTopicId"),$newPMLocation=$("#privateMsgCont_"+forumTopicId),$PMContainer=$("#privateMsg"+type+"Container"),action="reply",actionType="Write",toMember=$this.attr("toMember"),purpose=$this.attr("purpose"),responseId=-1,responseAuthor="";type=="Sent"&&$("#topicContent_"+forumTopicId).hide(),$newPMLocation.show(),purpose=="editThisPM"?($("#PrivateMsgReply").hide(),$("#PrivateMsgEdit").show()):($("#PrivateMsgReply").show(),$("#PrivateMsgEdit").hide());var $replyPMArea=$("#replyPrivateMsgContent");$newReplyEditor=$replyPMArea.clone(),$newReplyEditor.attr("id","newReplyPrivateMsgCont"),$newReplyEditor.find("#PrivateMsgReply").attr("id","newPrivateMsgReply"),$newReplyEditor.find("#PrivateMsgEdit").attr("id","newPrivateMsgEdit"),$newReplyEditor.find("#cancelPrivateReplyButton").attr("id","newcancelPrivateReplyButton");var action="",$pmReplyContent=$newReplyEditor.find('textarea[name="privateMsgContent"]'),$pmReplyToMember=$newReplyEditor.find('input[name="toMemberName"]'),$pmReplyTitle=$newReplyEditor.find('input[name="forumPostTitle"]'),postTitle="",editContent=$("#privateMsg_"+forumTopicId).html();return purpose=="editThisPM"?(responseId=$this.attr("responseId"),$pmReplyToMember.parent().hide(),postTitle=$this.attr("postTitle"),$pmReplyTitle.val(postTitle),action="/editPrivateMsg.do",$("#privateMsg_"+forumTopicId).hide()):(responseAuthor=$this.attr("toMemberName"),$pmReplyToMember.val(responseAuthor),$pmReplyTitle.parent().hide(),action="/replyToPM.do"),$pmReplyContent.val(editContent),$newReplyEditor.find('input[name="toMember"]').val(toMember),$newReplyEditor.find('input[name="forumTopicId"]').val(forumTopicId),$newReplyEditor.find('input[name="responseId"]').val(responseId),$newPMLocation.append($newReplyEditor.show()),$("#newPrivateMsgReply, #newPrivateMsgEdit").unbind("click").click(function(){if(purpose=="editThisPM"){var $pmReplyTitleValue=$.trim($pmReplyTitle.val());if($pmReplyTitleValue==""){showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}}var $pmReplyContentValue=$.trim($pmReplyContent.val());if($pmReplyContentValue==""){showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}doAjaxAction(action,$newReplyEditor.find("form").serialize(),function(a){showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success"),purpose=="editThisPM"?($("#privateMsg_"+forumTopicId).html($pmReplyContent.val()),$("#topicContent_"+forumTopicId).html($pmReplyContent.val()),$("#editPrivateMsg_"+forumTopicId).attr("postTitle",$pmReplyTitle.val()),$("#privateMsgPostTitle_"+forumTopicId).html($pmReplyTitle.val()),$("#newcancelPrivateReplyButton").trigger("click")):processHash("myArea/privateMsg")},function(err,desc,exceptionobj){$newReplyEditor.find("div#writePMCaptcha").attr("id","newWritePMCaptcha");var responseData=eval(err.responseText);if(responseData.errorcode=="HIP_REQUIRED"){var $writePMCaptcha=$("#newWritePMCaptcha");$writePMCaptcha.find("input#captchaCodePM").attr("id","newCaptchaCodePM"),$writePMCaptcha.show(),$writePMCaptcha.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePMCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#newCaptchaCodePM").attr("name",responseData.reason),$writePMCaptcha.attr("currCaptcha","old"),$writePMCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()})}),$("#newcancelPrivateReplyButton").click(function(){$("#privateMsgCont_"+forumTopicId).hide(),$newReplyEditor.remove(),purpose=="editThisPM"&&$("#privateMsg_"+forumTopicId).show()}),!1}function addPrivateMsg(forumTopicId,editorMode,responseId,type){showLoadingImage();if(type=="UserPM"){var $currScreenView=$("#privateMsgTab").find("li.selected");$currScreenView.attr("isthere","false")}var $postContentTA=$("#postContentTA"),postTitle="";if(editorMode&&editorMode=="Edit"){postTitle=$postContentTA.parent().find('input[name="forumPostTitle"]').val(),postTitle=postTitle.replace(/^\s+/g,"").replace(/\s+$/g,"");if(postTitle==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}}var contentToPost=$postContentTA.data("editor").val();contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");if(contentToPost==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}$postContentTA.val(contentToPost);var newResponseAction=editorMode&&editorMode=="Edit"?"/editPrivateMsg.do":type=="UserPM"?"/addPrivateMsg.do":"/replyToPM.do";return doAjaxAction(newResponseAction,$("#editorHolder").serialize(),function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success");if(editorMode=="Edit"){var b=$("#privateMsgCont_"+forumTopicId).parent("li");b.find('a[purpose="postConversationTitle"]').html(postTitle),$("#cancelResponse").trigger("click")}else if(type=="UserPM"){var c=$("#UserPM").attr("authorName");processHash("user/"+c)}else processHash("myArea/privateMsg")},function(err,desc,exceptionobj){var responseData=eval(err.responseText);if(responseData.errorcode=="HIP_REQUIRED"){var $writePostCaptcha=$("#replyPMContActual").show().find('div[purpose="responseCaptcha"]');$writePostCaptcha.find(":input").val(""),$writePostCaptcha.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$writePostCaptcha.find(":input").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()}),!1}function deletePrivateMsg($target){var forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,doAjaxAction("/deletePM.do",options,function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMDeleted"],"success");var b=$("#privateMsgTab").find("li.selected");b.attr("purpose")=="inbox"?processHash("myArea/privateMsg"):b.attr("isthere","false").trigger("click")},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function privateConversation(a){var b=a.attr("forumTopicId"),c=$("#privateConversation_"+b).html(),d=$("#privateConversation");d.show(),$("#privateConversationCont").get(0).innerHTML=c,$("#privateConversationClose").unbind("click").click(function(){d.hide();return}),$("#morePrivateConversation").unbind("click").click(function(){d.hide(),showLoadingImage(),openSinglePost(b);return})}function friendsTabClick(a){a.addClass("selected"),showLoadingImage();var b=a.attr("purpose"),c=a.attr("action"),d={};d.forumGroupId=forumGroupId,doAjaxAction(c,d,function(a){hideLoadingImage(),$("#friendsInnerCont").get(0).innerHTML=a,setPresenceInMyArea(dataOb,"friendsDetailsInnerContent")})}function myAreaAllTabClick($this,parentName){var $currentShowingInnerContent=$("#"+parentName+"InnerContent"),$currentList=$currentShowingInnerContent.find('div[status="show"]');$this.addClass("selected");var purpose=$this.attr("purpose");purpose=="resources"?$("#myAreaInnerMainContent").find("div.contentActionsCont").hide():$("#myAreaInnerMainContent").find("div.contentActionsCont").show();var isthere=$this.attr("isthere"),$requiredList=$currentShowingInnerContent.find('div[purpose="author_'+purpose+'"]');$currentList.attr("status","hide").hide(),parentName=="authorProfile"&&(purpose=="privateMsg"?$("#authorProfileContentAction").hide():$("#authorProfileContentAction").show()),parentName=="watchList"&&(purpose!="watchTopics"?$("#"+parentName+"_Filter").parent().hide():$("#"+parentName+"_Filter").parent().show());if(parentName=="myJournals"||parentName=="privateMsg"||parentName=="authorProfile"){var $currentShowingSelectAction=$("#"+parentName+"SelectAction");if(isthere=="true"){if(parentName=="myJournals"||parentName=="authorProfile"){var $myJournalsFilter=$("#"+parentName+"_Filter");if(purpose=="replies"||purpose=="authorReplies")$myJournalsFilter.parent().hide();else{$myJournalsFilter.parent().show();var currFilterType=$requiredList.attr("currFilterType");$myJournalsFilter.val(currFilterType)}}$requiredList.attr("status","show").show(),$requiredList.find("div.collapse").length>0?($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")):$requiredList.find("div.expand").length>0&&($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>"));if(parentName=="privateMsg"&&typeof WmsContacts!="undefined"&&ch=="true"){var dataOb=WmsContacts.getZohoContacts();setPresenceInMyArea(dataOb,"userChat_"+purpose)}return}}else if(isthere=="true"){$requiredList.attr("status","show").show();if(parentName=="watchList"&&typeof WmsContacts!="undefined"&&ch=="true"){var dataOb=WmsContacts.getZohoContacts();setPresenceInMyArea(dataOb,"userChat_"+purpose)}return}showLoadingImage();var purpose=$this.attr("purpose"),action=$this.attr("action"),options={};if(purpose!="privateMsg"){options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken;if(parentName=="myJournals"||parentName=="authorProfile")options.userId=$this.attr("userId")}parentName=="myJournals"&&(options.viewType="myself"),doAjaxAction(action,options,function(a){hideLoadingImage();var b;if(parentName=="myJournals"||parentName=="authorProfile"){b=$("<div purpose=author_"+purpose+" status=show currFilterType=all></div>").html(a);var c=$("#"+parentName+"_Filter");purpose=="replies"||purpose=="authorReplies"?c.parent().hide():(c.parent().show(),c.val("All"))}else b=$("<div purpose=author_"+purpose+" status=show id=userChat_"+purpose+"></div>").html(a);hideLoadingImage(),showAuthorPopout(b),b.insertAfter($currentList),$this.attr("isthere","true");if(purpose=="drafts"||purpose=="inbox"||purpose=="sent"||purpose=="authorTopics")$currentShowingSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>");else if(purpose=="replies"||purpose=="authorReplies")$currentShowingSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>");if(parentName=="privateMsg"||parentName=="watchList")if(typeof WmsContacts!="undefined"&&ch=="true"){var d=WmsContacts.getZohoContacts();setPresenceInMyArea(d,"userChat_"+purpose)}},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function manageExpandOrCollapseType(a,b){var c=a.attr("purpose");if(a.find("a").length<1)return;var d=$("#"+b+"InnerContent"),e=$("#"+b+"SelectAction"),f=d.find('div[status="show"]');c=="expandedView"?(f.find("div.collapse").attr("class","expand"),f.find("div.expand div.bigPlusIcon").removeClass("bigPlusIcon").addClass("bigMinusIcon"),f.find("div.textContent").addClass("expandTextContent").show(),f.find("div.moderateSinglePost div.lowerButton").show(),e.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),e.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):c=="listView"&&(f.find("div.expand").attr("class","collapse"),f.find("div.collapse div.bigMinusIcon").removeClass("bigMinusIcon").addClass("bigPlusIcon"),f.find("div.textContent").addClass("expandTextContent").hide(),f.find("div.moderateSinglePost div.lowerButton").hide(),e.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),e.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"));return}function manageCountValue(a){var b=$("#"+a).find("li.selected"),c=b.attr("count");c=--c;var d=b.attr("purpose");d=="watchTopics"?b.find("a").html(i18n["zohodiscussions.myJournals.topics"]+"("+c+")"):d=="authorReplies"?b.find("a").html(i18n["zohodiscussions.general.replies"]+"("+c+")"):d=="watchUsers"?b.find("a").html(i18n["zohodiscussions.watchList.users"]+"("+c+")"):d=="inbox"?b.find("a").html(i18n["zohodiscussions.privateMsg.inbox"]+"("+c+")"):d=="sent"?b.find("a").html(i18n["zohodiscussions.privateMsg.sent"]+"("+c+")"):d=="watchForums"?b.find("a").html(i18n["zohodiscussions.general.forums"]+"("+c+")"):d=="watchCategories"&&b.find("a").html(i18n["zohodiscussions.myArea.subForums"]+"("+c+")"),b.attr("count",c)}function fnPagination($target,navType,authorProfile){showLoadingImage();var action=$target.attr("action"),currType=$target.attr("currType"),options={};authorProfile=="true"&&(currType="authorProfile");var currShowPage=$("#"+currType+"InnerContent").find('div[status="show"]');options.forumGroupId=forumGroupId;if(currType!="privateMsg"){options.userId=$target.attr("userId");var postType=$("#"+currType+"Tab").find("li.selected").attr("purpose");if(postType=="topics"||postType=="drafts"||postType=="authorTopics")options.filterType=currShowPage.attr("currfiltertype")}currType=="myJournals"&&(options.viewType="myself");var fetchPage=parseInt($target.attr("fetchPage"));navType=="next"?options.fetchPage=fetchPage+1:options.fetchPage=fetchPage-1,options.getPostFor=$target.attr("getPostFor"),doAjaxAction(action,options,function(a){hideLoadingImage(),currShowPage.get(0).innerHTML=a;var b=$("#"+currType+"Tab").find("li.selected").attr("purpose"),c=$("#"+currType+"SelectAction");b=="replies"?(c.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),c.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):(c.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),c.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"))},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function fnPaginationProcess(a,b){var c=parseInt(a.attr("fetchPage")),d=a.attr("currType"),e=a.attr("postCount");b=="next"?c+=1:c-=1,a.attr("fetchPage",c);var f=$("#current_"+d+"_List"),g=c*postPerPage,h=g-postPerPage+1,i=h;e<=g?(g=e,a.find('li[purpose="next"]').removeClass("navBtnEnabled").addClass("navBtnDisabled")):a.find('li[purpose="next"]').removeClass("navBtnDisabled").addClass("navBtnEnabled"),h==1?a.find('li[purpose="prev"]').removeClass("navBtnEnabled").addClass("navBtnDisabled"):a.find('li[purpose="prev"]').removeClass("navBtnDisabled").addClass("navBtnEnabled");if(d=="recentActivity"){f.find("li").hide();for(i;i<=g;i++)$("#recentActivity_"+i).show()}else{f.find("div.moderateSinglePost").hide();var j=d;d=="watchTopic"&&(d="watchList");var k=$("#"+d+"InnerContent").find('div[status="show"]').attr("filterType");if(d!="watchList"&&d!="bookMark"||k=="all")for(i;i<=g;i++)f.find('div.moderateSinglePost[listStage="'+j+"_"+i+'"]').show();else{var l;$listOfTypes=f.find("."+k),i--,$listOfTypes.each(function(a,b){a<g&&i<=a&&$(b).show(),l=a})}}}function getAuthorProfile(authorName){showLoadingImage();var $userProfileMainContainer=$("#userProfileMainContainer");if($userProfileMainContainer.length>0&&$userProfileMainContainer.is('[shouldReload="false"]'))$userProfileMainContainer.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var options={};options.forumGroupId=forumGroupId,options.authorName=authorName,options[csrfParamName]=csrfToken,options.ch=ch,doAjaxAction("/getAuthorProfile.do",options,function(a){hideLoadingImage(),$("#authorPopout:visible").hide(),$("#mainContent").get(0).innerHTML=a,$.history.add("User/"+authorName),bindAuthorProfileActions(authorName)},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}}function bindAuthorProfileActions(a){$("#mainContent").unbind("click",processAuthorProfileClick).click(processAuthorProfileClick),$("#mainContent").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAllActionClick).click(processAllActionClick),allFilterOption("authorProfile");var b=$("#mainContent > #userProfileMainContainer").attr("authorId");$("#authorPopout_"+b).hide();if(typeof WmsContacts!="undefined"&&ch=="true"&&!isTopicQuickView){var c=WmsContacts.status(b);c===!1&&(c=9),manageUserChatStatus("userOnlineStatus_"+b,c)}initialiseUserActivityChart()}function processAuthorProfileClick(a){var b=$(a.target),c=b.parent();if($("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible"))return;c.is('li[purpose="sendPM"]')?addPrivateMessage(c):c.is('li[purpose="watchItem"]')?watchItem(c):c.is('li[purpose="addAsFriend"]')?addAsFriend(c):c.is('li[purpose="blockUser"]')?blockUser(c):c.is('li[purpose="unBlockUser"]')?unBlockUser(c):c.is('li[purpose="moderateUser"]')?moderateUser():c.is('li[purpose="assignLabel"]')&&bindUserLabelsAction()}function writePrivateMsg(){var a=$("#sentPrivateMsg"),b=$("#editorContainer_PM");if(b.data("inEditMode"))return showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"failure"),!1;a.show(),openEditor($("#editPM"),"privateMsgContent","postContentTA","UserPM","Write","editorContainer_PM"),b.data("inEditMode",!0)}function watchItem($target){showLoadingImage();var itemType=$target.attr("watchItemType"),options={};options.forumGroupId=forumGroupId,options.watchItemType=itemType,options.watchItemId=$target.attr("watchItemId"),options[csrfParamName]=csrfToken,doAjaxAction("/watchItem.do",options,function(a){hideLoadingImage();var b=itemType=="0"?"zohodiscussions.watchList.successfullyWatchTopic":"zohodiscussions.watchList.successfullyWatchUser";showTipper(i18n[b],"success"),$target.attr("purpose","unWatchItem"),$target.find("a").html(i18n["zohodiscussions.userProfile.unwatchUser"])},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function unWatchItem($target,type){showLoadingImage();var type=$target.attr("unWatchType"),itemId=$target.attr("watchItemId"),options={};options.forumGroupId=forumGroupId,options.watchItemId=itemId,options[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",options,function(a){hideLoadingImage(),type=="authorProfile"?(showTipper(i18n["zohodiscussions.watchList.successfullyUnwatchUser"],"success"),$target.attr("purpose","watchItem"),$target.find("a").html(i18n["zohodiscussions.userProfile.watchUser"])):type=="following"?(showTipper(i18n["zohodiscussions.watchList.successfullyUnwatchUser"],"success"),$("#watch_"+itemId).parents("li").remove()):(showTipper(i18n["zohodiscussions.watchList.successfullyUnwatchTopic"],"success"),$target.parents("div#watch_"+itemId).remove(),manageCountValue("watchListTabs"))},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function addAsFriend($target){showLoadingImage();var successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=$target.attr("userId"),options[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",options,function(a){hideLoadingImage(),a=="SUCCESS"&&($target.attr("purpose","friendWaitingApproval"),$("#addAsFriendLink").attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]).siblings("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(successMsg,"success"))},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function confirmFriendRequest($target){showLoadingImage();var userId=$target.attr("userId"),successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=userId,options[csrfParamName]=csrfToken,doAjaxAction("/confirmFriendRequest.do",options,function(a){hideLoadingImage(),showTipper(successMsg,"info");var b=$("#friendId_"+userId);if(b.length>0){var c=b.siblings("div.moderateSinglePost");b.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html(c.length);var d=$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').text();d=parseInt(d),d++,$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').html(d)}else location.reload()},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function removeFriend($target){var confirmMg=$target.attr("confirmMsg");if(confirm(confirmMg)){showLoadingImage();var userId=$target.attr("userId"),successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=userId,options[csrfParamName]=csrfToken,doAjaxAction("/removeFriend.do",options,function(a){hideLoadingImage(),showTipper(successMsg,"info");var b=$("#friendId_"+userId);if(b.length>0){var c=b.siblings("div.moderateSinglePost");b.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html(c.length)}else location.reload()},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}}function blockUser($target){showLoadingImage();var options={};options.forumGroupId=forumGroupId,options.authorId=$target.attr("authorId"),options[csrfParamName]=csrfToken,doAjaxAction("/blockUser.do",options,function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyBlockUser"],"success"),$target.attr("purpose","unBlockUser"),$target.find("a").html(i18n["zohodiscussions.userProfile.unblockUser"])},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function unBlockUser($target){showLoadingImage();var options={};options.forumGroupId=forumGroupId,options.authorId=$target.attr("authorId"),options[csrfParamName]=csrfToken,doAjaxAction("/unBlockUser.do",options,function(a){hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyUnBlockUser"],"success"),$target.attr("purpose","blockUser"),$target.find("a").html(i18n["zohodiscussions.userProfile.blockUser"])},function(err){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function moderateUser(){$("#moderateUserTemplate").html($("#dimDivModerateUser").html()),$("#dimDivModerateUser").html(""),$("#moderateUserTemplate").show();var a=$("#eachForumListForModeration").find(":input[name='forumLevelModeration']"),b=$("#moderateUserPopOutForm").find(":input[name='portalLevelModeration']");a.length==0&&$("#forumLabel").hide(),b.attr("checked")&&a.attr("disabled",!0),$("#imgCancel").click(function(){var a=$(this),b=a.attr("authorName");if(isZSupport)authorProfileEmbedClickAction("user",b);else if(isTopicQuickView=="false"){location.href=serverURL+"/user/"+b;return}$("#dimDivModerateUser").html($("#moderateUserTemplate").html()),$("#moderateUserTemplate").hide(),$("#moderateUserTemplate").html("");var c=$("#moderateUserCont");if(c.attr("status")=="changed"){var d=$("#userProfileMainContainer");d.show().attr("shouldReload","true"),getAuthorProfile(b)}}),b.click(function(){$this=$(this),$this.attr("checked")?a.attr("disabled",!0):a.attr("disabled",!1),moderateUserAction($this)}),a.click(function(){$this=$(this),moderateUserAction($this)})}function moderateUserAction(a){var b=$("#moderateUserCont");b.attr("status","changed");var c=a.attr("authorId"),d=a.attr("userName"),e=a.attr("moderationStatus"),f=a.attr("isAdmin"),g=a.attr("isPortal"),h=0,i=!1,j="",k="",l={};l.authorId=c,l.forumGroupId=forumGroupId,l[csrfParamName]=csrfToken,l.adminUser=f;if(g)l.moderateType=1,e=="unmoderated"?(j=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],k=i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(j=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],k=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"]);else{l.moderateType=0;var m=a.attr("forumId");l.forumId=m;var n=a.attr("forumName");e=="unmoderated"?(j=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.general.in"]+" "+n+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],k=" "+i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(j=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+d+" "+i18n["zohodiscussions.general.in"]+" "+n+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],k=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"])}if(e=="unmoderated")if(confirm(j))doAjaxAction("/moderateUser.do",l,function(b){b=="SUCCESS"?(showTipper(d+" "+k,"success",1e3),a.attr("moderationStatus","moderated"),$("#imgCancel").trigger("click"),g||$("#itemListCont_"+m).find("span.italicText").html(i18n["zohodiscussions.moderationLeftContainer.moderated"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")});else{var b=$("#moderateUserCont");b.attr("status",""),g?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!1),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!1)):$("#moderateUserPopOutForm").find(":input[forumId='"+m+"']").attr("checked",!1)}else if(confirm(j))doAjaxAction("/unModerateUser.do",l,function(b){b=="SUCCESS"?(showTipper(d+" "+k,"success",1e3),a.attr("moderationStatus","unmoderated"),$("#imgCancel").trigger("click"),g||$("#itemListCont_"+m).find("span.italicText").html(i18n["zohodiscussions.ModerateUsers.ModerateUsers"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")});else{var b=$("#moderateUserCont");b.attr("status",""),g?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!0),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!0)):$("#moderateUserPopOutForm").find(":input[forumId='"+m+"']").attr("checked",!0)}}function bindUserLabelsAction(){$("#userLabelsTemplate").html($("#dimDivUserLabels").html()),$("#dimDivUserLabels").html(""),$("#userLabelsTemplate").show(),$("#closeUserLabelsDialog").click(function(){$("#dimDivUserLabels").html($("#userLabelsTemplate").html()),$("#userLabelsTemplate").hide(),$("#userLabelsTemplate").html("")}),$('#userLabelsCont select[purpose="userLabelBox"]').change(function(){var a=$(this),b=a.attr("forumId"),c=a.attr("userId"),d=a.val(),e={};e.forumGroupId=forumGroupId,e.forumId=a.attr("forumId"),e.userId=a.attr("userId"),e.labelId=a.val(),e[csrfParamName]=csrfToken,doAjaxAction("/mapLabelToUser.do",e,function(b){if(b=="SUCCESS"){a.find("option[selected]").removeAttr("selected");var c=a.find("option[value='"+d+"']"),e=c.text();c.replaceWith("<option value='"+d+"' selected>"+e+"</option>"),d=="-1"?showTipper(i18n["zohodiscussions.UserDetails.labelRemovedMsg"],"info"):showTipper(i18n["zohodiscussions.UserDetails.labelAddedMsg"],"success")}})})}function setPresenceInTopicList(a,b){if(!a)return;var c="";b?(c=$("#SinglePostContainer_"+b+" div.sppostAuthor div.authorChatPresence"),c.each(function(c,d){var e=$(d),f=e.attr("authorId");if(f==ZUID)return;var g=e.attr("responseId"),h="";h=$("#uc_"+b+"_"+g+"_"+f+",#ucReply_"+b+"_"+g+"_"+f);try{var i=a[f].STATUS;manageUserChatStatusInTopicList(h,i,"IS_SINGLE_POST")}catch(j){}})):($("#topicList").length>0?c=$("#topicList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"):c=$("#topicsList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"),$stickyPostAuthors=$("#recentStickyPosts >li  >div.ashColorText >div.authorChatPresence"),$announcementPostAuthors=$("#recentAnnouncementPosts >li  >div.ashColorText >div.authorChatPresence"),c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;var f=d.attr("userChatId"),g="";g=$("#uc_"+f+"_"+e);try{var h=a[e].STATUS;manageUserChatStatusInTopicList(g,h,"topicList")}catch(i){}}),$stickyPostAuthors.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}}),$announcementPostAuthors.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}}))}function setPresenceInMyArea(a,b){if(!a)return;var c="";b=="current_recentActivity_List"?c=$("#"+b+" >li >div.authorChatPresence"):b=="userChat_inbox"||b=="userChat_sent"?c=$("#"+b+" div.moderateSinglePost ul li img.authorChatPresence"):c=$("#"+b+" div.moderateSinglePost ul li div.authorChatPresence"),c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;try{var f=a[e].STATUS;manageUserChatStatusInTopicList(d,f)}catch(g){}})}function setPresence(a,b){if(!a)return;var c=$("#"+b+" > li > div.userChatPresence");c.each(function(b,c){var d=$(c),e=d.attr("authorId");if(e==ZUID)return;var f=d.attr("id");try{var g=a[e].STATUS;manageUserChatStatus(f,g)}catch(h){}})}function manageUserChatStatus(a,b){var c=$("#"+a),d=c.attr("authorName");b=="4"?(c.find("div").attr("class","wms-4 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),c.find("a").html(i18n["zohodiscussions.chat.idleForChat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isNowIdle"]).unbind("click",chatInvoker).click(chatInvoker)):b=="3"?(c.find("div").attr("class","wms-3 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),c.find("a").html(i18n["zohodiscussions.chat.busyforchat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isBusyToChat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="1"?(c.find("div").attr("class","wms-1 chatOverride flLeft"),c.find("a").html(i18n["zohodiscussions.chat.availableforchatmessage"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.isAvailableToChat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="0"?(c.find("div").attr("class","wms-0 chatOverride flLeft"),c.find("a").html(i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker),c.attr("title",i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker)):b=="-1"?(c.find("div").attr("class","imgAddContact flLeft"),c.find("a").html(i18n["zohodiscussions.chat.invitedforchat"]),c.attr("title",i18n["zohodiscussions.chat.youHaveInvited"]+" "+d+" "+i18n["zohodiscussions.chat.toChat"]).unbind("click",chatInvoker)):b=="-3"&&(c.find("div").attr("class","imgAddContact flLeft"),c.find("a").html(i18n["zohodiscussions.chat.acceptinvitationforchat"]),c.attr("title",d+" "+i18n["zohodiscussions.chat.youHaveInvited"]).unbind("click",chatInvoker)),c.find("div").unbind("click",chatInvoker).click(chatInvoker),c.find("a").unbind("click",chatInvoker).click(chatInvoker)}function manageUserChatStatusInTopicList(a,b,c){var d=0;b=="4"?(d=1,a.attr("class","wms-4 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.busy"])):b=="3"?(d=1,a.attr("class","wms-3 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.idle"])):b=="1"?(d=1,a.attr("class","wms-1 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.available"])):b=="0"?(d=1,a.attr("class","wms-0 flLeft").unbind("click",chatInvoker).click(chatInvoker),c=="IS_SINGLE_POST"&&a.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.offline"])):b=="-4"?a.attr("class","flLeft").unbind("click",chatInvoker):b=="-5"&&a.attr("class","flLeft").unbind("click",chatInvoker),c=="topicList"?d==1?a.addClass("authorChatPresence chatStyleOverride"):a.remove():a.addClass("authorChatPresence chatOverride")}function chatInvoker(){var a=$(this),b=a.attr("authorName"),c=a.attr("authorId");c==undefined&&(c=a.parent().attr("authorId"),b=a.parent().attr("authorName"));var d=WmsContacts.status(c);if(d>-1&&d!==!1){WebMessanger.chat(c);return}d==-1?confirm(b+" "+i18n["zohodiscussions.chat.reminder"])&&WmsContacts.add("zoho",b,ZUID):d==-3?WmsContacts.accept("zoho",b,ZUID):WmsContacts.add("zoho",b,ZUID)}function updatePresence(usid,uname,status){if(ch!="true")return;if($("#recentStickyPosts").is(":visible")){var $stickyPostAuthors=$("#recentStickyPosts >li >div.ashColorText >div.authorChatPresence");$stickyPostAuthors.each(function(a,b){var c=$(b),d=c.attr("authorId");d==usid&&manageUserChatStatusInTopicList(c,status)})}if($("#recentAnnouncementPosts").is(":visible")){var $stickyPostAuthors=$("#recentAnnouncementPosts >li >div.ashColorText >div.authorChatPresence");$stickyPostAuthors.each(function(a,b){var c=$(b),d=c.attr("authorId");d==usid&&manageUserChatStatusInTopicList(c,status)})}if($("#topicListMainContainer").is(":visible")){var uCont=eval("("+$("#uListForStatusUpdate").html()+")"),zuid="z"+usid;if(typeof uCont[zuid]!="undefined")for(i=0;i<uCont[zuid].length;i++){var $authorContainers=$("#uc_"+uCont[zuid][i]+"_"+usid);manageUserChatStatusInTopicList($authorContainers,status,"topicList")}if($("#singleForumHeaderView").is(":visible")){var currForumId=$("#singleForumHeaderView").attr("forumId");manageUserChatStatus("moderatorOnlineStatus_"+currForumId+"_"+usid,status)}}else if($("#SinglePostContainer").is(":visible")){var topicId=$("#SinglePostContainer").attr("forumTopicId"),uCont=eval("("+$("#uListForStatusUpdateInSP").html()+")"),zuid="z"+usid;if(typeof uCont[zuid]!="undefined")for(i=0;i<uCont[zuid].length;i++){var $authorContainers=$("#uc_"+topicId+"_"+uCont[zuid][i]+"_"+usid);manageUserChatStatusInTopicList($authorContainers,status,"IS_SINGLE_POST")}}else if($("#userProfileMainContainer").is(":visible"))manageUserChatStatus("userOnlineStatus_"+usid,status);else if($("#myAreaInnerMainContent").is(":visible")){if($("#profileDetailCont").is(":visible")){manageUserChatStatus("followersOnlineStatus_"+usid,status),manageUserChatStatus("followingOnlineStatus_"+usid,status);var $authorContainer=$("#current_recentActivity_List >li >div.authorChatPresence");$authorContainer.each(function(a,b){var c=$(b),d=c.attr("authorId");d==usid&&manageUserChatStatusInTopicList(c,status)})}else{var currView="";if($("#watchListInnerContent").is(":visible")){var $currShowing=$("#watchListInnerContent").find('div[status="show"]');currView=$currShowing.attr("id")}else if($("#privateMsgInnerContentent").is(":visible")){var $currShowing=$("#privateMsgInnerContent").find('div[status="show"]');currView=$currShowing.attr("id")}if(currView!=""){var $authorContainer="";currView=="privateMsgInnerContent"?$authorContainer=$("#"+currView+" div.moderateSinglePost ul li img.authorChatPresence"):$authorContainer=$("#"+currView+" div.moderateSinglePost ul li div.authorChatPresence"),$authorContainer.each(function(a,b){var c=$(b),d=c.attr("authorId");d==usid&&manageUserChatStatusInTopicList(c,status)})}}manageUserChatStatus("authorPopup_"+usid,status)}}function addPrivateMessage($this){var toMember=$this.attr("toMember"),toMemberName=$this.attr("authorname"),$privateMsgPrompt=$("#privateMsgPrompt"),$privateMsgToMemberArea=$("#privateMsgToMemberArea"),$privateMsgTitleArea=$("#privateMsgTitleArea"),$privateMsgContentArea=$("#privateMsgContentArea"),$privateMsgToMemberId=$("#privateMsgToMemberId");$privateMsgToMemberId.val(""),$privateMsgToMemberArea.val(""),$privateMsgTitleArea.val(""),$privateMsgContentArea.val(""),$privateMsgToMemberId.val(toMember),$privateMsgToMemberArea.val(toMemberName),$privateMsgPrompt.show().parent().show(),$("#cancelPrivateMsgButton, #cancelPrivateMsg").unbind("click").click(function(){$privateMsgToMemberArea.val(""),$privateMsgTitleArea.val(""),$privateMsgContentArea.val("");var a=$("#writePMCaptcha");a.find("img").attr("src","/images/spacer.gif"),a.find(":input").val(""),a.hide(),$privateMsgPrompt.hide().parent().hide()}),$("#addNewPrivateMsg").unbind("click").click(function(){showLoadingImage();var contentToPost=$privateMsgContentArea.val();contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");if(contentToPost==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");return}var titleToPost=$privateMsgTitleArea.val();titleToPost=titleToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");if(titleToPost==""){hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");return}doAjaxAction("/addPrivateMsg.do",$privateMsgPrompt.find("form").serialize(),function(data){var $writePMCaptcha=$("#writePMCaptcha");$writePMCaptcha.find("img").attr("src","/images/spacer.gif"),$writePMCaptcha.find(":input").val(""),$writePMCaptcha.hide(),hideLoadingImage();if(data=="SUCCESS")showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success");else{var responseData=eval(data);showMessage(responseData.reason,"failure"),hideLoadingImage()}$privateMsgPrompt.hide().parent().hide()},function(err){var responseData=eval(err.responseText);if(responseData.errorcode=="HIP_REQUIRED"){var $writePMCaptcha=$("#writePMCaptcha");$writePMCaptcha.attr("currCaptcha")=="new"?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePMCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#captchaCodePM").attr("name",responseData.reason),$writePMCaptcha.attr("currCaptcha","old"),$writePMCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()})}),$privateMsgTitleArea.focus()}function myAreaEmbedClickAction(a,b){return isZSupport?(getMyAreaBindActions(b,"myarea"),!1):isTopicQuickView=="false"?(window.location.href=a,!1):!1}function authorProfileEmbedClickAction(a,b,c){if(typeof b==undefined||typeof b=="guest")return!1;if(typeof c==undefined||typeof c=="undefined")c="";if(isZIntranet)return;return a=="myarea"?(newMyAreaClick(forumGroupId),getMyAreaBindActions("dashboard",a,"niceurl"),!1):a=="user"?(c!=""?ZSupport.callBackUserAction(forumGroupId,"",c):ZSupport.callBackUserAction(forumGroupId,b),!1):isTopicQuickView=="false"?(window.location.href=actionURL,!1):!1}function Collaboration(){}function WmsContactImpl(){}function WmsliteImpl(){}function bindReportsClicks(a){var a=$("#reportsLeftPanel");a.unbind("click",processReportClick).click(processReportClick),$("#reportsDateFilterArrow,#allTypeTrendDateFilter,#postResponseDateFilter,#repUnrepDateFilter,#topicStatusDateFilter,#mostVotedTopicsArrow,#userParticipationDateFilter").click(function(){displayStatisticsArrowClick($(this))}),$("#forumDropDownArrow").unbind("click",processForumArrowClick).click(processForumArrowClick),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar(),showOverallUsageCharts()}function avtivateReportsCalendar(){if($("#dateFilterCont").length<=0)return;setDate("#fromDate"),setDate("#toDate")}function setDate(a){$(a).datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",gotoCurrent:!0,onChangeMonthYear:function(a,b,c){b=b.toString().length<2?"0"+b:b,$this=$(this);var d=$.trim($this.val());""!=d&&$this.val(a+"-"+b+"-"+d.substring(d.length-2))}})}function processReportClick(a){var b=$(a.target),c=b.parent();c.is('[topicType="-1"]')||c.is('[topicType="0"]')||c.is('[topicType="1"]')||c.is('[topicType="2"]')||c.is('[topicType="3"]')||c.is('[topicType="4"]')||c.is('[purpose="fbReports"]')?bindReportsAction(c):(b.is('[topicType="-1"]')||b.is('[topicType="0"]')||b.is('[topicType="1"]')||b.is('[topicType="2"]')||b.is('[topicType="3"]')||b.is('[topicType="4"]')||b.is('[purpose="fbReports"]'))&&bindReportsAction(b)}function bindReportsAction(a){showLoadingImage(),$("#dateFilter").text($("#reportsDateFilterArrow .forumOptions ul").find('li[dateFilter="1"]').text()),$("#forumDropDownArrow div").text($("#reportsForumFilter").find('li[forumId="-1"]').text()).attr("forumId","-1"),$("#dateFilterCont").hide(),a.parent("ul").find("li").removeClass("selected"),a.addClass("selected");var b={};b.forumGroupId=forumGroupId,b[csrfParamName]=csrfToken,b.ch=ch;var c=a.attr("purpose"),d=a.attr("categoryId"),e=a.attr("topicType");d&&(b.categoryId=d);var f=a.find("a").text();e&&(b.topicType=e);var g=$("#reportsLeftPanel li.selected").attr("action");g=="/topicTypeReports.do"?$("#topicTypesFilterCont").show():$("#topicTypesFilterCont").hide(),c&&c=="fbReports"?$("#reportsForumFilterCont").hide():$("#reportsForumFilterCont").show(),doAjaxAction(g,b,function(a){$("#reportsInnerContent").get(0).innerHTML=a,$("#reportsTitle").text(f),bindReportsClicks(),hideLoadingImage()})}function displayStatisticsArrowClick(a){var b=a.find("div.forumOptions");b.show(),b.find("li").unbind("click").click(function(){var a=$(this),c=a.attr("dateFilter");$("#postRespDateFilterText,#dateFilter").attr("dateFilter",c).text(a.text()),b.mouseout();if(c=="2"){$("#dateFilterCont").show();return}$("#dateFilterCont").hide(),doDateFilterAction(a)}),a.hover(function(){var b=a.data("destroyHandle");a.data("destroyHandle",!1),b&&clearTimeout(b)},function(){var c=setTimeout(function(){b.hide(),a.unbind("mouseenter").unbind("mouseleave")},500);a.data("destroyHandle",c)})}function bindDateFilterClick(a){a.unbind("click").click(function(){doDateFilterAction($(this))})}function doDateFilterAction($target){var $this=$target,options={},dateFilter=$this.attr("dateFilter");if(dateFilter=="2"){var startDate=$target.parents().find('input[name="startDate"]').val(),endDate=$target.parents().find('input[name="endDate"]').val();if(!startDate||""==startDate){showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");return}options.startDate=startDate,endDate&&""!=endDate&&(options.endDate=endDate)}var isTopFilter=$this.attr("topFilter")=="true"?!0:!1;options.dateFilter=dateFilter,options.forumGroupId=forumGroupId;var forumId=$("#forumDropDownArrow div").attr("forumId");forumId&&(options.forumId=forumId);var userId=$this.attr("authorId");userId&&userId>0&&(options.userId=userId),options[csrfParamName]=csrfToken;var action=isTopFilter?$("#reportsLeftPanel li.selected").attr("action"):$this.attr("action"),topicType=$("#reportsLeftPanel li.selected").attr("topicType");topicType&&(options.topicType=topicType);var chartFor=$this.attr("chartFor");chartFor&&(options.chartFor=chartFor),showLoadingImage(),doAjaxAction(action,options,function(a){hideLoadingImage();var b;isTopFilter?b=$("#reportsInnerContent"):b=$this.parents("#allTypeTrendChartCont,#postRespTrendChartCont,#repUnrepChartCont,#topicStatusPieChartCont,#mostVotedTopicsChartCont,#userParticipationChartCont"),b.get(0).innerHTML=a,bindReportsClicks()},function(err,desc,exceptionobj){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}function processForumArrowClick(event){var $target=$(event.target),$forumFilterList=$("#reportsForumFilterCont div.moreOptions");$forumFilterList.show(),$forumFilterList.find("ul").find("li").unbind("click").click(function(){var $listClick=$(this),options={};$forumFilterList.hide(),options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken;var forumId=$listClick.attr("forumId");options.forumId=forumId;var dateFilter=$("#dateFilter").attr("dateFilter");options.dateFilter=dateFilter;if(dateFilter=="2"){var $dateFilterCont=$("#dateFilterCont"),startDate=$dateFilterCont.find('input[name="startDate"]').val(),endDate=$dateFilterCont.find('input[name="endDate"]').val();if(!startDate||""==startDate){showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");return}options.startDate=startDate,endDate&&""!=endDate&&(options.endDate=endDate)}var topicType=$("#reportsLeftPanel li.selected").attr("topicType");topicType&&(options.topicType=topicType),showLoadingImage();var action=$("#reportsLeftPanel li.selected").attr("action");doAjaxAction(action,options,function(a){hideLoadingImage();var b=$("#reportsInnerContent");b.get(0).innerHTML=a,$("#forumDropDownArrow div").text($listClick.text()).attr("forumId",forumId),bindReportsClicks()},function(err,desc,exceptionobj){var responseData=eval(err.responseText);showMessage(responseData.reason,"failure"),hideLoadingImage()})}),$forumFilterList.hover(function(){var a=$forumFilterList.data("destroyHandle");a&&clearTimeout(a)},function(){var a=setTimeout(function(){$forumFilterList.hide(),$forumFilterList.unbind("mouseenter").unbind("mouseleave")},500);$forumFilterList.data("destroyHandle",a)})}function showOverallUsageCharts(){isImageLoaded("topicTypeTrendImgCont");var a=[0,1,2,3,4];for(var b=0;b<a.length;b++)isImageLoaded("postRespTrendImgCont_"+a[b]);isImageLoaded("statusPieChartImgCont"),isImageLoaded("statusMeterPlotImgCont"),isImageLoaded("repUnrepPieChartImgCont"),isImageLoaded("repUnrepMeterImgCont"),isImageLoaded("userParticipationImgCont")}function isImageLoaded(a){var b=$("#"+a);if(b.length>0){var c=b.find("img").length,d=0;b.find("img").one("load",function(){d++,d==c&&(b.show(),b.prev('div[purpose="chartLoading"]').hide()),lightBox("#"+a)}).each(function(){this.complete&&$(this).trigger("load")})}}function initialiseUserActivityChart(){$("#postResponseDateFilter").click(function(){displayStatisticsArrowClick($(this))}),isImageLoaded("postRespTrendImgCont_2"),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar()}function triggerTopicType(a){$("#reportsLeftPanel").find('li[topicType="'+a+'"]').trigger("click")}var discussionsFunctions={};discussionsFunctions.tphome=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=1;getForumTopics(b,c,m,a,d,e,f,g,h,i,j,k,l)},discussionsFunctions.home=function(a,b){var c=-1,d=-1,b=b;typeof a=="undefined"&&(a="home",b=1),getForumTopics(c,d,b,a)},discussionsFunctions.chome=function(a,b){var c=-1,d=-1,b=b;typeof a=="undefined"&&(a="chome",b=1),getForumTopics(c,d,b,a)},discussionsFunctions.stats=function(a){var b=-1,c=-1,d=1;getTopicsReport(b,c,d,a)},discussionsFunctions.forum=function(a,b,c,d){document.title=forumGroupName;var e=$("#topicListMainContainer"),f={};f.forumGroupId=forumGroupId,f.forumURL=b,f.fetchPage=d,c&&(f.categoryURL=c),doAjaxAction("/getSingleForumTopics.do",f,function(e){hideLoadingImage(),$("#mainContent").get(0).innerHTML=e,lightBox("#chartWidget"),c?parseInt(d)>1?$.history.add(a+"/"+b+"/"+c+"/"+d):$.history.add(a+"/"+b+"/"+c):parseInt(d)>1?$.history.add(a+"/"+b+"/"+d):$.history.add(a+"/"+b),goToTop(),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var f=$("#forumComboCont"),g=f.attr("forumId"),h=f.attr("categoryId"),i="NewTopic/"+g+"/"+h;$("#allForumWidget").length>0&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide(),$("#NewTopicTab").attr("hashPurpose",i);if(typeof WmsContacts!="undefined"&&ch=="true"){var j=WmsContacts.getZohoContacts();setPresence(j,"moderatorsChatList_"+g),setPresenceInTopicList(j)}return setToHotkeys(),!1},function(a){$("#mainContent").get(0).innerHTML=a.responseText,hideLoadingImage()})},discussionsFunctions.newtopic=function(a,b,c){var d=ZUID;if(d==-1&&canThisUserPostATopic=="false"&&isCustomSSOPortal=="false")initLoginFrame($("#NewTopicTab"));else if(d==-1&&canThisUserPostATopic!="true"||isTopicQuickView!="false")d!=-1&&typeof canThisUserPostATopic=="undefined"?window.location.href=serverURL:typeof b=="undefined"&&typeof c=="undefined"?getWritePost("-1","-1",a):(b=typeof b=="undefined"?-1:b,c=typeof c=="undefined"?-1:c,getWritePost(b,c,a));else{var e=$("#NewTopicTab").attr("topicURL");window.location.href=serverURL+"/"+e}},discussionsFunctions.search=function(givenKey,searchFor){var options={};options.forumGroupId=forumGroupId,searchFor||(searchFor=$("#searchInputBox").val(),searchFor=$.trim(searchFor));if(searchFor==""){showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),hideLoadingImage();return}var $forumComboCont=$("#forumComboCont"),$categoryComboCont=$("#categoryComboCont"),forumId=$forumComboCont.attr("forumId"),categoryId=$forumComboCont.attr("categoryId"),hashPurposeForSearch=$categoryComboCont.attr("hashPurpose");options.searchFor=searchFor,options.forumId=forumId,options.categoryId=categoryId;var searchingPurpose=$("#searchSelectedImage").attr("purpose");options.normalSearchType=searchingPurpose,typeof searchingPurpose=="undefined"?searchingPurpose="":searchingPurpose!="all"?searchingPurpose="/"+searchingPurpose:searchingPurpose="",typeof hashPurposeForSearch!="undefined"&&hashPurposeForSearch!=""?givenKey=hashPurposeForSearch+"/"+givenKey:(hashPurposeForSearch=$forumComboCont.attr("hashPurpose"),hashPurposeForSearch=="Home"&&(hashPurposeForSearch=""),typeof hashPurposeForSearch!="undefined"&&hashPurposeForSearch!=""&&(givenKey=hashPurposeForSearch+"/"+givenKey)),$.history.add(givenKey+searchingPurpose+"/"+searchFor),$("#currSearchSortBy").attr("currSortBy")=="date"&&(options.searchSortBy="date"),doAjaxAction("/getSearchResult.do",options,function(a){hideLoadingImage();var b=$("<div></div>");b.get(0).innerHTML=a,$("#mainContent").get(0).innerHTML=a,bindSearchContentClick($("#mainContent")),showAuthorPopout(b),$("#searchInputBox").val(searchFor)},function(err){hideLoadingImage();var responseData=eval(err.responseText),reason=responseData.reason;responseData.errorcode=="REMOTE_IP_LOCKED"&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})},discussionsFunctions.topic=function(a,b,c){c!=undefined?openSinglePost(b,a,c):openSinglePost(b,a)},discussionsFunctions.tag=function(a,b){$.history.add(a+"/"+b),$this=$(this),loadTagRelatedPost(b)},discussionsFunctions.alltags=function(a){$.history.add(a),$this=$(this);var b={};b.forumGroupId=forumGroupId,doAjaxAction("/showAllTags.do",b,function(a){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=a,bindTagsContClick($("#allTagsContainer")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})},discussionsFunctions.allforums=function(a){if($("#preloadedForumsCont").length>0)return $("#preloadedForumsCont").show().siblings().remove(),$.history.add(a),hideLoadingImage(),!1;var b={};b.purpose="AllForums",b.forumGroupId=forumGroupId,b[csrfParamName]=csrfToken,doAjaxAction("/AllForums.do",b,function(a){hideLoadingImage(),document.title=i18n["zohodiscussions.general.allForums"],$.history.add("AllForums"),$("#mainContent").get(0).innerHTML=a;var b=$("#iamLoginBox").find("iframe"),c=b.attr("src");return b.attr("src",c),allForumsBindActions(),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})},discussionsFunctions.myarea=function(a,b,c){document.title=i18n["zohodiscussions.general.myarea"];var d=$("#myAreaParentContainer");if(d.length>0&&d.is('[shouldReload="false"]'))d.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var e={};e.forumGroupId=forumGroupId,e[csrfParamName]=csrfToken,b||(b="dashboard");if(b!="dashboard"&&b!="myposts"&&b!="watchlist"&&b!="friends"&&b!="bookmark"&&b!="privatemsg"&&b!="preference"){hideLoadingImage();return}e.myAreaAction=b,e.ch=ch,doAjaxAction("/getMyArea.do",e,function(d){return $("#authorPopout:visible").hide(),hideLoadingImage(),$("#mainContent").get(0).innerHTML=d,getMyAreaBindActions(b,a,"",c),!1},function(a){hideLoadingImage();var b=a.responseText;$("#mainContent").get(0).innerHTML=b})}},discussionsFunctions.user=function(a,b){getAuthorProfile(b)},discussionsFunctions.moderation=function(a){document.title=i18n["zohodiscussions.moderationAction.moderation"];var b={};b.forumGroupId=forumGroupId,portalPlanIndex>4?b.postFor="AllWaitingApproval":(b[csrfParamName]=csrfToken,b.postFor="AllReportedSpam"),ModerationLoadingPage(b)};var createEditor=function(){try{var a;isDiscussionsMobileDevice==1?a={id:"editorHolder",mode:"plaintext",content:$("#postContentTA").val()}:a={id:"editorHolder",content:$("#postContentTA").val()},editor=ZE.create(a)}catch(b){setTimeout("createEditor()",300)}};$(window.document).click(function(a){var b=$("#switchToProductOptions,#changePortalOptions"),c=$("#statusList,#typeFilterOptions"),d=$(a.target),e=d.parent();if(d.is('[purpose="linkForDropDown"]')||e.is('[purpose="linkForDropDown"]')||d.is("#statusInfo")||e.is("#statusContainer")||d.is("#statusContainer")){var f=d.attr("dropDownLinkPurpose");return f=f||e.attr("dropDownLinkPurpose"),c.each(function(a,b){var c=$(b);if(typeof f=="undefined"&&c.is("#statusList")){if($("#statusInfo").find("div.statuschanges").length>0||$("#statusContainer").find("b.imgdownArrow"))$("#statusList").is(":visible")?c.hide():c.show()}else c.is('div[dropDownPurpose!="'+f+'"]:visible')&&(c.hide(),c.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected"))}),!1}c.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected")}),$(window.document).keypress(function(a){var b=$("#statusList,#typeFilterOptions,#privateConversation"),c=$("#portalComboCont");if(a.keyCode==27)return $("#messageContainer").hide(),$("#authorPopout:visible").hide(),$('#PopupContainer div.dimDiv:visible button:visible[purpose="closePopout"]').trigger("click"),$('#PopupContainer div.dimDiv:visible div:visible[purpose="imgCancel"]')&&$("#imgCancel").trigger("click"),b.is(":visible")&&b.hide(),c.is(".newComboSelected")&&c.addClass("newCombo").removeClass("newComboSelected"),$("#privateMsgPrompt").is(":visible")&&$("#privateMsgPrompt").parent().hide(),$("#inappropriateReason").is(":visible")&&$("#inappropriateReason").hide(),!1});var codeForPreview='<div class="__zd_findAndReplaceParent" style="height:11px"></div><div class = "__zd_findAndReplace" style="text-align:right;float:right;background-color:#efefef;margin-right:30px;padding:0px 3px;"><span onclick = "javascript:showCode(this);return false;" style="font:normal 10px trebuchet ms,arial;text-decoration:underline;color:blue;cursor:pointer">Copy code</span></div>';Collaboration.handleUserList=function(a,b){},Collaboration.handleMessage=function(a,b,c,d,e){},Collaboration.handlePresence=function(a,b,c,d,e){},Collaboration.join=function(a){WebMessanger.joinCollab(a)},Collaboration.quit=function(a){WebMessanger.quit(a)},Collaboration.serverup=function(){},Collaboration.serverdown=function(){},Collaboration.handleZohoMessage=function(a,b,c,d,e,f,g,h,i,j,k,l){return a=="FM"?(setTimeout(function(){showBubble(b,e)},2),!0):!1},Collaboration.handleCustomMessage=function(a){},Collaboration.handleCrossProductMessage=function(a,b){},Collaboration.onConnect=function(){},Collaboration.openURL=function(a,b,c,d){return!0},Collaboration.handleCollabAdd=function(a,b,c,d,e){},Collaboration.handleCollabDelete=function(a,b,c,d,e){},Collaboration.handleUserAdd=function(a,b){},Collaboration.handleUserDeleted=function(a,b){},Collaboration.handleIsOnline=function(a){updateStatus(a)},Collaboration.handleLogout=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.goOffline=function(){},Collaboration.handleChatNotifyMessage=function(a,b,c){},Collaboration.getPageTitle=function(){return!1},Collaboration.handleWmsDisable=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.handleServiceMessage=function(a){},Collaboration.handleComposeMail=function(a,b){return!1},Collaboration.handleLanguageChange=function(a){},WmsContactImpl.handlePresence=function(a,b,c,d,e){setTimeout(function(){updatePresence(a,b,d)},2)},WmsContactImpl.handleAddressBook=function(){},WmsContactImpl.handleInvite=function(a,b,c){},WmsContactImpl.notifyInvite=function(a,b,c){},WmsContactImpl.handleAccept=function(a,b,c,d,e){},WmsContactImpl.notifyAccept=function(a,b,c,d,e){},WmsContactImpl.handleReject=function(a,b,c){},WmsContactImpl.notifyRemove=function(a,b,c){},WmsContactImpl.handleDelete=function(a,b,c){},WmsContactImpl.handleContactUpdated=function(){},WmsContactImpl.handleStatusMessage=function(a,b){},WmsContactImpl.handeAllStatusMessages=function(){},WmsContactImpl.handleHideContactsUI=function(){},WmsContactImpl.handleShowContactsUI=function(){},WmsContactImpl.handleGetContacts=function(){var a=WmsContacts.getZohoContacts();if($("#topicListMainContainer").is(":visible")||$("#allForums_MainContentCont").is(":visible")){setPresenceInTopicList(a);if($("#singleForumHeaderView").is(":visible")){var b=$("#singleForumHeaderView").attr("forumId");setPresence(a,"moderatorsChatList_"+b)}}else if($("#SinglePostContainer").is(":visible")){var c=$("#SinglePostContainer").attr("forumtopicid");setPresenceInTopicList(a,c)}else if($("#myAreaParentContainer").is(":visible"))$("#recentActivityContent").is(":visible")?(setPresenceInMyArea(a,"current_recentActivity_List"),setPresence(a,"followingUserDetails"),setPresence(a,"followersUserDetails")):$("#watchListInnerContent").is(":visible")?setPresenceInMyArea(a,"userChat_watchTopics"):$("#privateMsgInnerContent").is(":visible")&&setPresenceInMyArea(a,"userChat_inbox");else if($("#userProfileMainContainer").is(":visible")){var d=$("#userProfileMainContainer"),e=d.attr("authorId");if(typeof WmsContacts!="undefined"&&ch=="true"){var f=WmsContacts.status(e);f===!1&&(f=9),manageUserChatStatus("userOnlineStatus_"+e,f)}}},WmsContactImpl.handleMPReject=function(a,b,c){},WmsContactImpl.handleMPAccept=function(a,b,c){},WmsContactImpl.handleMPDelete=function(a,b,c){},WmsContactImpl.handleMPAdd=function(a,b,c){},WmsContactImpl.handleMPInvite=function(a,b,c){},WmsContactImpl.handleLogin=function(a,b,c,d){},WmsContactImpl.handleLogout=function(a,b,c,d){},WmsContactImpl.handleGetAccounts=function(a){},WmsContactImpl.handleInvitations=function(a){},WmsliteImpl.serverdown=function(){},WmsliteImpl.serverup=function(){},WmsliteImpl.handleMessage=function(a,b){},WmsliteImpl.handleAccountDisabled=function(a){},WmsliteImpl.handleServiceMessage=function(a){},WmsliteImpl.handleLogout=function(a){setTimeout(function(){$.get("/cleardomain.do","",function(){var a=window.location.href;a.indexOf("#")>-1&&window.location.reload(),window.location.href=a})},5)};var op=navigator.userAgent.indexOf("Opera")!=-1,ie=!op&&/msie/i.test(navigator.userAgent);if(!op&&!ie){var curdomain=document.domain,_WMSDOMAIN=curdomain.substring(curdomain.indexOf(".")+1);document.domain=_WMSDOMAIN};